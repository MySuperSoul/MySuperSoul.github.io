<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Beauty-of-Mathematics</title>
    <url>/2019/07/01/Beauty-of-Mathematics/</url>
    <content><![CDATA[<p>&nbsp;&nbsp;&nbsp;&nbsp;æœ€è¿‘å¾ˆæœ‰å¹¸èƒ½å¤Ÿæ‹œè¯»<code>å´å†›</code>åšå£«çš„ã€Šæ•°å­¦ä¹‹ç¾ã€‹è¿™æœ¬ä¹¦ï¼Œåœ¨è¿™é‡Œè®°å½•ä¸€äº›è‡ªå·±åœ¨é˜…è¯»å½“ä¸­çš„æ„Ÿå—å’Œä½“ä¼šï¼Œé¡ºä¾¿ä¹Ÿåšä¸€ç‚¹æ‘˜æŠ„å•¥çš„ï¼Œæ—¥åèƒ½å¤Ÿå›å‘³å½“æ—¶çœ‹è¿™æœ¬ä¹¦çš„æ„Ÿå—å•¦ï¼</p>
<a id="more"></a>
<h4 id="1-æ–‡å­—å’Œè¯­è¨€vsæ•°å­—å’Œä¿¡æ¯"><a href="#1-æ–‡å­—å’Œè¯­è¨€vsæ•°å­—å’Œä¿¡æ¯" class="headerlink" title="1. æ–‡å­—å’Œè¯­è¨€vsæ•°å­—å’Œä¿¡æ¯"></a>1. æ–‡å­—å’Œè¯­è¨€vsæ•°å­—å’Œä¿¡æ¯</h4><ul>
<li>é€šä¿¡æ¨¡å¼ï¼šä¿¡æ¯æº -&gt; (æ€ªå«å£°ï¼Œç¼–ç ) -&gt; ä¿¡æ¯ï¼ˆä¿¡é“ä¼ è¾“ï¼‰-&gt;ï¼ˆå¬åˆ°çš„å£°éŸ³ï¼Œè§£ç ï¼‰-&gt; ä¿¡æ¯(æ¥æ”¶è€…)ï¼Œå¤äººé€šè¿‡å£°éŸ³æ¥ç›¸äº’ä¼ é€’ä¿¡æ¯ï¼Œå’Œç°åœ¨çš„ä¿¡æ¯ä¼ è¾“çš„æ¨¡å¼æ— å·®ã€‚</li>
<li><p>ç½—å¡å¡”çŸ³ç¢‘ï¼šç½—å¡å¡”çŸ³ç¢‘ä¸Šè®°å½•äº†ä»å¤åŸƒåŠè‡³ä»Šçš„å†å²ï¼Œç ´è¯‘è¿‡ç¨‹å½’åŠŸäºåœ¨çŸ³ç¢‘ä¹‹ä¸Šæœ‰ä¸‰ç§ä¸åŒè¯­è¨€ç‰ˆæœ¬çš„ä¿¡æ¯ã€‚æ‰€ä»¥ä½œè€…é€šè¿‡æ­¤å¾—åˆ°ä¸¤ä¸ªæœ‰ç”¨çš„ç»“è®ºï¼š</p>
<ul>
<li><code>ä¿¡æ¯å†—ä½™</code>æ˜¯ä¿¡æ¯å®‰å…¨çš„ä¿éšœã€‚åªè¦æœ‰ä¸€ä»½å†…å®¹è¢«å®Œæ•´çš„ä¿ç•™ä¸‹æ¥ï¼Œé‚£ä¹ˆä¿¡æ¯å°±ä¸ä¼šä¸¢å¤±ï¼Œè¿™å¯¹äºç°ä»£çš„ä¿¡é“ç¼–ç æœ‰ä¸€å®šçš„æŒ‡å¯¼æ„ä¹‰ã€‚</li>
<li><code>è¯­è¨€çš„æ•°æ®ï¼Œåˆè¢«æˆä¸ºè¯­æ–™</code>ã€‚åŒè¯­æˆ–è€…æ˜¯å¤šè¯­çš„å¯¹ç…§è¯­æ–™ï¼Œå¯¹äºmachine translationé¢†åŸŸçš„ç ”ç©¶æ˜¯ä¸€ä¸ªåŸºç¡€æ€§çš„å·¥ç¨‹ã€‚</li>
</ul>
</li>
<li><p>æ¥ä¸‹æ¥è¿›å…¥åˆ°æ•°å­—çš„éƒ¨åˆ†ï¼Œåœ¨æœ€å¼€å§‹çš„æ—¶å€™ï¼Œæ•°å­—åªæ˜¯å•çº¯çš„ç”¨æ¥è¿›è¡Œè®¡æ•°ï¼Œè€Œå¹¶æ²¡æœ‰æ›´åŠ é«˜å±‚çš„æŠ½è±¡æ¦‚å¿µè¡¨è¾¾ã€‚ä¾‹å¦‚ä¸­å›½ğŸ‡¨ğŸ‡³äººå¯¹äºä¸åŒä½æ•°æ•°å­—çš„ç¼–ç æ˜¯<code>ä¸ªåç™¾åƒä¸‡</code>ï¼Œè¿™ä¹Ÿå°±æ˜¯æœ€æœ€æœ´ç´ çš„<code>ç¼–ç æ–¹å¼</code>ï¼Œè€Œ<code>è§£ç æ–¹å¼</code>å°±æ˜¯æˆ‘ä»¬å¾ˆç†Ÿæ‚‰çš„ä¹˜æ³•ï¼Œä¾‹å¦‚<code>20000 = 2x10x1000</code>. </p>
</li>
<li>ä»è±¡å½¢æ–‡å­—åˆ°æ‹¼éŸ³æ–‡å­—çš„è½¬å˜æ˜¯ä¸€ä¸ªé£è·ƒï¼Œè¯´æ˜äººç±»åœ¨æè¿°ç‰©ä½“çš„æ–¹å¼ä¸ŠåŠ å…¥äº†<code>æŠ½è±¡</code>çš„å±‚æ¬¡ã€‚åŒæ—¶æˆ‘ä»¬ä¹Ÿèƒ½åœ¨æ—¥å¸¸çš„æ–‡å­—å½“ä¸­æ‰¾åˆ°<code>ä¿¡æ¯è®º</code>ä¸­<code>æœ€çŸ­ç¼–ç åŸç†</code>çš„å½±å­ã€‚æ¯”å¦‚è¯´å¸¸ç”¨çš„æ–‡å­—ä¸€èˆ¬ç¬”ç”»è¾ƒå°‘ï¼Œè€Œç”Ÿåƒ»å­—å¤§å¤šç¬”ç”»æ¯”è¾ƒå¤šã€‚è¿™ç§<code>æ–‡å­—è®¾è®¡æ–¹æ³•</code>æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ç§<code>ç¼–ç æ–¹å¼</code>ã€‚</li>
<li>å¤çŠ¹å¤ªäººæŠ„å†™ <strong>ã€Šåœ£ç»ã€‹</strong> çš„å°æ•…äº‹ï¼šåœ¨æŠ„å†™çš„æ—¶å€™éš¾å…ä¼šå­˜åœ¨æŠ„å†™é”™è¯¯çš„æƒ…å†µï¼Œé‚£ä¹ˆèªæ˜çš„å¤çŠ¹å¤ªäººå‘æ˜äº†ä¸€ç§å’Œç°ä»£é€šä¿¡å½“ä¸­<code>æ ¡éªŒä½</code>æ€æƒ³å¾ˆç±»ä¼¼çš„ä¸€ç§æ–¹æ³•ã€‚æŠŠæ¯ä¸€ä¸ªå¸Œä¼¯æ¥å­—æ¯å¯¹åº”ä¸€ä¸ªæ•°å­—ï¼Œç„¶åæ¯è¡Œæ–‡å­—åŠ èµ·æ¥å°±èƒ½å¾—åˆ°ä¸€ä¸ªç‰¹æ®Šçš„æ•°å­—ï¼ŒåŒæ—¶å¯¹äºæ¯ä¸€åˆ—çš„æ–‡å­—è¿›è¡ŒåŒæ ·çš„æ“ä½œã€‚è¿™æ ·å¯¹äºæ¯ä¸€è¡Œæ¯ä¸€åˆ—éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„<code>æ ¡éªŒä½</code>ï¼Œå½“æŠ„å†™å®Œä¸€é¡µçš„æ—¶å€™ï¼Œä¼šå»å’ŒåŸæ–‡é€ä¸€å¯¹æ¯”ï¼Œå¦‚æœä¸€è‡´å°±è¯´æ˜æŠ„å†™æ— è¯¯äº†ã€‚</li>
<li>è¿™ç« å½“ä¸­è¿˜æåˆ°äº†ä¸€ä¸ªè¯­è¨€å­¦ç ”ç©¶æ–¹æ³•çš„é—®é¢˜ï¼Œ<code>åˆ°åº•æ˜¯è¯­è¨€å¯¹ï¼Œè¿˜æ˜¯è¯­æ³•å¯¹</code>.å‰è€…åšæŒä»çœŸå®çš„è¯­å¥æ–‡æœ¬ï¼Œä»è¯­æ–™å‡ºå‘ï¼Œåè€…åˆ™æ˜¯åšæŒä»è¯­è¨€çš„è§„åˆ™å‡ºå‘å…¥æ‰‹ï¼Œå½“ç„¶ç°åœ¨çš„NLPé¢†åŸŸçš„æˆå°±å®£å‘Šæ˜¯å‰è€…çš„è·èƒœã€‚</li>
</ul>
<h4 id="2-è‡ªç„¶è¯­è¨€å¤„ç†-â€”-ä»è§„åˆ™åˆ°ç»Ÿè®¡"><a href="#2-è‡ªç„¶è¯­è¨€å¤„ç†-â€”-ä»è§„åˆ™åˆ°ç»Ÿè®¡" class="headerlink" title="2. è‡ªç„¶è¯­è¨€å¤„ç† â€” ä»è§„åˆ™åˆ°ç»Ÿè®¡"></a>2. è‡ªç„¶è¯­è¨€å¤„ç† â€” ä»è§„åˆ™åˆ°ç»Ÿè®¡</h4><ul>
<li>äººç±»çš„è¯­è¨€æœ¬è´¨ä¸Šæ˜¯ä¸€ç§ç¼–è§£ç çš„è¿‡ç¨‹ï¼Œäººæƒ³è¦å°†è‡ªå·±çš„æ‰€æƒ³è¡¨è¾¾å‡ºæ¥ï¼Œé€šè¿‡è¯­è¨€è¿›è¡Œ<code>ç¼–ç </code>ï¼Œç„¶åå…¶ä»–äººéœ€è¦ç†è§£ä½ çš„æ„æ€çš„è¯ï¼Œéœ€è¦å¯¹è¯­è¨€è¿›è¡Œ<code>è§£ç </code>ï¼Œä»è€Œè·å–åˆ°æƒ³è¦è¡¨è¾¾çš„æ„æ€ã€‚</li>
<li>æœ€æ—©æå‡º<code>æœºå™¨æ™ºèƒ½</code>æ€æƒ³çš„æ˜¯<code>é˜¿å…°å›¾çµ</code>åœ¨1950å¹´çš„ä¸€ç¯‡paperå½“ä¸­æå‡ºçš„ï¼Œä¹Ÿå³éå¸¸è‘—åçš„<code>å›¾çµæµ‹è¯•</code>ã€‚</li>
<li>å½“å‰çš„NLPé¢†åŸŸçš„æˆå°±å…¨éƒ½é çš„æ•°å­¦ï¼Œæ›´å‡†ç¡®çš„è¯´æ˜¯é çš„<code>ç»Ÿè®¡</code>çš„æ”¯æŒã€‚</li>
<li>NLPç ”ç©¶ä»æœ€æ—©çš„åŸºäºè¯­æ³•è§„åˆ™çš„æ–¹æ³•è½¬å˜åˆ°äº†åŸºäºæ•°å­¦ç»Ÿè®¡çš„æ–¹æ³•ã€‚åŒæ—¶NLPç ”ç©¶ä¹Ÿä»å•çº¯çš„<code>å¥æ³•åˆ†æå’Œè¯­ä¹‰ç†è§£</code>ï¼Œå˜æˆäº†éå¸¸è´´è¿‘å®é™…åº”ç”¨çš„MTã€è¯­éŸ³è¯†åˆ«ã€æ•°æ®æŒ–æ˜ã€çŸ¥è¯†è·å–ç­‰ç­‰å®é™…é¢†åŸŸã€‚</li>
</ul>
<h4 id="3-ç»Ÿè®¡è¯­è¨€æ¨¡å‹"><a href="#3-ç»Ÿè®¡è¯­è¨€æ¨¡å‹" class="headerlink" title="3. ç»Ÿè®¡è¯­è¨€æ¨¡å‹"></a>3. ç»Ÿè®¡è¯­è¨€æ¨¡å‹</h4><ul>
<li>è‡ªç„¶è¯­è¨€é€æ¸æ¼”å˜ä¸º<code>ä¸Šä¸‹æ–‡ç›¸å…³çš„ä¿¡æ¯è¡¨è¾¾å’Œä¼ é€’æ–¹å¼</code>ï¼Œä¸€ä¸ªåŸºæœ¬é—®é¢˜å°±æ˜¯ä¸ºè¿™ç§ä¸Šä¸‹æ–‡ç›¸å…³çš„ç‰¹æ€§å»ºç«‹<code>ç»Ÿè®¡æ•°å­¦æ¨¡å‹</code>ã€‚ä¹Ÿå°±æ˜¯NLPå½“ä¸­éå¸¸é‡è¦çš„<a href="https://zhuanlan.zhihu.com/p/27201427" target="_blank" rel="noopener">ç»Ÿè®¡è¯­è¨€æ¨¡å‹</a></li>
<li><strong>é©¬å°”å¯å¤«å‡è®¾</strong>ï¼šå‡è®¾æ¯ä¸ªè¯å‡ºç°çš„æ¦‚ç‡$\omega_i$åªä¸å‰ä¸€ä¸ªè¯$\omega_{i-1}$æ˜¯ç›¸å…³çš„ï¼Œä¹Ÿå°±æ˜¯æœ€åä¸€ä¸ªå¥å­å‡ºç°çš„æ¦‚ç‡è¡¨ç¤ºä¸º$p(S) = p(\omega_1) * p(\omega_2|\omega_1) * p(\omega_3|\omega_2) * â€¦ * p(\omega_n|\omega_{n-1})$. è¿™ç§æ¨¡å‹åˆå«åš<code>äºŒå…ƒæ¨¡å‹</code>ï¼Œå¦‚æœæ˜¯ä¹‹å‰çš„ä»¥å‰nä¸ªæ¨¡å‹å‡ºç°çš„æ¦‚ç‡æ¥ä¼°è®¡ä¸‹ä¸€ä¸ªè¯å‡ºç°çš„æ¦‚ç‡ï¼Œåˆ™è¿™ç§æ¨¡å‹å«åš<code>Nå…ƒæ¨¡å‹</code>.<br>è½¬æ¢æˆè¿™ç§å½¢å¼ä¹‹åï¼Œå°±èƒ½å¾ˆæ–¹ä¾¿çš„é€šè¿‡<code>è¯­æ–™</code>æ¥è§£å†³ç»Ÿè®¡çš„é—®é¢˜ï¼Œæ ¹æ®<code>å¤§æ•°å®šç†</code>ï¼Œæœ€åçš„é¢‘ç‡ä¼°è®¡å°±åŸºæœ¬è¿‘ä¼¼äºå®é™…çš„æ¦‚ç‡ä¼°è®¡ï¼Œä¹Ÿå³ï¼š<script type="math/tex; mode=display">
p(\omega_n|\omega_{n-1}) = \frac{p(\omega_n, \omega_{n-1})}{p(\omega_{n-1})} \tag{1}</script></li>
</ul>
<h4 id="4-åˆ†è¯"><a href="#4-åˆ†è¯" class="headerlink" title="4. åˆ†è¯"></a>4. åˆ†è¯</h4>]]></content>
      <categories>
        <category>Reading</category>
      </categories>
      <tags>
        <tag>Math</tag>
        <tag>Reading</tag>
      </tags>
  </entry>
  <entry>
    <title>cs224n-papers</title>
    <url>/2020/07/28/cs224n-papers/</url>
    <content><![CDATA[<p>This post will mainly contain the paper notes about the papers in cs224n course. Usually some typical papers in nlp field.<br><a id="more"></a></p>
<hr>
<h1 id="word2vec"><a href="#word2vec" class="headerlink" title="word2vec"></a><a href="https://arxiv.org/abs/1301.3781" target="_blank" rel="noopener">word2vec</a></h1><h2 id="Model-Architectures"><a href="#Model-Architectures" class="headerlink" title="Model Architectures"></a>Model Architectures</h2><p>Mainly two types: NNLM and RNNLM.</p>
<h2 id="New-log-linear-models"><a href="#New-log-linear-models" class="headerlink" title="New log-linear models"></a>New log-linear models</h2><h3 id="CBOW"><a href="#CBOW" class="headerlink" title="CBOW"></a>CBOW</h3><p>CBOW(continuos bag of words) model, the main idea is using context to predict the center word. Input is the context words, with one projection hidden layer, and output center word. The architecture is shown:</p>
<div align="center">
<img src="/2020/07/28/cs224n-papers/1-1.png" style="width: 40%">
</div>

<h3 id="Skip-gram-model"><a href="#Skip-gram-model" class="headerlink" title="Skip-gram model"></a>Skip-gram model</h3><p>Skip-gram model is different from CBOW, in skip-gram model, it tries to maximize classification of a word based on another word in the same sentence. So input is the center word, with one projection layer, and output is the probabilities of other context words. The architecture is shown:</p>
<div align="center">
<img src="/2020/07/28/cs224n-papers/1-2.png" style="width: 40%">
</div>

<hr>
<h1 id="Distributed-Representations-of-Words-and-Phrases-and-their-Compositionality"><a href="#Distributed-Representations-of-Words-and-Phrases-and-their-Compositionality" class="headerlink" title="Distributed Representations of Words and Phrases and their Compositionality"></a><a href="https://arxiv.org/abs/1310.4546" target="_blank" rel="noopener">Distributed Representations of Words and Phrases and their Compositionality</a></h1><h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p>In this paper we present several extensions that improve both the quality of the vectors and the training speed. By <code>subsampling of the frequent words</code> we obtain significant speedup and also learn more regular word representations. We also describe a simple alternative to the <code>hierarchical softmax</code> called <code>negative sampling</code>.</p>
<h2 id="Skip-gram-model-1"><a href="#Skip-gram-model-1" class="headerlink" title="Skip-gram model"></a>Skip-gram model</h2><p>Try to maximize the avg log probility:</p>
<script type="math/tex; mode=display">
\frac{1}{T} \sum_{t=1}^{T} \sum_{-c \leq j \leq c, j \neq 0} \log p\left(w_{t+j} \mid w_{t}\right)</script><p>And the probility is calculated using softmax function:</p>
<script type="math/tex; mode=display">
p\left(w_{O} \mid w_{I}\right)=\frac{\exp \left(v_{w o}^{\prime}{\top} v_{w_{I}}\right)}{\sum_{w=1}^{W} \exp \left(v_{w}^{\prime}{ }^{\top} v_{w_{I}}\right)}</script><p>But in actual scene, itâ€™s inpractical because the $\nabla \log p\left(w_{O} \mid w_{I}\right)$ is related to W, usally is very large, so there are some tricks to faster the training process.</p>
<h2 id="Hierarchical-Softmax"><a href="#Hierarchical-Softmax" class="headerlink" title="Hierarchical Softmax"></a>Hierarchical Softmax</h2><p>Using Huffleman tree to reduce the word num in softmax function.</p>
<div align="center">
<img src="/2020/07/28/cs224n-papers/2-1.png" style="width: 95%">
</div>

<h2 id="Negative-Sampling"><a href="#Negative-Sampling" class="headerlink" title="Negative Sampling"></a>Negative Sampling</h2><p>negative sampling has 2 effects that can fast the training process. First is to use $\sigma$: logisitic regression to replace the softmax to represent the probility. Second is to subsample the negative samples. Meanwhile it can just update some of the parameters in backpropogation, because we just random choose k negative samples not all negative samples.</p>
<p>The formula can represent as:</p>
<script type="math/tex; mode=display">
\log \sigma\left(v_{w_{O}}^{\prime}{ }^{\top} v_{w_{I}}\right)+\sum_{i=1}^{k} E_{w_{i} \sim P_{n}(w)}\left[\log \sigma\left(-v_{w_{i}}^{\prime}{ }^{\top} v_{w_{I}}\right)\right]</script><p>To replace the $\log P\left(w_{O} \mid w_{I}\right)$ term in skip-gram.</p>
<h2 id="Subsampling-of-Frequent-Words"><a href="#Subsampling-of-Frequent-Words" class="headerlink" title="Subsampling of Frequent Words"></a>Subsampling of Frequent Words</h2><p>To counter the imbalance between the rare and frequent words, we used a simple subsampling approach: each word $\omega_i$ in the training set is discarded with probability computed by the formula:</p>
<script type="math/tex; mode=display">
P\left(w_{i}\right)=1-\sqrt{\frac{t}{f\left(w_{i}\right)}}</script><p>t is a sample threshold, t is higher means the probility of discarding will go high. And $f(\omega_i)$ means the frequency of word $\omega_i$. </p>
<hr>
<h1 id="GloVe-Global-Vectors-for-Word-Representation"><a href="#GloVe-Global-Vectors-for-Word-Representation" class="headerlink" title="GloVe: Global Vectors for Word Representation"></a><a href="https://nlp.stanford.edu/pubs/glove.pdf" target="_blank" rel="noopener">GloVe: Global Vectors for Word Representation</a></h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>There are two main families in word vector learning:</p>
<ul>
<li><p>global matrix factorization methods, such as latent semantic analysis (LSA)</p>
<ul>
<li>efficiently leverage global statiscal information</li>
<li>But sub-optimal vector space structure</li>
</ul>
</li>
<li><p>local context window methods, such as the skip-gram model</p>
<ul>
<li>poorly utilize the statistics since looking at local context window</li>
</ul>
</li>
</ul>
<h2 id="Glove-Model"><a href="#Glove-Model" class="headerlink" title="Glove Model"></a>Glove Model</h2><h3 id="Some-notations"><a href="#Some-notations" class="headerlink" title="Some notations"></a>Some notations</h3><ul>
<li>$X$: word-word co-occurrence matrix</li>
<li>$X_{ij}$: number of times that j appears in context words of i</li>
<li>$X_i$ = $\sum_{k} X_{ik}$: number of times any word appears<br>in the context of word i</li>
<li>$P_{ij} = P(j | i) = X_{ij} / X_{i}$: probability that word j appear in the context word of i.</li>
</ul>
<h3 id="Insight"><a href="#Insight" class="headerlink" title="Insight"></a>Insight</h3><p>The probability ratio in co-occurrence matrix is better to distingulish relevant words from irrelavant word.</p>
<div align="center">
<img src="/2020/07/28/cs224n-papers/3-1.png" style="width: 95%">
</div>

<h3 id="Formula"><a href="#Formula" class="headerlink" title="Formula"></a>Formula</h3><p>Begin with this insight, then we need to find one formula to optimize it. The ratio mainly related with three words: i, j, k.</p>
<script type="math/tex; mode=display">
F\left(w_{i}, w_{j}, {\tilde{w}}_{k} \right) = \frac{P_{i k}}{P_{j k}}</script><p>Since vector spaces are inherently linear structures, the most natural way to do this is with vector differences. So we can get this formula:</p>
<script type="math/tex; mode=display">
F\left(w_{i}-w_{j}, \tilde{w}_{k} \right)=\frac{P_{i k}}{P_{j k}}</script><p>We notice that the left side is vector and right side is scalar. So we change the formula to:</p>
<script type="math/tex; mode=display">
F\left(\left(w_{i}-w_{j}\right)^{T} \tilde{w}_{k}\right)=\frac{P_{i k}}{P_{j k}}</script><p>Since the F function is required to be homomorphism, so we need the F function to be:</p>
<script type="math/tex; mode=display">
F\left(\left(w_{i}-w_{j}\right)^{T} \tilde{w}_{k}\right)=\frac{F\left(w_{i}^{T} \tilde{w}_{k}\right)}{F\left(w_{j}^{T} \tilde{w}_{k}\right)}</script><p>Together with the two formulas, we can get the following formula:</p>
<script type="math/tex; mode=display">
F\left(w_{i}^{T} \tilde{w}_{k}\right)=P_{i k}=\frac{X_{i k}}{X_{i}}</script><p>Then we can take F as exp function, so we can deduct that:</p>
<script type="math/tex; mode=display">
w_{i}^{T} \tilde{w}_{k}=\log \left(P_{i k}\right)=\log \left(X_{i k}\right)-\log \left(X_{i}\right)</script><p>And we notice that, inorder to keep the exchange symmetry for the left side, so we can add bias term for word i and k, inorder to keep the symmetry. So we can get the final equation:</p>
<script type="math/tex; mode=display">
w_{i}^{T} \tilde{w}_{k}+b_{i}+\tilde{b}_{k}=\log \left(X_{i k}\right)</script><p>Since we get this formula, then we can construct the optimization of the objective function. The objective function is simply an weighted MSE.</p>
<script type="math/tex; mode=display">
J=\sum_{i, j=1}^{V} f\left(X_{i j}\right)\left(w_{i}^{T} \tilde{w}_{j}+b_{i}+\tilde{b}_{j}-\log X_{i j}\right)^{2}</script><p>The $f(X_{ij})$ is to control the weight of the cost function. And the weighting function should obey the following rules:</p>
<ul>
<li>f(0) = 0</li>
<li>non-decreasing function, since rare co-occurrences are not overweighted</li>
<li>should be relatively small for large values of x, so that frequent co-occurrences are not overweighted</li>
</ul>
<p>So the paper gives us a formula:</p>
<script type="math/tex; mode=display">
f(x)=\left\{\begin{array}{cc}
\left(x / x_{\max }\right)^{\alpha} & \text { if } x<x_{\max } \\
1 & \text { otherwise }
\end{array}\right.</script><div align="center">
<img src="/2020/07/28/cs224n-papers/3-2.png" style="width: 95%">
</div>]]></content>
      <categories>
        <category>nlp</category>
      </categories>
      <tags>
        <tag>cs224n</tag>
        <tag>nlp</tag>
      </tags>
  </entry>
  <entry>
    <title>leetcode-solutions</title>
    <url>/2020/08/06/leetcode-solutions/</url>
    <content><![CDATA[<p>This post will mainly and continuously contain the leetcode algorithm problemsâ€™ solutions. Trying to force myself to learn something everyday and practice programming skills everyday!</p>
<a id="more"></a>
<h3 id="001-two-sum"><a href="#001-two-sum" class="headerlink" title="001-two-sum"></a><a href="https://leetcode.com/problems/two-sum/" target="_blank" rel="noopener">001-two-sum</a></h3><p>The problem is trying to find two indices in the input array which their sum is equal to the target.</p>
<p>So we can use the <code>unordered_map</code> to store the value and index. And to test: <code>1: target - num is in the unordered map</code>, <code>2: if contains, the another index should be different from current index.</code></p>
<p>Then we get the two index and return. Here is the solution code.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; twoSum(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; indices_map;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; results;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.size(); i++) &#123;</span><br><span class="line">        indices_map[nums[i]] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> another_num = target - nums[i];</span><br><span class="line">        <span class="keyword">if</span> (indices_map.count(another_num) != <span class="number">0</span> &amp;&amp; i != indices_map[another_num]) &#123;</span><br><span class="line">            results.push_back(i);</span><br><span class="line">            results.push_back(indices_map[another_num]);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> results;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="002-Add-Two-Numbers"><a href="#002-Add-Two-Numbers" class="headerlink" title="002-Add-Two-Numbers"></a><a href="https://leetcode.com/problems/add-two-numbers/" target="_blank" rel="noopener">002-Add-Two-Numbers</a></h3><p>This problem mainly inspect the addition of strings(a little like). Because the integer can be very large, bigger than long long, like 1e30 etc. </p>
<p>So we need to find a way to add the two number, that is the string addition. We just need one <code>carry</code> to represent carry bit, initial is 0. </p>
<p>Everytime after we add the correponding position number, the remaining number will be <code>(sum + carry) % 10</code>, and the carry bit will update as <code>(sum + carry) / 10</code>.</p>
<p>Remember that if at last the <code>carry != 0</code>, then we need another node to put the carry in.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">ListNode* <span class="title">addTwoNumbers</span><span class="params">(ListNode* l1, ListNode* l2)</span> </span>&#123;</span><br><span class="line">    ListNode* head = <span class="keyword">new</span> ListNode;</span><br><span class="line">    ListNode* cur = head;</span><br><span class="line">    <span class="keyword">int</span> carry = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (l1 != <span class="literal">nullptr</span> &amp;&amp; l2 != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> num = l1-&gt;val + l2-&gt;val;</span><br><span class="line">        ListNode* ptr = <span class="keyword">new</span> ListNode((num + carry) % <span class="number">10</span>);</span><br><span class="line">        carry = (num + carry) / <span class="number">10</span>;</span><br><span class="line">        cur-&gt;next = ptr;</span><br><span class="line">        cur = cur-&gt;next;</span><br><span class="line">        l1 = l1-&gt;next; l2 = l2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (l1 != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        cur-&gt;next = l1;</span><br><span class="line">        <span class="keyword">while</span> (l1 != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            cur = l1;</span><br><span class="line">            <span class="keyword">int</span> num = l1-&gt;val + carry;</span><br><span class="line">            l1-&gt;val = num % <span class="number">10</span>;</span><br><span class="line">            carry = num / <span class="number">10</span>;</span><br><span class="line">            l1 = l1-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (l2 != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        cur-&gt;next = l2;</span><br><span class="line">        <span class="keyword">while</span> (l2 != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            cur = l2;</span><br><span class="line">            <span class="keyword">int</span> num = l2-&gt;val + carry;</span><br><span class="line">            l2-&gt;val = num % <span class="number">10</span>;</span><br><span class="line">            carry = num / <span class="number">10</span>;</span><br><span class="line">            l2 = l2-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (carry != <span class="number">0</span>) &#123;</span><br><span class="line">        cur-&gt;next = <span class="keyword">new</span> ListNode(carry);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head-&gt;next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="003-Longest-Substring-Without-Repeating-Characters"><a href="#003-Longest-Substring-Without-Repeating-Characters" class="headerlink" title="003-Longest-Substring-Without-Repeating-Characters"></a><a href="https://leetcode.com/problems/longest-substring-without-repeating-characters/" target="_blank" rel="noopener">003-Longest-Substring-Without-Repeating-Characters</a></h3><p>This problem is trying to find the <code>longest substring without repreating</code>. The naive way to solve is to examine every substring in input string, but the time complexity is to high(O(n^3)). So I take one optimized solution.</p>
<p>Suppose we have input string <code>abcdcae</code>, and we need one array to examine whether one character is in current substring, so we need <code>int s_index_map[128]</code>, initial is <code>-1</code>, later we will use this to store index.</p>
<p>Then we loop the string, and to test if the current character is in the current substring. we need other params: <code>max_num: the final result</code>, <code>tmp_num: current substring length</code>.</p>
<ul>
<li><p><strong>not in</strong></p>
<ul>
<li><code>tmp_num += 1</code></li>
<li><code>s_index_map[char]</code> = current_index</li>
</ul>
</li>
<li><p><strong>is in</strong></p>
<ul>
<li><code>max_num = max(max_num, tmp_num)</code></li>
<li>find out the old index of the repreated character, which is <code>old_index = s_index_map[c]</code></li>
<li>update the index <code>s_index_map[c] = current_index</code></li>
<li>update tmp_num to length of new substring: <code>tmp_num = cur - old</code></li>
<li>erase the values from the start position to old index position.</li>
</ul>
</li>
</ul>
<p>Take the example of <code>abcdcae</code>, <code>abcd</code> is easy, after these, s[a] = 0, s[b] = 1, â€¦ etc. And then <code>c</code> is in, we meet one repeated character right? So take a look of our table, the old <code>c</code> is in <code>index: 2</code> position. So the new substring should start from <code>d</code>, which is <code>index: 3</code> position right, otherwise we still have two <code>c</code>â€˜s in our string.</p>
<p>So first update <code>max_num = 4</code>, then the <code>old_index = 2</code>, update the index of <code>c</code>, which is set <code>s[c] = 4</code>. Then update the <code>tmp_num</code> to length of new substring <code>&quot;dc&quot;</code>, which is <code>new - old = 4 - 2 = 2</code>. Final step, we should erase the origin substring <code>&#39;a&#39; and &#39;b&#39;</code> index to <code>-1</code>, since they are not in our new substring anymore.</p>
<p>After looping all the characters, do not  forget to take the max value of <code>max_num</code> and <code>tmp_num</code> to get the final answer.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> s_index_map[<span class="number">128</span>];</span><br><span class="line">    <span class="built_in">memset</span>(s_index_map, <span class="number">-1</span>, <span class="keyword">sizeof</span>(s_index_map));</span><br><span class="line">    <span class="keyword">int</span> max_num = <span class="number">0</span>; <span class="keyword">int</span> tmp_num = <span class="number">0</span>; <span class="keyword">int</span> start_pos = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length(); i++) &#123;</span><br><span class="line">        <span class="keyword">char</span> cur = s[i];</span><br><span class="line">        <span class="keyword">if</span> (s_index_map[cur] == <span class="number">-1</span>) &#123;</span><br><span class="line">            tmp_num += <span class="number">1</span>;</span><br><span class="line">            s_index_map[cur] = i;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            max_num = <span class="built_in">std</span>::max(max_num, tmp_num); <span class="comment">// first update max_num, since we met overlap</span></span><br><span class="line">            <span class="keyword">int</span> old_index = s_index_map[cur]; <span class="comment">// old index</span></span><br><span class="line">            s_index_map[cur] = i; <span class="comment">// update index</span></span><br><span class="line">            tmp_num = i - old_index; <span class="comment">// new length</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">/*erase the values between old char and new char*/</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = start_pos; j &lt; old_index; j++) s_index_map[s[j]] = <span class="number">-1</span>;</span><br><span class="line">            start_pos = old_index + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    max_num = <span class="built_in">std</span>::max(max_num, tmp_num); <span class="comment">// final update</span></span><br><span class="line">    <span class="keyword">return</span> max_num;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="004-Median-of-Two-Sorted-Arrays"><a href="#004-Median-of-Two-Sorted-Arrays" class="headerlink" title="004-Median of Two Sorted Arrays"></a><a href="https://leetcode.com/problems/median-of-two-sorted-arrays/" target="_blank" rel="noopener">004-Median of Two Sorted Arrays</a></h3><p>This problem is to find the median number of two sorted arrays. So we just need another array to store the numbers of two arrays in increasing order. And if we find the middle position, just break.</p>
<p>We have two situations to handle, which is the total length is odd or even.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">findMedianSortedArrays</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums1, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> l = nums1.size() + nums2.size(); <span class="keyword">double</span> result = <span class="number">0.0</span>; <span class="keyword">bool</span> find_flag = <span class="literal">false</span>;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;nums; nums.reserve(l); <span class="keyword">int</span> index = <span class="number">0</span>, i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (i &lt; nums1.size() &amp;&amp; j &lt; nums2.size()) &#123;</span><br><span class="line">        nums[index++] = nums1[i] &lt; nums2[j] ? nums1[i++] : nums2[j++];</span><br><span class="line">        <span class="keyword">if</span> (index == l / <span class="number">2</span> + <span class="number">1</span>) &#123;</span><br><span class="line">            find_flag = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; nums1.size() &amp;&amp; !find_flag) &#123;</span><br><span class="line">        nums[index++] = nums1[i++];</span><br><span class="line">        <span class="keyword">if</span> (index == l / <span class="number">2</span> + <span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (j &lt; nums2.size() &amp;&amp; !find_flag) &#123;</span><br><span class="line">        nums[index++] = nums2[j++];</span><br><span class="line">        <span class="keyword">if</span> (index == l / <span class="number">2</span> + <span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (l % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        result = (nums[l / <span class="number">2</span>] + nums[l / <span class="number">2</span> - <span class="number">1</span>]) / <span class="number">2.0</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        result = nums[l / <span class="number">2</span>] * <span class="number">1.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="005-Longest-Palindromic-Substring"><a href="#005-Longest-Palindromic-Substring" class="headerlink" title="005-Longest-Palindromic-Substring"></a><a href="https://leetcode.com/problems/longest-palindromic-substring/" target="_blank" rel="noopener">005-Longest-Palindromic-Substring</a></h3><p>This problem is trying to find the lngest palindromic substring of the input string. Suppose the input string s is <code>abcbd</code>, then the output should be <code>bcb</code>.</p>
<p>(1) <strong>Naive solution</strong></p>
<p>The first solution is very simple and easy to understand. I use the two pointer to represent the start and end of one substring. And then loop the <code>length</code> from <code>len(s)</code> to <code>1</code>. Once we found one palindromic substring, then return the result string.</p>
<p>To judge one string is palindromic or not is simple, just to see whether the corresponding character of head and tail is the same.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isPalindrome</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">const</span> <span class="built_in">string</span>&amp; s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> isp = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> ll = l, rr = r; ll &lt;= rr; ll++, rr--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (s[ll] != s[rr]) &#123;</span><br><span class="line">            isp = <span class="literal">false</span>; <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> isp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">longestPalindrome</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> l = s.length(); <span class="keyword">bool</span> find = <span class="literal">false</span>; <span class="keyword">int</span> i, length;</span><br><span class="line">    <span class="keyword">if</span> (s.length() &lt;= <span class="number">1</span>) <span class="keyword">return</span> s;</span><br><span class="line">    <span class="keyword">for</span> (length = l; length &gt; <span class="number">0</span>; length--) &#123;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= l - length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[i] != s[i + length - <span class="number">1</span>]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (isPalindrome(i, i + length - <span class="number">1</span>, s)) &#123;</span><br><span class="line">                find = <span class="literal">true</span>; <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (find) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s.substr(i, length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>(2) <strong>Dynamic programming solution</strong></p>
<p>In this solution, we define that <code>dp[i][j]</code> represents whether the substring from position <code>i</code> to <code>j</code> is palindromic. </p>
<p>The initial state is <code>dp[i][i] = true</code> and <code>dp[i][i + 1] = s[i] == s[i + 1]</code>. </p>
<p>And we know that if one substring is palindromic, then we add two left and right letters, if the two letter is the same, then the new string is palindromic. Take one example, <code>aba</code> is palindromic, then <code>cabac</code> must be palindromic since <code>c</code> and <code>c</code> is the same.</p>
<p>Then we can deduct the transition equation: <code>dp[i][j] = dp[i + 1][j - 1] &amp;&amp; s[i] == s[j]</code>. So we just need to loop length from 3 to <code>len(s)</code>, we can get the dp array now, the time conplexity is $O(n^2)$.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">longestPalindrome</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (s.length() &lt;= <span class="number">1</span>) <span class="keyword">return</span> s;</span><br><span class="line">    <span class="keyword">auto</span> length = s.length();</span><br><span class="line">    <span class="keyword">bool</span> dp[length][length];</span><br><span class="line">    <span class="comment">// initial</span></span><br><span class="line">    <span class="keyword">int</span> max_num = <span class="number">-1</span>, mi = <span class="number">0</span>, mj = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        dp[i][i] = <span class="literal">true</span>;</span><br><span class="line">        dp[i][i + <span class="number">1</span>] = s[i] == s[i + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (dp[i][i + <span class="number">1</span>] == <span class="literal">true</span>) &#123;</span><br><span class="line">            max_num = <span class="number">2</span>;</span><br><span class="line">            mi = i; mj = i + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    dp[length - <span class="number">1</span>][length - <span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">// transition equation</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> t_length = <span class="number">3</span>; t_length &lt;= length; t_length++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= length - t_length; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> j = i + t_length - <span class="number">1</span>;</span><br><span class="line">            dp[i][j] = dp[i + <span class="number">1</span>][j - <span class="number">1</span>] &amp;&amp; s[i] == s[j];</span><br><span class="line">            <span class="keyword">if</span> (dp[i][j] == <span class="literal">true</span> &amp;&amp; t_length &gt; max_num) &#123;</span><br><span class="line">                max_num = t_length;</span><br><span class="line">                mi = i; mj = j;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s.substr(mi, mj - mi + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="006-ZigZag-Conversion"><a href="#006-ZigZag-Conversion" class="headerlink" title="006-ZigZag-Conversion"></a><a href="https://leetcode.com/problems/zigzag-conversion/" target="_blank" rel="noopener">006-ZigZag-Conversion</a></h3><p>This problem is to write the input string in a new zigzag form. So I use two-dimension vector to simulate the writing process. Notice one particur case: if <code>numRows = 1</code>, our index should just stay as <code>0</code>. Here is the code:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">convert</span><span class="params">(<span class="built_in">string</span> s, <span class="keyword">int</span> numRows)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt; &gt; c_vec (numRows); <span class="keyword">int</span> c = <span class="number">0</span>; <span class="keyword">bool</span> up_flag = <span class="literal">true</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="number">0</span>) up_flag = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (c == numRows - <span class="number">1</span>) up_flag = <span class="literal">false</span>;</span><br><span class="line">        c_vec[c].push_back(s[i]);</span><br><span class="line">        <span class="keyword">if</span> (numRows != <span class="number">1</span>) &#123;</span><br><span class="line">            c = up_flag ? c + <span class="number">1</span> : c - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">string</span> r;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; c_vec.size(); i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; c_vec[i].size(); j++) &#123;</span><br><span class="line">            r.push_back(c_vec[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="007-Reverse-Integer"><a href="#007-Reverse-Integer" class="headerlink" title="007-Reverse-Integer"></a><a href="https://leetcode.com/problems/reverse-integer/" target="_blank" rel="noopener">007-Reverse-Integer</a></h3><p>The problem is easy, we only need to consider in which case the reversed number will overflow. Since we will use annotation <code>r</code> to represent the intermediate result. So if <code>r &lt;= INT_MAX / 10</code>, then we can continue, otherwise just return 0.</p>
<p>The other thing is that we simplily notice the sign that is ok!</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sign = (x &lt; <span class="number">0</span>) ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (x != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (r &lt;= INT_MAX / <span class="number">10</span>) &#123;</span><br><span class="line">            r = r * <span class="number">10</span> + <span class="built_in">abs</span>(x % <span class="number">10</span>);</span><br><span class="line">            x /= <span class="number">10</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r * sign;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="008-String-to-Integer-atoi"><a href="#008-String-to-Integer-atoi" class="headerlink" title="008-String to Integer (atoi)"></a><a href="https://leetcode.com/problems/string-to-integer-atoi/" target="_blank" rel="noopener">008-String to Integer (atoi)</a></h3><ul>
<li>First find out the first not <code>whitespace</code> character</li>
<li>if not <code>-</code> or <code>+</code> or digits, return 0</li>
<li>if <code>-</code> or <code>+</code>, add to minus flag <code>-1</code>, <code>1</code>.</li>
<li><p>Then judge whether overflow</p>
<ul>
<li><code>result &gt; INT_MAX / 10) || (result == INT_MAX / 10 &amp;&amp; c &gt;= 7</code> return <code>INT_MAX</code> when result is positive</li>
<li><code>result &lt; INT_MIN / 10 || (result == INT_MIN / 10 &amp;&amp; c &gt;= 8</code> return <code>INT_MIN</code> when result is negative</li>
<li><code>INT_MAX=2147483647</code>, <code>INT_MIN=-2147483648</code>.</li>
</ul>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">myAtoi</span><span class="params">(<span class="built_in">string</span> str)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (str == <span class="string">""</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">string</span> s; <span class="keyword">int</span> minus_flag = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// find the first not ""</span></span><br><span class="line">    <span class="keyword">int</span> index = str.find_first_not_of(<span class="string">" "</span>);</span><br><span class="line">    <span class="keyword">if</span> (index == <span class="number">-1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (str[index] == <span class="string">'-'</span> || str[index] == <span class="string">'+'</span>) &#123;</span><br><span class="line">        minus_flag = str[index] == <span class="string">'-'</span> ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">        index++;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (!<span class="built_in">isdigit</span>(str[index])) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (; index &lt; str.length(); index++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">isdigit</span>(str[index])) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">int</span> c = str[index] - <span class="string">'0'</span>;</span><br><span class="line">        <span class="keyword">if</span> (minus_flag == <span class="number">1</span> &amp;&amp; (result &gt; INT_MAX / <span class="number">10</span>) || (result == INT_MAX / <span class="number">10</span> &amp;&amp; c &gt;= <span class="number">7</span>)) <span class="keyword">return</span> INT_MAX;</span><br><span class="line">        <span class="keyword">if</span> (minus_flag == <span class="number">-1</span> &amp;&amp; (result &lt; INT_MIN / <span class="number">10</span> || (result == INT_MIN / <span class="number">10</span> &amp;&amp; c &gt;= <span class="number">8</span>))) <span class="keyword">return</span> INT_MIN;</span><br><span class="line">        result = result * <span class="number">10</span> + minus_flag * c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="009-Palindrome-Number"><a href="#009-Palindrome-Number" class="headerlink" title="009-Palindrome-Number"></a><a href="https://leetcode.com/problems/palindrome-number/" target="_blank" rel="noopener">009-Palindrome-Number</a></h3><p>This problem is very easy. Since the negative number is definitely not palindromic, so <code>if x &lt; 0: return false</code>. Then just get every number of input x, and to loop from left to right and right to left, to examine whether the corresponding character is the same.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isPalindrome</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">int</span> vec[<span class="number">10</span>]; <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (x != <span class="number">0</span>) &#123;</span><br><span class="line">        vec[index++] = x % <span class="number">10</span>;</span><br><span class="line">        x /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = index - <span class="number">1</span>; i &lt;= j; i++, j--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (vec[i] != vec[j]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="011-Container-With-Most-Water"><a href="#011-Container-With-Most-Water" class="headerlink" title="011-Container-With-Most-Water"></a><a href="https://leetcode.com/problems/container-with-most-water/" target="_blank" rel="noopener">011-Container-With-Most-Water</a></h3><p>The thought is a little like greedy algorithm. We will compare the left and right height, and to replace the shorter one with the adjacent line. Since the area is depends on the shorter line, so we will replace shorter one inorder to get larger area.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxArea</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; height)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = height.size() - <span class="number">1</span>; <span class="keyword">int</span> max_num = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt;= j) &#123;</span><br><span class="line">        max_num = max(max_num, (j - i) * min(height[i], height[j]));</span><br><span class="line">        height[i] &lt; height[j] ? i++ : j--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> max_num;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="012-Integer-to-Roman"><a href="#012-Integer-to-Roman" class="headerlink" title="012-Integer-to-Roman"></a><a href="https://leetcode.com/problems/integer-to-roman/" target="_blank" rel="noopener">012-Integer-to-Roman</a></h3><p>Just loop the predefined symbols and corresponding ints. If contain some symbols multiple times, just add into result string.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">intToRoman</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; symbols &#123;<span class="string">"M"</span>, <span class="string">"CM"</span>, <span class="string">"D"</span>, <span class="string">"CD"</span>, <span class="string">"C"</span>, <span class="string">"XC"</span>, <span class="string">"L"</span>, <span class="string">"XL"</span>, <span class="string">"X"</span>, <span class="string">"IX"</span>, <span class="string">"V"</span>, <span class="string">"IV"</span>, <span class="string">"I"</span>&#125;;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; symbol_ints &#123;<span class="number">1000</span>, <span class="number">900</span>, <span class="number">500</span>, <span class="number">400</span>, <span class="number">100</span>, <span class="number">90</span>, <span class="number">50</span>, <span class="number">40</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="built_in">string</span> s;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; symbols.size() &amp;&amp; num != <span class="number">0</span>;) &#123;</span><br><span class="line">        <span class="keyword">if</span> (num / symbol_ints[i] != <span class="number">0</span>) &#123;</span><br><span class="line">            s += symbols[i];</span><br><span class="line">            num -= symbol_ints[i];</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="013-Roman-to-Integer"><a href="#013-Roman-to-Integer" class="headerlink" title="013-Roman-to-Integer"></a><a href="https://leetcode.com/problems/roman-to-integer/" target="_blank" rel="noopener">013-Roman-to-Integer</a></h3><p>My solution is first to insert the pairs into one map. And then to scan the input string, first to find whether <code>&quot;xx&quot;</code> is in the input string, if not then find <code>&quot;x&quot;</code>, and add the corresponding result can get the final answer.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">romanToInt</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; symbols &#123;<span class="string">"M"</span>, <span class="string">"CM"</span>, <span class="string">"D"</span>, <span class="string">"CD"</span>, <span class="string">"C"</span>, <span class="string">"XC"</span>, <span class="string">"L"</span>, <span class="string">"XL"</span>, <span class="string">"X"</span>, <span class="string">"IX"</span>, <span class="string">"V"</span>, <span class="string">"IV"</span>, <span class="string">"I"</span>&#125;;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; symbol_ints &#123;<span class="number">1000</span>, <span class="number">900</span>, <span class="number">500</span>, <span class="number">400</span>, <span class="number">100</span>, <span class="number">90</span>, <span class="number">50</span>, <span class="number">40</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; symbol_map; <span class="keyword">int</span> c = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; symbols.size(); i++) &#123;</span><br><span class="line">        symbol_map[symbols[i]] = symbol_ints[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length();) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == s.length() - <span class="number">1</span>) &#123;</span><br><span class="line">            c += symbol_map[s.substr(i)];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (symbol_map.count(s.substr(i, <span class="number">2</span>)) != <span class="number">0</span>) &#123;</span><br><span class="line">                c += symbol_map[s.substr(i, <span class="number">2</span>)];</span><br><span class="line">                i += <span class="number">2</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                c += symbol_map[s.substr(i, <span class="number">1</span>)];</span><br><span class="line">                i += <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="014-Longest-Common-Prefix"><a href="#014-Longest-Common-Prefix" class="headerlink" title="014-Longest-Common-Prefix"></a><a href="https://leetcode.com/problems/longest-common-prefix/" target="_blank" rel="noopener">014-Longest-Common-Prefix</a></h3><p>This problem is easy. We need to find the longest common prefix in the input vectors. So we just take first two strings, and find the <code>LCP</code>. Then use this <code>LCP</code> to process with later string, get another <code>LCP</code>.</p>
<p>if <code>LCP</code> comes to <code>&quot;&quot;</code>, just return. Else we return the final <code>LCP</code>.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">CommonPrefix</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; s1, <span class="keyword">const</span> <span class="built_in">string</span>&amp; s2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (s1.length() == <span class="number">0</span> || s2.length() == <span class="number">0</span>) <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; min(s1.length(), s2.length()); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (s1[i] != s2[i]) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s1.substr(<span class="number">0</span>, i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">longestCommonPrefix</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; strs)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (strs.size() == <span class="number">0</span>) <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">auto</span> str = strs.front();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; strs.size() - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        str = CommonPrefix(str, strs[i + <span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span> (str == <span class="string">""</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="015-3Sum"><a href="#015-3Sum" class="headerlink" title="015-3Sum"></a><a href="https://leetcode.com/problems/3sum/" target="_blank" rel="noopener">015-3Sum</a></h3><p>The main difficulty of the this problem is forcing to find the <code>unique triplets</code>. So at first I tried to use the two pointers, itâ€™s hard to control the range since the ranges will have overlap, this will lead to duplicate results.</p>
<p>So we can simply fix one side, and this can prevent the duplicate. First we will <code>sort the array</code>, and fix the left index as i, and then we will judge <code>nums[i] + nums[i + 1] + nums[j] = 0(?)</code>. if yes, then move the right pointer to left, continue to find out all answers in this range, if no, there are two situations.</p>
<ul>
<li>sum &lt; 0, then we need to move the <code>l = i + 1</code> to right</li>
<li>sum &gt; 0, then we need to move the <code>r</code> to left</li>
</ul>
<p>And remember that there will be same values occur, so we need to skip these same values to another distinct value to continue our process.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; threeSum(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums) &#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; vec;</span><br><span class="line">    <span class="keyword">if</span> (nums.size() &lt;= <span class="number">2</span>) <span class="keyword">return</span> vec;</span><br><span class="line">    sort(nums.begin(), nums.end());</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (nums.front() &gt; <span class="number">0</span> || nums.back() &lt; <span class="number">0</span>) <span class="keyword">return</span> vec;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.size() - <span class="number">2</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">0</span> || nums[i] != nums[i - <span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="keyword">int</span> l = i + <span class="number">1</span>, r = nums.size() - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">                <span class="keyword">int</span> s = nums[i] + nums[l] + nums[r];</span><br><span class="line">                <span class="keyword">if</span> (s == <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; t &#123;nums[i], nums[l], nums[r]&#125;;</span><br><span class="line">                    vec.push_back(t);</span><br><span class="line">                    r--;</span><br><span class="line">                    <span class="keyword">for</span> (; l &lt; r; r--) <span class="keyword">if</span> (nums[r] != nums[r + <span class="number">1</span>]) <span class="keyword">break</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (s &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                    l++;</span><br><span class="line">                    <span class="keyword">for</span> (; l &lt; r; l++) <span class="keyword">if</span> (nums[l] != nums[l - <span class="number">1</span>]) <span class="keyword">break</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    r--;</span><br><span class="line">                    <span class="keyword">for</span> (; l &lt; r; r--) <span class="keyword">if</span> (nums[r] != nums[r + <span class="number">1</span>]) <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> vec;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="138-Copy-List-with-Random-Pointer"><a href="#138-Copy-List-with-Random-Pointer" class="headerlink" title="138-Copy-List-with-Random-Pointer"></a><a href="https://leetcode.com/problems/copy-list-with-random-pointer/" target="_blank" rel="noopener">138-Copy-List-with-Random-Pointer</a></h3><p>This problem is trying to make a deep copy of the origin list. The main thought is to find the random pointerâ€™s position in the origin list, so here I find two solutions for this problem.</p>
<p>(1) Using unordered_map</p>
<ul>
<li>Using one vector to store the new list</li>
<li>Using one map to map the <code>Node*</code> to <code>index</code>.</li>
<li>Loop the vector, link the next pointer.</li>
<li>Then loop the origin list, link the random pointer</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">Node* <span class="title">copyRandomList</span><span class="params">(Node* head)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="literal">nullptr</span>) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    Node* dummy = head; <span class="built_in">unordered_map</span>&lt;Node*, <span class="keyword">int</span>&gt; node_index_map; <span class="keyword">int</span> c = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (dummy != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        node_index_map[dummy] = c++;</span><br><span class="line">        dummy = dummy-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    Node* nodes[c]; nodes[<span class="number">0</span>] = <span class="keyword">new</span> Node(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; c; i++) &#123;</span><br><span class="line">        nodes[i] = <span class="keyword">new</span> Node(<span class="number">0</span>);</span><br><span class="line">        nodes[i - <span class="number">1</span>]-&gt;next = nodes[i];</span><br><span class="line">    &#125;</span><br><span class="line">    c = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (head != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        nodes[c]-&gt;val = head-&gt;val;</span><br><span class="line">        nodes[c++]-&gt;random = head-&gt;random == <span class="literal">nullptr</span> ? <span class="literal">nullptr</span> : nodes[node_index_map[head-&gt;random]];</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> nodes[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>(2) Not using map</p>
<p>If not using map, then we need to connect the new list and the origin list first. So the procedue can be:</p>
<ul>
<li>Copy the origin list, and insert behind the origin list for every node corresponding. For example: <code>1-&gt;2-&gt;3</code> -&gt; <code>1-&gt;1&#39;-&gt;2-&gt;2&#39;-&gt;3-&gt;3&#39;</code>.</li>
<li>Then link the random pointer for the new list.</li>
<li>Break the connection between new list and origin list.</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">Node* <span class="title">copyRandomList</span><span class="params">(Node* head)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="literal">nullptr</span>) <span class="keyword">return</span> head;</span><br><span class="line">    Node* dummy = <span class="keyword">new</span> Node(<span class="number">0</span>); Node* t = dummy; Node* h = head; <span class="built_in">vector</span>&lt;Node*&gt; vec;</span><br><span class="line">    Node* tmp = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">while</span> (head != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        dummy-&gt;val = head-&gt;val;</span><br><span class="line">        dummy-&gt;random = head;</span><br><span class="line">        vec.push_back(dummy);</span><br><span class="line">        tmp = head; dummy-&gt;next = head-&gt;next; head = head-&gt;next;</span><br><span class="line">        tmp-&gt;next = dummy; dummy = <span class="keyword">new</span> Node(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; vec.size(); i++)&#123;</span><br><span class="line">        dummy = vec[i];</span><br><span class="line">        <span class="keyword">if</span> (dummy-&gt;random != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            dummy-&gt;random = (dummy-&gt;random-&gt;random == <span class="literal">nullptr</span>) ? <span class="literal">nullptr</span> : dummy-&gt;random-&gt;random-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    head = h;</span><br><span class="line">    <span class="keyword">while</span> (head != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        head-&gt;next = (head-&gt;next == <span class="literal">nullptr</span>) ? <span class="literal">nullptr</span> : head-&gt;next-&gt;next;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    dummy = t;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; vec.size() - <span class="number">1</span>; i++) vec[i]-&gt;next = vec[i + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>leetcode</tag>
        <tag>algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title>machine-learning-2-Linear-Regression</title>
    <url>/2019/07/05/machine-learning-2-Linear-Regression/</url>
    <content><![CDATA[<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨å‰ä¸€ç¯‡æ–‡ç« å½“ä¸­ï¼Œæˆ‘ä»¬è¯¦ç»†çš„è®¨è®ºäº†Bayesåˆ†ç±»å™¨ï¼Œä½¿ç”¨çš„æ˜¯åéªŒæ¦‚ç‡$p(\omega_i|x)$ä½œä¸ºå®ƒçš„discriminant function. é‚£æ—¢ç„¶ç›‘ç£å­¦ä¹ çš„ç›®æ ‡å°±æ˜¯å­¦ä¸€ä¸ªmappingï¼ŒBayesçš„æ–¹æ³•è™½ç„¶æœ€ä¼˜ï¼Œä½†å¹¶ä¸æ˜¯ç›´æ¥ä»dataå½“ä¸­å¾—åˆ°ï¼Œæ‰€ä»¥ä»Šå¤©æˆ‘ä»¬å°†ä¸»è¦ä»‹ç»Linear model.</p>
<a id="more"></a>
<h3 id="Linear-methods-for-Regression"><a href="#Linear-methods-for-Regression" class="headerlink" title="Linear methods for Regression"></a>Linear methods for Regression</h3><ul>
<li><strong>Linear model</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Linear model çš„è¡¨è¾¾å½¢å¼å¾ˆç®€å•ï¼Œå°±æ˜¯ç±»ä¼¼äºå¹³æ—¶æˆ‘ä»¬è§åˆ°çš„ä¸€æ¬¡æ–¹ç¨‹ï¼Œå³ä»xåˆ°yçš„mappingå‡½æ•°ä¸ºï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
f(x) &= \omega^TX \\\\
\omega \in R^{d+1} &= [\omega_1, \omega_2, ... , \omega_d, b]^T \\\\
X \in R^{d+1} &= [x_1, x_2, ... , x_d, 1]^T 
\end{aligned}</script><p><br></p>
<ul>
<li><strong>Error function</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨linear modelå½“ä¸­ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å˜æˆäº†ä¼˜åŒ–ä¸€ä¸ªobjective functionï¼Œä½¿å¾—è¿™ä¸ªæŸå¤±å‡½æ•°å–åˆ°æœ€å°å€¼ï¼Œåœ¨linear modelå½“ä¸­ï¼Œobjective functionå¸¸è§æœ‰ä¸¤ç§ï¼Œå½“ç„¶ä¹Ÿæ˜¯å¤§åŒå°å¼‚çš„ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>(1)Mean sum of square error:</strong></p>
<script type="math/tex; mode=display">
MSE(a) = \frac{1}{n}\sum_{i=1}^n(y_i - f(x_i, a))^2</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>(2)Redual sum of square error:</strong></p>
<script type="math/tex; mode=display">
RSS(a) = \sum_{i=1}^n(y_i-f(x_i, a))^2</script><p><br></p>
<ul>
<li><strong>Optimize</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨æˆ‘ä»¬å¾—åˆ°äº†linear modelçš„objective functionä¹‹åï¼Œæˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯æ‰¾åˆ°ä¸€ç»„å‚æ•°$a$ï¼Œä½¿å¾—ä¸Šè¿°ä¸¤ä¸ªobjective functionèƒ½å¤Ÿåœ¨training dataä¸Šé¢å–æœ€å°å€¼ï¼Œå½“ç„¶å¯ä»¥çœ‹åˆ°RSSå’ŒMSEå…¶å®éƒ½æ˜¯ç”¨çš„<code>æœ€å°äºŒä¹˜æ³•</code>çš„æ€æƒ³ï¼Œä¼˜åŒ–ç›®æ ‡éƒ½æ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬å¯¹æ•°æ®è¿›è¡ŒçŸ©é˜µåŒ–çš„è¡¨ç¤ºï¼Œ$X = [x_1, x_2, â€¦ , x_n], y=[y_1, y_2, â€¦ , y_n]^T$.</p>
<script type="math/tex; mode=display">
\begin{aligned}
J_n(a) &= (y-X^Ta)^T(y-X^Ta) \\\\
\nabla_aJ_n(a) &= -2X(y-X^Ta) = 0 \\\\
a &= (XX^T)^{-1}Xy
\end{aligned}</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å“¦è±ï¼Œåˆ°è¿™é‡Œå¥½åƒäº‹æƒ…å˜å¾—å¾ˆç®€å•ï¼Œåªéœ€è¦å¯¹RSSæ±‚ä¸ªå¯¼å°±èƒ½å¾—åˆ°æœ€ä¼˜çš„å‚æ•°è§£ã€‚å½“ç„¶ï¼Œäº‹æƒ…æ˜¯æ²¡æœ‰æƒ³è±¡çš„é‚£ä¹ˆç®€å•çš„ï¼Œæˆ‘ä»¬çœ‹$a = (XX^T)^{-1}Xy$, å¦‚æœ$XX^T$ä¸æ»¡ç§©çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæ–¹ç¨‹è¿˜èƒ½ç”¨å—ï¼Œé‚£å½“ç„¶æ˜¯ä¸èƒ½ç”¨äº†ï¼Œå› ä¸º$XX^T$éƒ½ä¸èƒ½æ±‚é€†äº†ï¼Œæ€ä¹ˆç”¨ï¼æ‰€ä»¥è¿™ä¸ªæ–¹ç¨‹åœ¨$XX^T$æ»¡ç§©æ—¶æœ‰è§£ï¼Œä¸æ»¡ç§©çš„æ—¶å€™å­˜åœ¨æ— ç©·å¤šè§£ï¼Œä¹Ÿå³overfitting problem.</p>
<p><br></p>
<ul>
<li><strong>Statistic model of regression</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨è¿™ä¸ªpartå°†ä¼šé€šè¿‡ç»Ÿè®¡å›å½’æ¨¡å‹æ¥æ¨å¯¼linear model çš„ objective function. ä½¿ç”¨ç»Ÿè®¡å›å½’æ¨¡å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬é¦–å…ˆä¼šå‡è®¾å­˜åœ¨ä¸€ä¸ªéšå«å˜é‡$\epsilon$, æ‰€ä»¥æˆ‘ä»¬linear modelçš„è¡¨ç¤ºå½¢å¼å°±å˜æˆäº†ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
y &= f(x, a) + \epsilon &
\epsilon \sim N(0, \sigma^2)
\end{aligned}</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ç„¶åæˆ‘ä»¬ä½¿ç”¨MLEçš„æ–¹æ³•æ¥æœ€å¤§åŒ–log-ä¼¼ç„¶å‡½æ•°ï¼Œæ‰€ä»¥æ•´ä¸ªæ¨å¯¼è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
l(D, a, \sigma) &= ln(l(D, a, \sigma)) \\\\
&= \sum_{i=1}^n lnp(y_i|x_i, a, \sigma) \\\\
&= \sum_{i=1}^n ln[\frac{1}{\sigma \sqrt{2\pi}}e^{-\frac{1}{2\sigma^2}(y-f(x, a))^2}] \\\\
&= -\frac{1}{2\sigma^2}\sum_{i=1}^n(y-f(x, a))^2 + c(\sigma)
\end{aligned}</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OK, Fine.è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°å½“æå¤§åŒ–ä¼¼ç„¶å‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾—åˆ°å’ŒMSEæˆ–è€…æ˜¯RSSçš„ä¼˜åŒ–å‡½æ•°æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥è¿™ä¸¤ç§ä¼˜åŒ–ç›®æ ‡æ˜¯ç›¸åŒçš„ã€‚</p>
<p><br></p>
<ul>
<li><strong>Over-fitting</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Overfitting problem æ˜¯æœºå™¨å­¦ä¹ é—®é¢˜å½“ä¸­å¾ˆå¸¸è§çš„é—®é¢˜ï¼Œå½“é€‰å–çš„å‚æ•°è¿‡å¤šï¼Œè€Œæ²¡æœ‰è¶³å¤Ÿå¤šçš„æ ·æœ¬æ¥æ”¯æŒçš„è¯ï¼Œæ‰€ä»¥å°±ä¼šå‡ºç°<code>æ¨¡å‹è¿‡æ‹Ÿåˆ</code>çš„é—®é¢˜ã€‚å…·ä½“å¯ä»¥ç”¨ä»¥ä¸‹è¿™å¼ å›¾å±•ç¤ºï¼š</p>
<p><img src="/2019/07/05/machine-learning-2-Linear-Regression/1.png" style="width: 80%"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨ä¹‹å‰çš„$a = (XX^T)^{-1}Xy$ è¡¨è¾¾å¼å½“ä¸­ï¼Œå¦‚æœ$XX^T$ä¸æ»¡ç§©çš„è¯ï¼Œæœ€åç»“æœå¯¼è‡´å°±æ˜¯<code>overfitting problem</code>.</p>
<p><br></p>
<ul>
<li><strong>Ridge Regression</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å‡ºäº†é—®é¢˜é‚£å°±å¾—è§£å†³æ˜¯å§ï¼Œå‡ºç°äº†<code>overfitting</code>é‚£ä¹ˆæˆ‘ä»¬å°±å¾—æƒ³åŠæ³•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä¹Ÿå°±å¼•å‡ºäº†æ¥ä¸‹æ¥è¦é˜è¿°çš„<code>æ­£åˆ™åŒ–</code>çš„è§£å†³æ–¹æ³•ã€‚</p>
<script type="math/tex; mode=display">
a^* = argmin(\sum_{i=1}^n(y_i-x_i^Ta)^2 + \lambda\sum_{j=1}^pa_j^2)</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åŒæ ·çš„æ·»åŠ æ­£åˆ™é¡¹ï¼ŒåŒæ ·ä¹Ÿç›¸å½“äºç»™ä¹‹å‰çš„objective functionåŠ ä¸Šé™åˆ¶ï¼Œä¹Ÿå³ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
a^* = argmin(\sum_{i=1}^n(y_i-x_i^Ta)^2) && s.t.\lambda\sum_{j=1}^pa_j^2\le t
\end{aligned}</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æœ€åå¯¹åŠ ä¸Šæ­£åˆ™é¡¹çš„objective functionè¿›è¡Œæ±‚å¯¼ç„¶åå°±èƒ½æ±‚å¾—æå€¼ã€‚å…¶å®åŠ ä¸Šæ­£åˆ™é¡¹çš„æ„ä¹‰å°±åœ¨äºï¼Œå¯¹äºå‚æ•°$a$è¿›è¡Œæƒ©ç½šï¼Œå…¶ä¸­çš„å‚æ•°$\lambda$å°±æ˜¯å¯¹è¿™ä¸¤é¡¹è¿›è¡Œç›¸å¯¹åº”çš„è°ƒæ•´ï¼Œæ¥å†³å®šè¿™ä¸¤é¡¹çš„æ¯”é‡ã€‚</p>
<script type="math/tex; mode=display">
a^* = (XX^T+\lambda I)^{-1}Xy</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹å‚æ•°$\lambda$å¯¹æ•´ä¸ªmodelçš„å½±å“ï¼Œå½“$\lambda$å¾ˆå¤§çš„æ—¶å€™ï¼Œç›¸å½“äºæ­£åˆ™åŠ çš„å¾ˆå¤§ï¼Œä½¿å¾—å‚æ•°éƒ½å¾ˆå°ï¼Œä¼šä½¿å¾—$bias$å˜å¤§ã€‚å¦‚æœ$\lambda$å¾ˆå°çš„æ—¶å€™ï¼Œç›¸å½“äºæ˜¯$variance$ç›¸å¯¹å¤§ä¸€ç‚¹ã€‚ä½†æ˜¯å› ä¸ºæˆ‘ä»¬åŠ ä¸Šæ­£åˆ™é¡¹ï¼Œæ‰€ä»¥training erroræ˜¯ä¸å¯é¿å…çš„ä¼šå¢åŠ ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯»æ‰¾çš„å°±æ˜¯training errorå’Œtesting erroréƒ½ç›¸å¯¹åå°çš„é‚£ä¸ªå¹³è¡¡å€¼ï¼š</p>
<p><img src="/2019/07/05/machine-learning-2-Linear-Regression/2.png" style="width: 80%"></p>
<p><br></p>
<ul>
<li><strong>LASSO</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨ä¸Šé¢æˆ‘ä»¬æåˆ°æ­£åˆ™é¡¹åŠ çš„æ˜¯$\lambda\sum_{j=1}^pa_j^2$, è¿™æ˜¯å¾ˆå¸¸ç”¨çš„<code>L2 norm</code>, å¦‚æœæˆ‘ä»¬ç”¨ä¸€é˜¶æ¥åšæ­£åˆ™çš„è¯ï¼Œå°±æœ‰ä¸€ä¸ªæ–°çš„åå­—ï¼Œå«åš<code>LASSO</code>,<code>LASSO</code>æ˜¯ä¸€ä¸ª<code>Sparse model</code>ï¼Œä¹Ÿå³è‡ªå¸¦<code>featrue select</code>çš„åŠŸèƒ½ï¼Œ<code>LASSO</code>çš„è¡¨è¾¾å½¢å¼ä¸ºï¼š</p>
<script type="math/tex; mode=display">
a^*=argmin(\sum_{i=1}^n(y_i-x_i^Ta)^2+\lambda\sum_{j=1}^p|a_j|)</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ä¸ºä»€ä¹ˆè¯´LASSOæ˜¯ä¸€ä¸ªSparse modelå‘¢ï¼Œæˆ‘ä»¬ä»objective functionçš„å›¾å½¢åŒ–è¡¨ç¤ºæ¥çœ‹å°±å¾ˆå®¹æ˜“ç†è§£ï¼Œå› ä¸ºä¸¤æ¡çº¿çš„ç›¸åˆ‡çš„åœ°æ–¹æ€»æ˜¯åœ¨è§’ç‚¹ã€‚æ‰€ä»¥å¾ˆå¤šé¡¹çš„å‚æ•°å°±è‡ªåŠ¨å˜æˆäº†0:</p>
<p><img src="/2019/07/05/machine-learning-2-Linear-Regression/3.png" style="width: 80%"></p>
<p><br></p>
<ul>
<li><strong>Bias and variance decomposition</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æœ€åè¿™é‡Œå¯¹<code>bias</code>å’Œ<code>variance</code>åšä¸€ä¸ªè®¨è®ºã€‚<code>bias</code>ä¸»è¦æŒ‡çš„æ˜¯æœ€åå­¦åˆ°çš„modelå’ŒçœŸå®çš„modelä¹‹é—´çš„åå·®ï¼Œ<code>variance</code>æŒ‡çš„æ˜¯æ¯æ¬¡å­¦åˆ°çš„modelä¹‹é—´è¯¯å·®å€¼ï¼Œ<code>noise</code>æ˜¯ä¸å¯é¿å…çš„è¯¯å·®ï¼Œæ‰€ä»¥ä¸èƒ½åšåˆ°å®Œå…¨optimalçš„model.æˆ‘ä»¬ä½¿ç”¨<code>EPE</code>è¿›ä¸€æ­¥çš„è¡¡é‡model lossï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
EPE(f) &= \iint(y-f(x))^2p(x, y)dxdy \implies \\\\
EPE(f) &= (bias)^2+variance+noise \\\\
(bias)^2 &= \int[E_D(f(x;D)-E(y|x))]^2p(x)dx \\\\
variance &= \int E_D[f(x;D)-E_D(f(x;D))]^2p(x)dx \\\\
noise &= \int var(y|x)p(x)dx
\end{aligned}</script><p><img src="/2019/07/05/machine-learning-2-Linear-Regression/4.png" style="width: 80%"></p>
]]></content>
      <categories>
        <category>machine-learning</category>
      </categories>
      <tags>
        <tag>machine-learning</tag>
      </tags>
  </entry>
  <entry>
    <title>machine-learning-3-Linear-Classifier</title>
    <url>/2019/07/05/machine-learning-3-Linear-Classifier/</url>
    <content><![CDATA[<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨å‰ä¸€ç¯‡æ–‡ç« å½“ä¸­ï¼Œæˆ‘ä»¬è¯¦ç»†çš„é˜è¿°äº†Linear modelçš„è¡¨ç°ï¼Œä¸è¿‡å®ƒä¸»è¦åšçš„æ˜¯<code>supervised learning</code>å½“ä¸­çš„ä¸€ä¸ª<code>regression</code>é—®é¢˜ï¼Œé‚£è¿˜å‰©ä¸‹å¦å¤–ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„é—®é¢˜ï¼š<code>classification</code>.æ‰€ä»¥åœ¨è¿™ä¸€ç¯‡æ–‡ç« å½“ä¸­ï¼Œä¼šä¸»è¦ä»‹ç»<code>logistic model</code>å’Œ<code>SVM</code>ä¸¤ç§<code>linear classifier</code>.</p>
<a id="more"></a>
<h3 id="Sigmoid-function-logistic-function"><a href="#Sigmoid-function-logistic-function" class="headerlink" title="Sigmoid function (logistic function)"></a>Sigmoid function (logistic function)</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sigmoid function æ˜¯ logistic regressionå½“ä¸­æœ€é‡è¦çš„ä¸€ä¸ªå…ƒå‡½æ•°ã€‚æˆ‘ä»¬ä¹Ÿå«å®ƒ<code>Så‹å‡½æ•°</code>ï¼š</p>
<script type="math/tex; mode=display">
\sigma(t) = \frac{e^t}{1+e^t} = \frac{1}{1+e^{-t}}</script><p><img src="/2019/07/05/machine-learning-3-Linear-Classifier/1.png" style="width: 50%"></p>
<p><br></p>
<h3 id="Logistic-Regression"><a href="#Logistic-Regression" class="headerlink" title="Logistic Regression"></a>Logistic Regression</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; é€»è¾‘æ–¯è’‚å›å½’æ˜¯ä¸€ç§<code>classification</code>çš„æ–¹æ³•ï¼Œåˆ©ç”¨çš„å°±æ˜¯sigmoid functionæ¥è¿›è¡Œclassify. Logistic Regressionçš„ä¸»è¦å½¢å¼å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
p(y_i=\pm1|x_i, a) = \sigma(y_ia^Tx_i) = \frac{1}{1+e^{-y_ia^Tx_i}}</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ç„¶åå¯¹äºæ•°æ®æˆ‘ä»¬åŒæ ·ä½¿ç”¨çš„<code>MLE</code>çš„æ–¹æ³•æ¥ä¼°è®¡å‚æ•°$a$.</p>
<script type="math/tex; mode=display">
l(p(D)) = -\sum_{i \in I}\log(1+e^{-y_ia^Tx_i})</script><script type="math/tex; mode=display">
E(a) = \sum_{i \in I}\log(1+e^{-y_ia^Tx_i})</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ä½†æ˜¯æ³¨æ„çš„æ˜¯$E(a)$æ˜¯ä¸€ä¸ªnon-convex functionå¯¹äºå‚æ•°$a$è€Œè¨€ã€‚æ¢è¨€ä¹‹è¿™é‡Œç›´æ¥æ±‚å¯¼æ˜¯æ²¡ç”¨çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼•å…¥ä¸€ä¸ªæ–°çš„æ±‚å‚æ•°æœ€å€¼çš„æ–¹æ³•ï¼š<a href="https://zh.wikipedia.org/zh-hans/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95" target="_blank" rel="noopener">Gradient descent</a></p>
<p><br></p>
<h3 id="Gradient-descent"><a href="#Gradient-descent" class="headerlink" title="Gradient descent"></a>Gradient descent</h3><ul>
<li>first order optimization problem (é€šè¿‡æ±‚è§£ä¸€é˜¶å¯¼å¯ä»¥æ±‚è§£)</li>
<li>Can find a <code>local optimum</code></li>
<li>æ¢¯åº¦ç›¸åæ–¹å‘ï¼š<code>local minimum</code>, æ¢¯åº¦æ–¹å‘ï¼š<code>local maximum</code></li>
</ul>
<script type="math/tex; mode=display">
\begin{aligned}
\omega_{n+1} = \omega_n - \gamma \nabla J(\omega_n) && n \ge 0
\end{aligned}</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å…¶å®è¿™åªæ˜¯ä¸€é˜¶å¯¼ä¸‹é¢çš„æ¢¯åº¦ä¸‹é™çš„æ–¹æ³•ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€çœ‹ä¸ºä»€ä¹ˆå¯ä»¥è¿›è¡Œæ¢¯åº¦ä¸‹é™ï¼Œæˆ–è€…è¯´æ¢¯åº¦ä¸‹é™ä¸ºä»€ä¹ˆä¼šworkå‘¢ï¼Ÿ</p>
<script type="math/tex; mode=display">
E(a+\triangle a) = E(a) + E' (a)\triangle a + E'' (a)\frac{(\triangle a)^2}{2!} + ...</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; è¿™æ˜¯å¤§å®¶å¾ˆç†Ÿæ‚‰çš„æ‹‰æ ¼æœ—æ—¥å±•å¼€ï¼Œå¦‚æœæˆ‘ä»¬åªå–å‰ä¸¤é¡¹è¿›è¡Œä¼°è®¡ï¼Œåˆ™æœ‰$E(a)+Eâ€™ (a)\triangle a \implies \triangle a = -\eta Eâ€™ (a)$.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å¦‚æœæ˜¯é‡‡ç”¨å‰ä¸‰é¡¹è¿›è¡Œä¼°è®¡ï¼Œé‚£ä¹ˆè¿™ä¸ªå«åš<code>ç‰›é¡¿æ³•ä¼°è®¡</code>ï¼Œé‚£ä¹ˆåœ¨è¿™ç§ä¼°è®¡ä¹‹ä¸‹æˆ‘ä»¬ä¼šæœ‰ï¼š</p>
<script type="math/tex; mode=display">
E' (a)\triangle a + E'' (a)\frac{(\triangle a)^2}{2!} \implies E' (a)+E'' (a)\triangle a = 0 \implies \triangle a = -\frac{E' (a)}{E'' (a)}</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å¯¹äºç‰›é¡¿æ³•æ±‚æ¢¯åº¦ä¸‹é™æ›´é€šç”¨çš„å†™æ³•å¦‚ä¸‹æ‰€ç¤ºï¼Œæœ¬è´¨ä¹Ÿå°±æ˜¯ä¸Šé¢å¼å­æ¨å¯¼è€Œæ¥ï¼š</p>
<script type="math/tex; mode=display">
\triangle a = -\eta [HE(a)]^{-1} E' (a)</script><p><br></p>
<h3 id="Regularized-Logistic-Regression"><a href="#Regularized-Logistic-Regression" class="headerlink" title="Regularized Logistic Regression"></a>Regularized Logistic Regression</h3><ul>
<li><strong>L2-Regularizer</strong></li>
<li><strong>L1-Regularizer</strong> (Sparse Logistic Regression)</li>
</ul>
<script type="math/tex; mode=display">
E(a) = \sum_{i \in I}\log(1+e^{-y_ia^Tx_i}) + \lambda\sum_{j=1}^p(a_j^2)</script><p><br></p>
<h3 id="SVM"><a href="#SVM" class="headerlink" title="SVM"></a>SVM</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºä¸€ä¸ªçº¿æ€§å¯åˆ†çš„æ•°æ®é›†ï¼Œä»–çš„solution vector $a$ å¯ä»¥æœ‰æ— æ•°æ¡ï¼Œåªè¦èƒ½å¤Ÿå°†ä¸¤ç§æ•°æ®ç»™åˆ†å¼€å°±è¡Œã€‚é‚£ä¹ˆæˆ‘ä»¬å°±æƒ³ï¼Œè¿™ä¹ˆå¤šä¸ªsolution vectorå½“ä¸­ï¼Œå“ªæ¡æ˜¯æœ€ä¼˜çš„å‘¢ï¼Ÿè¿™å°±å¼•å‡ºä»Šå¤©çš„å¦ä¸€ä½ä¸»è§’ï¼Œå°±æ˜¯<a href="https://zh.wikipedia.org/wiki/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA" target="_blank" rel="noopener">SVM-solution vector machine</a>, ä¹Ÿç§°ä¸º<code>large margin classifier</code>.</p>
<ul>
<li><strong>Geometrical Margin</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å·²çŸ¥solution vector $\omega$, å¦‚ä½•è®¡ç®—ä»»æ„ä¸€ä¸ªç‚¹xåˆ°åˆ†å‰²é¢çš„è·ç¦»å‘¢ï¼š<br><img src="/2019/07/05/machine-learning-3-Linear-Classifier/4.png" style="width: 40%"></p>
<script type="math/tex; mode=display">
x = x_0+\frac{y\gamma\omega}{||\omega||}</script><script type="math/tex; mode=display">
\omega^Tx = \omega^T(x_0+\frac{y\gamma\omega}{||\omega||}) + b = 0</script><script type="math/tex; mode=display">
\implies \gamma = y\frac{\omega^Tx+b}{||\omega||}</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å…¶ä¸­çš„$\gamma$å°±è¢«ç§°ä¸º<code>Geometrical Margin</code>, ä»ä¸Šé¢çš„å¼å­å½“ä¸­æˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹å‡ºæ¥å…¶å®$|f(x)|$å°±å¯ä»¥è¡¡é‡ä¸åŒç‚¹åˆ°åˆ†å‰²é¢ä¹‹é—´çš„è·ç¦»ã€‚</p>
<p><br></p>
<ul>
<li><strong>Margin of dataset</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æˆ‘ä»¬æŠŠä¸€ä¸ªæ•°æ®é›†çš„Marginè§„å®šä¸ºæ•°æ®é›†å½“ä¸­åˆ°åˆ†å‰²é¢æœ€å°çš„$\gamma$ç§°ä¸ºæ•°æ®é›†çš„Margin. ç„¶åæˆ‘ä»¬çš„targetåŒç†ä¹Ÿå¯ä»¥å˜ä¸ºï¼šFind the hyperplane with the largest margin. åŒæ—¶æˆ‘ä»¬æŠŠé‚£äº›å†³å®šhyperplaneçš„ç‚¹ç§°ä¸º<code>support vectors</code>, å› ä¸ºè¿œçš„ç‚¹å¯¹dataset marginæ²¡æœ‰ä»»ä½•å½±å“ï¼Œè€Œåªæœ‰é‚£äº›ç»„æˆdataset marginçš„ç‚¹æ‰æ˜¯æˆ‘ä»¬éœ€è¦å…³æ³¨çš„ç‚¹ã€‚</p>
<script type="math/tex; mode=display">
max_{\omega, b}\gamma = max_{\omega, b}\frac{y(\omega^Tx+b)}{||\omega||}(\gamma_i \ge \gamma)</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å› ä¸ºåœ¨è¿™é‡Œ$\omega$æ˜¯å¯ä»¥è¿›è¡Œä»»æ„ç¼©æ”¾çš„ï¼Œå¹¶ä¸ä¼šå¯¹hyperlaneé€ æˆä»»ä½•çš„å½±å“ï¼Œæ‰€ä»¥åšä¸€ä¸ªå¤„ç†ï¼ŒFix $y(\omega^Tx+b) = 1 \implies \gamma ||\omega|| = 1$</p>
<script type="math/tex; mode=display">
max_{\omega, b}\frac{y(\omega^Tx+b)}{||\omega||} = max\frac{1}{||\omega||}</script><script type="math/tex; mode=display">
\gamma_i = \frac{y_i(\omega^Tx_i+b)}{||\omega||} \ge \gamma \implies y_i(\omega^Tx_i+b) \ge 1</script><script type="math/tex; mode=display">
max\frac{1}{||\omega||} \implies min\frac{1}{2}||\omega^2||</script><script type="math/tex; mode=display">
\begin{aligned}
min\frac{1}{2}||\omega^2|| && s.t. && y_i(\omega^Tx_i+b) \ge 1
\end{aligned}</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æ‰€ä»¥æˆ‘ä»¬æœ€åçš„ä¼˜åŒ–ç›®æ ‡å°±å˜æˆäº†ä¸Šé¢è¿™ä¸ªå¼å­äº†ï¼ä½†æ˜¯è¿™ä¸ªå¼å­æœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„weaknessï¼šå®¹æ˜“å—åˆ°å™ªå£°noiseçš„å½±å“ï¼Œ<code>å› ä¸ºæ˜¯ä¸å…è®¸ä»»ä½•å‡ºé”™çš„æƒ…å†µçš„</code>ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹å¦‚æœæœ‰ä¸€ä¸ªåˆ†ç±»é”™è¯¯çš„ï¼Œä¼šå½±å“æ•´ä¸ªhyperlaneçš„é€‰å–ï¼š</p>
<p><img src="/2019/07/05/machine-learning-3-Linear-Classifier/2.png" style="width: 40%"></p>
<p><br></p>
<ul>
<li><strong>Slack variables</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ª<code>slack variable</code>, å³è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å…è®¸ä¸€äº›çŠ¯é”™ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æ–°çš„objective functionä¸ºï¼š</p>
<script type="math/tex; mode=display">
min_{\omega, b}\frac{1}{2}||\omega^2||+c\sum_{i=1}^n\xi_i</script><script type="math/tex; mode=display">
\begin{aligned}
y_i(\omega^Tx_i+b) \ge 1-\xi_i && \xi_i \ge 0 \implies \xi_i = max[0, 1-y_i(\omega^Tx_i+b)]
\end{aligned}</script><script type="math/tex; mode=display">
E(\omega) = \sum_{i=1}^nmax[0, y_i(\omega^Tx_i+b)] + \frac{1}{2c}||\omega^2||</script><p><br></p>
<ul>
<li><strong>General formulation of classifiers</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ä¸çŸ¥é“æœ‰æ²¡æœ‰å‘ç°ï¼Œæˆ‘ä»¬ä¹‹å‰é˜è¿°çš„objective functionéƒ½æœ‰ä¸€ä¸ªå…±æ€§ï¼Œä¹Ÿå³<code>Loss function + Regularizer</code>, å³$min\sum_{i=1}^nl(f) + \lambda R(f)$. æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºè¿™å‡ ç§lossï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>square loss</code>: $l = (1-yf)^2$<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>logistic loss</code>: $l = log(1+e^{-yf})^2$<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>Hinge loss</code>: $l = max[0, 1-yf]$</p>
<p><img src="/2019/07/05/machine-learning-3-Linear-Classifier/3.png" style="width: 50%"></p>
]]></content>
      <categories>
        <category>machine-learning</category>
      </categories>
      <tags>
        <tag>machine-learning</tag>
      </tags>
  </entry>
  <entry>
    <title>machine-learning-4-Kernel-Function</title>
    <url>/2019/07/06/machine-learning-4-Kernel-Function/</url>
    <content><![CDATA[<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨å‰é¢å‡ ç¯‡æ–‡ç« å½“ä¸­ä»‹ç»çš„<code>Linear model</code>, <code>logistic regression</code>, <code>SVM</code>è¿™å‡ ç§supervised learningçš„åˆ†ç±»å™¨ï¼Œä½†æ˜¯ä»–ä»¬åªèƒ½handle linearçš„æƒ…å†µï¼Œå¯¹äºéçº¿æ€§å¯åˆ†çš„æƒ…å†µå°±çˆ±è«èƒ½åŠ©äº†ï¼Œæ‰€ä»¥è¿™é‡Œä¸»è¦ä»‹ç»kernelæ ¸æ–¹æ³•æ¥è®¨è®ºnon-linearçš„æƒ…å†µã€‚</p>
<a id="more"></a>
<h3 id="Generalized-Linear-Function"><a href="#Generalized-Linear-Function" class="headerlink" title="Generalized Linear Function"></a>Generalized Linear Function</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å½“ä¸€ç»„æ•°æ®åœ¨å½“å‰ç»´åº¦ä¸‹çº¿æ€§ä¸å¯åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸ªç»´åº¦çš„æ•°æ®è¿›è¡Œmappingï¼Œä¹Ÿå³æ˜ å°„åˆ°æ›´é«˜ç»´çš„æ•°æ®ï¼Œåœ¨é«˜ç»´çš„ç©ºé—´å½“ä¸­å°±å¯èƒ½æ˜¯çº¿æ€§å¯åˆ†çš„ï¼Œä¹Ÿå°±å¯ä»¥åˆ©ç”¨æˆ‘ä»¬ä¹‹é—´ä»‹ç»çš„ä¸€ç³»åˆ—çš„æ–¹æ³•ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªmappingçš„ä¾‹å­ğŸŒ°ï¼š</p>
<p><img src="/2019/07/06/machine-learning-4-Kernel-Function/1.png" style="width: 50%"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ä¸‹é¢æˆ‘ä»¬ä»‹ç»ä¸€ä¸‹ä»€ä¹ˆå«åš<code>Generalized Linear Function</code>, ç®€å•æ¥è¯´å°±æ˜¯åœ¨linear modelçš„åŸºç¡€ä¹‹ä¸Šï¼Œå¢åŠ ç›¸å…³å˜é‡ã€‚ä¹Ÿå³åœ¨linear modelå½“ä¸­æˆ‘ä»¬æœ‰$[x_1, x_2, x_3]$è¿™ä¸‰ä¸ªfeatrueï¼Œæˆ‘ä»¬å¢åŠ ä¸ä¸‰ä¸ªfeatureç›¸å…³çš„å˜é‡ï¼Œä¹Ÿå³æ‰©å±•åˆ°$[x_1, x_2, x_3, x_1x_2, x_1x_3, x_2x_3]$.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æ¥ä¸‹æ¥å°±æ˜¯åœ¨è¿™ä¸ªæ–°çš„featrue spaceå»å­¦ä¸€ä¸ªçº¿æ€§çš„åˆ†ç±»å™¨å³å¯ã€‚</p>
<p><br></p>
<h3 id="Quadratic-Discriminant-Function"><a href="#Quadratic-Discriminant-Function" class="headerlink" title="Quadratic Discriminant Function"></a>Quadratic Discriminant Function</h3><script type="math/tex; mode=display">
g(x) = \omega_0 + \sum_{i=1}^d\omega_ix_i + \sum_{i=1}^d \sum_{j=1}^d \omega_{ij}x_ix_j</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $g(x) = 0$ ä»£è¡¨çš„å°±æ˜¯ä¸€ä¸ªè¶…å¹³é¢ï¼Œåœ¨æ–°çš„æ˜ å°„çš„featrue spaceé‡Œé¢çš„è¶…å¹³é¢ï¼Œå°†æ•°æ®åˆ†å‰²æˆä¸¤ç±»ã€‚</p>
<p><br></p>
<h3 id="Generalized-Discriminant-Function"><a href="#Generalized-Discriminant-Function" class="headerlink" title="Generalized Discriminant Function"></a>Generalized Discriminant Function</h3><script type="math/tex; mode=display">
g(x) = \sum_{i=1}^{\hat{d}}a_iy_i(x) = a^Ty</script><script type="math/tex; mode=display">
\begin{aligned}
a = [a_1, a_2, ..., a_d]^T && y = [y_1(x), y_2(x), ..., y_d(x)]^T
\end{aligned}</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å…¶ä¸­çš„mapping yå«åš<code>augmented featrue vector</code>, æˆ–è€…å«åš<code>phi function</code>.</p>
<p><br></p>
<h3 id="Representer-Theorm"><a href="#Representer-Theorm" class="headerlink" title="Representer Theorm"></a>Representer Theorm</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æˆ‘ä»¬åé¢ä¹Ÿä»‹ç»çš„kernel functionéƒ½æ˜¯å»ºç«‹åœ¨<a href="http://web.eecs.umich.edu/~cscott/past_courses/eecs598w14/notes/13_kernel_methods.pdf" target="_blank" rel="noopener">Representer Theorm</a>çš„åŸºç¡€ä¹‹ä¸Šã€‚è¿™é‡Œæˆ‘åªç®€å•çš„ä»‹ç»ä¸€ä¸‹å½¢å¼ï¼Œå…·ä½“å½¢å¼å¯ä»¥æŸ¥çœ‹é“¾æ¥å½“ä¸­PDFçš„è¯¦ç»†ä»‹ç»ã€‚<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ç®€è€Œè¨€ä¹‹ï¼Œè¿™ä¸ªå®šç†æè¿°çš„å°±æ˜¯ï¼Œä»»ä½•å½¢å¦‚ <code>loss function + Reguralizer</code>çš„å‡½æ•°éƒ½èƒ½è¿™æ ·è¢«è¡¨ç¤ºï¼š</p>
<script type="math/tex; mode=display">
f(x) = \sum_{i=1}^n\alpha_ik(x_i, x)</script><p><br></p>
<h3 id="Kernelized-Ridge-Regression"><a href="#Kernelized-Ridge-Regression" class="headerlink" title="Kernelized Ridge Regression"></a>Kernelized Ridge Regression</h3><script type="math/tex; mode=display">
\begin{aligned}
\omega^* &= argmin\sum_{i=1}^n(y_i-x_i^T\omega)^2 + \lambda\sum_{j=1}^p \omega_j^2 \\\\
&= (XX^T + \lambda I)^{-1}Xy \\\\
&= X(X^TX+\lambda I)^{-1}y \\\\
\alpha &= (X^TX+\lambda I)^{-1}y \\\\
\omega^* &= X\alpha = \sum_{i=1}^n \alpha_ix_i
\end{aligned}</script><script type="math/tex; mode=display">
f(x) = \omega^Tx = \sum_{i=1}^n\alpha_ix_i^Tx = \sum_{i=1}^n \kappa(x_i, x)</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å…¶ä¸­çš„$\kappa(x_i, x)$å°±æ˜¯ridge regressionçš„kernel functionï¼Œåªè¦æ¥ä¸€ä¸ªxï¼Œåªéœ€è¦æ”¾åˆ°è¿™ä¸ªkernel functionå½“ä¸­è®¡ç®—ä¸€ä¸‹å°±fineäº†ã€‚</p>
<p><br></p>
<h3 id="Kernels"><a href="#Kernels" class="headerlink" title="Kernels"></a>Kernels</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Let $\kappa(x_i, x) \ge 0$ be some measure of similarity of $(x_i, x)$, we will call $\kappa$ a <code>kernel function</code>. ä¸€èˆ¬æ¥è¯´$\kappa$éƒ½æ˜¯å¯¹ç§°çš„ï¼Œå¹¶ä¸”æ˜¯positiveçš„ï¼Œä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„kernel functionï¼š</p>
<ul>
<li><strong>linear kernel</strong>: $\kappa(x, xâ€™) = x^Tx_i$</li>
<li><strong>Polinominal kernel:</strong> $\kappa(x, xâ€™) = (x^Txâ€™ + 1)^d$</li>
<li><strong>RBF kernel:</strong> $\kappa(x, xâ€™) = exp(-\frac{||x-xâ€™||^2}{2\sigma^2})$</li>
</ul>
<p><br></p>
<h3 id="Advantages"><a href="#Advantages" class="headerlink" title="Advantages"></a>Advantages</h3><ul>
<li><strong>Non-linear function</strong></li>
<li><strong>Works when the samples canâ€™t represent as featrue vectors</strong></li>
<li><strong>String kernels, graph kernels, etc.</strong></li>
</ul>
]]></content>
      <categories>
        <category>machine-learning</category>
      </categories>
      <tags>
        <tag>machine-learning</tag>
      </tags>
  </entry>
  <entry>
    <title>machine-learning-1-DM-and-Bayesian</title>
    <url>/2019/06/29/machine-learning-1-DM-and-Bayesian/</url>
    <content><![CDATA[<p>&nbsp;&nbsp;&nbsp;&nbsp;åœ¨è¿™ä¸ªç³»åˆ—çš„åšå®¢æ–‡ç« é‡Œé¢ï¼Œä¸»è¦è®°å½•çš„æ˜¯æœ¬å­¦æœŸã€Šæ•°æ®æŒ–æ˜å¯¼è®ºã€‹è¯¾ç¨‹å½“ä¸­çš„çŸ¥è¯†ç‚¹ï¼Œæ¶‰åŠçš„æ˜¯ä¼ ç»Ÿæœºå™¨å­¦ä¹ å½“ä¸­çš„ç®—æ³•ï¼ŒåŒ…æ‹¬æœ‰ç›‘ç£å­¦ä¹ ã€æ— ç›‘ç£å­¦ä¹ è¿™ä¸¤å¤§éƒ¨åˆ†ã€‚è¿™ç¯‡åšå®¢æ–‡ç« ä¸»è¦è®°å½•çš„æ˜¯machine learningç®€ä»‹ä»¥åŠBayesiançš„ç›¸å…³å†…å®¹ã€‚<br><a id="more"></a></p>
<h3 id="1-What-is-machine-learning"><a href="#1-What-is-machine-learning" class="headerlink" title="1. What is machine learning"></a>1. What is machine learning</h3><h4 id="Two-kinds-of-problems"><a href="#Two-kinds-of-problems" class="headerlink" title="Two kinds of problems"></a>Two kinds of problems</h4><ul>
<li>ç›‘ç£å­¦ä¹ (supervised learning)</li>
<li>æ— ç›‘ç£å­¦ä¹ (unsupervised learning)</li>
<li>Differences:</li>
</ul>
<ol>
<li>Supervised learning is trying to <code>find a mapping from x to y</code>, æ¯”å¦‚è¯´æ˜¯<code>classfication</code>æˆ–è€…æ˜¯<code>regression</code>çš„é—®é¢˜ã€‚</li>
<li>unsupervised learningé—®é¢˜æ˜¯åªæœ‰æ— labelçš„æ ·æœ¬æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦å¯»æ‰¾<code>interesting patterns</code>, æ¯”å¦‚è¯´æ˜¯èšç±»(clusters)ã€é™ç»´ã€çŸ©é˜µåˆ†è§£(latent factors)ç­‰å†…å®¹ã€‚ </li>
</ol>
<ul>
<li>Supervised learning: <code>collecting samples -&gt; define featrues -&gt; design and build models -&gt; make prediction</code></li>
<li><p>Good representation for featrues:</p>
<ul>
<li><code>Low intra-class variability</code></li>
<li><code>Low inter-class similarity</code></li>
</ul>
</li>
<li><p>Bias and variance trade-off(åå·®å’Œæ–¹å·®ä¹‹é—´çš„æƒè¡¡ï¼Œä¸»è¦æ˜¯ä¸‹é¢è¿™å¼ å›¾ä½“ç°)ï¼š</p>
</li>
</ul>
<p><img src="/2019/06/29/machine-learning-1-DM-and-Bayesian/1.png" alt></p>
<ul>
<li><strong>Genelization(æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›)</strong>ï¼šThe performance on the <strong>testing</strong> data. ç®€å•çš„æ¨¡å‹çš„Train erroræ›´å¤§ï¼Œç›¸å¯¹è€Œè¨€è¶Šå¤æ‚çš„æ¨¡å‹çš„Train errorä¼šç›¸å¯¹æ›´å°ï¼Œä½†æ˜¯Test errorå°±ä¸ç¡®å®šäº†ï¼Œä¸»è¦è¦å‚è€ƒbiaså’Œvarianceè¿™ä¸¤ä¸ªåŸºå‡†æ¥è¿›è¡Œè€ƒé‡ã€‚</li>
</ul>
<h3 id="2-Bayesian"><a href="#2-Bayesian" class="headerlink" title="2. Bayesian"></a>2. Bayesian</h3><ul>
<li>Bayesâ€™ Theorem è´å¶æ–¯å®šç†ï¼ˆè¿™é‡Œæˆ‘ä»¬åªéœ€è¦æŒæ¡è´å¶æ–¯å…¬å¼å³å¯ï¼‰<script type="math/tex; mode=display">
P(A|B) = \frac{P(B|A) * P(A)}{P(B)}</script></li>
<li><strong>Prior</strong>: å…ˆéªŒçŸ¥è¯†ï¼Œä¹Ÿå³åœ¨è¿›è¡Œåˆ†ç±»ä¹‹å‰æˆ‘ä»¬èƒ½å¤Ÿå¾—çŸ¥çš„å·²çŸ¥çš„æ ·æœ¬ä¿¡æ¯ï¼Œå¦‚æœåªæ˜¯ç®€å•çš„æ ¹æ®å…ˆéªŒçŸ¥è¯†æ¥è¿›è¡Œåˆ†ç±»çš„è¯ï¼Œåªéœ€è¦åˆ¤æ–­$\omega_1$ if $p(\omega_1) &gt; p(\omega_2)$ else $\omega_2$.</li>
<li><strong>likelihood</strong>: ä¼¼ç„¶ï¼Œè¿™é‡Œä¸»è¦å¼•è¿›çš„æ˜¯<strong>æœ€å¤§ä¼¼ç„¶ä¼°è®¡</strong><br>&nbsp;&nbsp;&nbsp; Assign input pattern $x$ to class $\omega_1$ if $p(x|\omega_1) &gt; p(x|\omega_2)$ else $\omega_2$.</li>
<li><strong>Posterior</strong>: åéªŒæ¦‚ç‡ï¼Œåœ¨è´å¶æ–¯æ¨¡å‹å½“ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªç‚¹.</li>
</ul>
<script type="math/tex; mode=display">
\begin{aligned}
p(\omega_i|x) &= \frac{p(x|\omega_i) * p(\omega_i)}{p(x)} \\\\
p(x) &= \sum_{i=1}^c p(x|\omega_i) * p(\omega_i) \\\\
 1 &= \sum_{i=1}^cp(\omega_i|x) 
\end{aligned}</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>Posterior = prior * likelihood / evidence</code>, ä¸è¿‡å› ä¸ºä½¿ç”¨è´å¶æ–¯è¿›è¡ŒåéªŒä¼°è®¡çš„æ—¶å€™ï¼Œevidenceä½¿ç”¨æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥ä¸éœ€è¦è€ƒè™‘è¿™ä¸€é¡¹ï¼Œæˆ‘ä»¬åªéœ€è¦èšç„¦åœ¨å…ˆéªŒæ¦‚ç‡å’Œä¼¼ç„¶çš„è®¡ç®—ä¸Šå³å¯ã€‚</p>
<p><br></p>
<ul>
<li><strong>Optimal Bayes Decision rules</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨è¿™é‡Œä½¿ç”¨çš„å°±æ˜¯åéªŒæ¦‚ç‡æ¥è¿›è¡Œå†³ç­–ï¼šif $p(\omega_1|x) &gt; p(\omega_2|x)$, decides $\omega_1$, otherwise $\omega_2$. åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è¯æ˜ï¼Œè¿™ç§å†³ç­–æ–¹å¼æ˜¯é”™è¯¯æ¦‚ç‡æœ€å°çš„ä¸€ç§å†³ç­–æ–¹å¼ï¼Œè¿™æ˜¯å› ä¸ºï¼š</p>
<script type="math/tex; mode=display">
p(error|x) = min(p(\omega_1|x), p(\omega_2|x))</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>Special cases:</code>æ€»å…±æ˜¯ä¸¤ç§ç‰¹æ®Šæƒ…å†µï¼Œå½“ç„¶ä¹Ÿæ˜¯ä»åéªŒæ¦‚ç‡è®¡ç®—å…¬å¼çš„è§’åº¦å‡ºå‘è¿›è¡Œè€ƒè™‘ã€‚</p>
<ul>
<li>if $p(\omega_1) = p(\omega_2)$, then decide by if $p(x|\omega_1) &gt; p(x|\omega_2)$ then $\omega_1$ otherwise $\omega_2$ (Actually is <code>Maximum likelyhood decision</code>).</li>
<li>if $p(x|\omega_1) = p(x|\omega_2)$, then decide by if $p(\omega_1) &gt; p(\omega_2)$ then $\omega_1$ otherwise $\omega_2$ (Actually is <code>Prior</code>).</li>
</ul>
<p><br></p>
<ul>
<li><strong>Bayes risks</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨Bayes riskså½“ä¸­å¼•å…¥äº†actionå’Œriskçš„æ¦‚å¿µï¼Œå…¶ä¸­$\lambda(\alpha_i, \omega_j)$è¡¨ç¤ºçš„æ˜¯åœ¨ $\omega_j$ ç±»åˆ«ä¹‹ä¸Š take $action_i$ çš„ $risk$, æ‰€ä»¥æˆ‘ä»¬åˆå¯ä»¥å¾—åˆ°ä¸€ä¸ªæ–°çš„ä¼˜åŒ–ç›®æ ‡ï¼Œå°±æ˜¯é€‰å–actionå½“ä¸­çš„Bayes riskså½“ä¸­æœ€å°çš„ã€‚</p>
<script type="math/tex; mode=display">
\begin{aligned}
R(\alpha_i|x) &= \sum_{j=1}^c\lambda(\alpha_i, \omega_j)p(\omega_j|x) \\\\
R(\alpha_i) &= \sum_{over x}R(\alpha_i|x)
\end{aligned}</script><ul>
<li><strong>Discriminant function</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ç”±äºåœ¨è´å¶æ–¯å†³ç­–å½“ä¸­ï¼Œæˆ‘ä»¬é€‰å–çš„æ˜¯åéªŒæ¦‚ç‡ä½œä¸ºæˆ‘ä»¬çš„å†³ç­–ç­–ç•¥ã€‚æ‰€ä»¥å¯ä»¥å¾—åˆ°è´å¶æ–¯çš„Discriminant function:</p>
<script type="math/tex; mode=display">
g(x) = lnp(\omega_i|x) = lnp(x|\omega_i) + lnp(\omega_i)</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å¯ä»¥çœ‹åˆ°è¿™ä¸ªå¼å­å½“ä¸­ï¼Œå…ˆéªŒä»æ•°æ®å½“ä¸­å¾ˆå®¹æ˜“è·å–ï¼Œä¸»è¦æ˜¯ä¼¼ç„¶çš„ä¼°è®¡ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹ä¼¼ç„¶å‡½æ•°çš„å‚æ•°è¿›è¡Œä¼°è®¡ã€‚æœ€ç›´æ¥è€Œä¸”æœ€æœ´ç´ çš„å°±æ˜¯å‡è®¾ï¼Œæ•°æ®åœ¨ç±»åˆ«ç¡®å®šçš„æ—¶å€™æ˜¯æ»¡è¶³<code>é«˜æ–¯åˆ†å¸ƒæˆ–è€…æ­£æ€åˆ†å¸ƒ</code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½å†™å‡ºä¼¼ç„¶å‡½æ•°çš„å½¢å¼ï¼ˆå…¶ä¸­$\Sigma$ä¸ºåæ–¹å·®çŸ©é˜µ, $\mu$ä¸ºå‡å€¼, $| |$ä¸ºè¡Œåˆ—å¼å€¼ï¼‰ï¼š</p>
<script type="math/tex; mode=display">
p(x|\omega_i) = p(x|\theta) = \frac{1}{(2\pi)^{\frac{d}{2}}|\Sigma|^{\frac{1}{2}}} e^{-\frac{1}{2}(x-\mu)^T\Sigma^{-1}(x-\mu)}</script><p><br></p>
<ul>
<li><strong>MLE and Bayesian Estimation</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æ¥ä¸‹æ¥ä¸€ä¸ªå¾ˆè‡ªç„¶çš„é—®é¢˜å°±æ˜¯ï¼Œæ—¢ç„¶çªå·²ç»çŸ¥é“äº†ä¼¼ç„¶å‡½æ•°çš„å½¢å¼ï¼Œé‚£æˆ‘çš„å‚æ•°åº”è¯¥æ€ä¹ˆå»ä¼°è®¡å‘¢ï¼Ÿåˆ«æ€¥ï¼Œè¿™é‡Œç»™å‡ºäº†ä¸¤ç§ç”¨æ¥ä¼°è®¡æœ€ä½³å‚æ•°çš„æ–¹æ³•ï¼Œä¸€ç§æ˜¯Maximum Likelyhood Estimation, ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„æå¤§ä¼¼ç„¶ä¼°è®¡ï¼Œè¿˜æœ‰ä¸€ç§Bayesian Estimationè¿™é‡Œå°±ä¸å¤ªæ¶‰åŠï¼Œä¸»è¦æ€æƒ³æ˜¯æå‰å‡è®¾å‚æ•°æœ¬èº«ä¹Ÿæ˜¯ç¬¦åˆä¸€å®šçš„åˆ†å¸ƒçš„ï¼Œè€Œåœ¨MLEå½“ä¸­å‚æ•°æ˜¯æœ‰ä¸€ä¸ªæœ€ä¼˜çš„å€¼ï¼Œéœ€è¦é€šè¿‡æ•°æ®å»ä¼°è®¡è¿™ä¸ªæœ€ä¼˜çš„å€¼ã€‚<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹MLEæ˜¯å¦‚ä½•ä¼°è®¡å‚æ•°ï¼Œé¡¾åæ€ä¹‰ï¼Œéœ€è¦å»æœ€å¤§åŒ–æ•°æ®é›†çš„ä¼¼ç„¶ã€‚è¿™é‡Œæˆ‘ä»¬å®šä¹‰$p(D|\omega_i)$ä¸ºæ•°æ®é›†çš„ä¼¼ç„¶å‡½æ•°ï¼Œå¹¶ä¸”å‡è®¾æ•°æ®$x_1, x_2, â€¦ i.i.d$æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒçš„æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ•°æ®é›†ä¼¼ç„¶å°±èƒ½è¡¨ç¤ºä¸ºæ‰€æœ‰æ•°æ®çš„ä¼¼ç„¶è¿ä¹˜ï¼Œç„¶åå–ä¸€ä¸ªå¯¹æ•°ä¼¼ç„¶å˜ä¸ºè¿åŠ ï¼Œæ‰€ä»¥æœ€åçš„log-likelyhoodå¯ä»¥è¡¨ç¤ºä¸ºå¦‚ä¸‹çš„å½¢å¼ï¼Œç„¶åæˆ‘ä»¬åªéœ€è¦<code>maximize</code>è¿™ä¸ªä¼¼ç„¶å‡½æ•°å³å¯ï¼š</p>
<script type="math/tex; mode=display">
l(\theta) = lnp(D|\theta) = \sum_{i=1}^nlnp(x_i|\theta)</script><script type="math/tex; mode=display">
\theta^* = argmaxl(\theta) \implies \nabla_{\theta}l(\theta) = 0</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æœ€ååˆ†åˆ«å¯¹$\mu$å’Œ$\Sigma$è¿›è¡Œæ±‚å¯¼ï¼Œç„¶åå–æœ€å¤§å€¼å³å¯ï¼Œè¯¦ç»†çš„æ¨å¯¼è¿‡ç¨‹å¯ä»¥å‚è€ƒæˆ‘åœ¨<a href="https://github.com/MySuperSoul/DM/blob/master/assignment/hw1/hw1_3160104367_%E9%BB%84%E4%BA%A6%E9%9D%9E.pdf" target="_blank" rel="noopener">DM-assignment1</a>å½“ä¸­çš„æ¨å¯¼è¿‡ç¨‹ï¼Œé‡‡ç”¨çš„å°±æ˜¯å¯¹çŸ©é˜µè¿›è¡Œæ±‚å¯¼ï¼Œç„¶åå–æå€¼çš„æ–¹å¼ã€‚So far, the MLE of all parameters for class k is shown below:</p>
<script type="math/tex; mode=display">
\begin{cases}
\hat{\mu_k} = \frac{1}{m} \sum_{i=1}^mx_i \\\\
\hat{\Sigma_k} = \frac{1}{m}\sum_{i=1}^m(x_i-\hat{\mu_k})(x_i-\hat{\mu_k})^T \\\\
\hat{\phi_k} = \frac{N_k}{N}
\end{cases}</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ä¸è¿‡åœ¨è¿™é‡Œæœ‰ä¸€ç‚¹æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åæ–¹å·®çŸ©é˜µè¿˜å¯ä»¥å†™æˆè¿™ç§å½¢å¼ï¼Œ$\Sigma = \frac{1}{k}XX^T$, æ‰€ä»¥<strong>å½“featruesæ•°å¤§äºsamplesæ•°</strong>çš„æ—¶å€™ï¼ŒçŸ©é˜µ$\Sigma$æ˜¯ä¸æ»¡ç§©çŸ©é˜µï¼Œä¹Ÿå°±æ„å‘³ç€è¿™ä¸ªæ—¶å€™æ˜¯ä¸èƒ½é€šè¿‡MLEæ¥ä¼°è®¡å‚æ•°çš„ï¼Œå› ä¸º$|\Sigma| = 0$, è¿™ä¸ªæ—¶å€™log-ä¼¼ç„¶â™¾ã€‚</p>
<p><br></p>
<ul>
<li><strong>Back to discriminat function</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨ä¹‹å‰æˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•åˆ©ç”¨MLEæ¥ä¼°è®¡ä¼¼ç„¶å‡½æ•°çš„å‚æ•°ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¸»è¦è®¨è®ºå‡ ç§discriminat functionçš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯$g(x)$å‡½æ•°çš„çº¿æ€§å…³ç³»ã€‚æˆ‘ä»¬é¦–å…ˆå°†$p(x|\omega_i)$çš„é«˜æ–¯å½¢å¼å¸¦å…¥ä¸Šé¢çš„logä¼¼ç„¶å‡½æ•°ï¼Œå¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
g(x) = -\frac{1}{2}(x_i-\mu)^T\Sigma^{-1}(x_i-\mu)-\frac{d}{2}ln2\pi-\frac{1}{2}ln|\Sigma|+lnp(\omega_i)</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>(1)Case $\Sigma_i = \sigma^2I$</strong></p>
<script type="math/tex; mode=display">
g(x)=-\frac{1}{2\sigma^2}(X^TX-2\mu_i^TX+\mu_i^T\mu_i) + lnp(\omega_i) = \omega_i^TX+\omega_{i0} \implies linear</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>Hyperplanes</strong>:</p>
<script type="math/tex; mode=display">
\begin{aligned}
g_i(x) = g_j(x)
\end{aligned}</script><script type="math/tex; mode=display">
0 = (\frac{\mu_i-\mu_j}{\sigma^2})^Tx - \frac{\mu_i^T\mu_i - \mu_j^T\mu_j}{2\sigma^2} + ln\frac{p(\omega_i)}{p(\omega_j)}</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>(2)Case $\Sigma_i = \Sigma$, å³æ‰€æœ‰ç±»çš„covçŸ©é˜µæ˜¯ç›¸åŒçš„</strong></p>
<script type="math/tex; mode=display">
g_i(x) = \mu_i^T\Sigma^{-1}x-\frac{1}{2}\mu_i^T\Sigma^{-1}\mu_i + lnp(\omega_i) \implies linear</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>(3)Case $\Sigma_i = arbitary$</strong></p>
<script type="math/tex; mode=display">
g_i(x) = x^T\omega_ix+\omega_i^Tx + \omega_{i0} \implies Quadratic</script><p><br></p>
<ul>
<li><strong>Error Probabilities</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; è¿™ä¸€ä¸ªpartä¼šå±•ç¤ºä¸ºä»€ä¹ˆé€‰ç”¨åéªŒæ˜¯ä¸€ä¸ªæœ€ä¼˜çš„ç­–ç•¥ï¼Œé¦–å…ˆæˆ‘ä»¬çœ‹ä¸¤åˆ†ç±»çš„é—®é¢˜ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>(1)two-classes</strong></p>
<script type="math/tex; mode=display">
\begin{aligned}
p(error) &= p(x\in R_2, \omega_1) + p(x\in R_1, \omega_2) \\\\
&= p(x\in R_2|\omega_1)p(\omega_1) + p(x\in R_1|\omega_2)p(\omega_2) \\\\
&= \int_{x\in R_2}p(x|\omega_1)p(\omega_1) + \int_{x\in R_1}p(x|\omega_2)p(\omega_2)
\end{aligned}</script><p><img src="/2019/06/29/machine-learning-1-DM-and-Bayesian/2.png" alt></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>(2)multi-classes</strong></p>
<script type="math/tex; mode=display">
p(correct) = \sum_{i=1}^c \int_{x\in R_i}p(x|\omega_i)p(\omega_i)</script><p><br></p>
<ul>
<li><strong>Naive Bayes classifier</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ç»è¿‡å‰é¢çš„ä¸€ç³»åˆ—é“ºå«ä¹‹åï¼Œæˆ‘ä»¬å¼•å…¥ä»Šå¤©çš„æœ€åä¸€ä¸ªä¸»é¢˜ï¼Œ<strong>æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨</strong>ã€‚æ€æƒ³éå¸¸æœ´ç´ ï¼Œå°±æ˜¯åˆ©ç”¨çš„åéªŒæ¥è¿›è¡Œå†³ç­–ã€‚è€ŒåéªŒæ­£æ¯”ä¼¼ç„¶ä¹˜ä¸Šå…ˆéªŒï¼Œå…ˆéªŒçŸ¥è¯†å¾ˆå®¹æ˜“ä»æ•°æ®å½“ä¸­å¾—åˆ°ï¼Œä¼¼ç„¶åˆ™å‡è®¾çš„æ˜¯ä¸åŒfeatruesä¹‹é—´æ˜¯ä¸ç›¸å…³çš„ï¼Œä¹Ÿå³ï¼š</p>
<script type="math/tex; mode=display">
p(\omega_i|x) \propto p(x|\omega_i)p(\omega_i) = p(x_1|\omega_i)p(x_2|\omega_i)...p(x_n|\omega_i)p(\omega_i)</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åˆ°è¿™é‡Œä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹æ¯ä¸€ä¸ªfeatrueè¿›è¡Œä¸€ä¸ªä¼¼ç„¶çš„ä¼°è®¡å°±å¯ä»¥äº†ï¼Œæ ¹æ®æ•°æ®çš„å½¢å¼åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>1)ç¦»æ•£å€¼ï¼š</strong> åœ¨$\omega_i$ç±»åˆ«å½“ä¸­ç›´æ¥æ•°æ•°é‡é™¤ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°ä¼¼ç„¶çš„å€¼ã€‚<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>2)è¿ç»­å€¼ï¼š</strong> è¿™ç§æƒ…å†µä¹‹ä¸‹å‡è®¾$\omega_i$çš„æ•°æ®ç¬¦åˆé«˜æ–¯åˆ†å¸ƒï¼Œåˆ†åˆ«å»è®¡ç®—mean $\mu$ å’Œæ–¹å·® $\sigma^2$, ç„¶åç”¨å­¦åˆ°çš„é«˜æ–¯æ¨¡å‹å¯¹è¾“å…¥çš„æ•°æ®è¿›è¡Œä¼¼ç„¶è®¡ç®—å³å¯ã€‚</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æœ€åè¦æä¸€ç‚¹å°±æ˜¯<code>æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘</code>ï¼Œä¸ºä»€ä¹ˆè¦åšå¹³æ»‘å‘¢ï¼Œå› ä¸ºåœ¨ç¦»æ•£å€¼çš„æ—¶å€™ï¼Œå¾ˆå¯èƒ½è¾“å…¥çš„æ•°æ®åœ¨æ•°æ®é›†å½“ä¸­æ˜¯ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™æ ¹æ®å…ˆå‰çš„è®¡ç®—å…¬å¼è®¡ç®—å¾—å‡ºè¯¥é¡¹ä¸º0ï¼Œä½¿å¾—æ•´ä¸ªè¿ä¹˜çš„åéªŒæ¦‚ç‡å‡ä¸º0ï¼Œæ˜¾ç„¶è¿™æ˜¯ä¸åˆç†çš„ä¸€ç§è®¡ç®—æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œå¹³æ»‘å¤„ç†ï¼Œå…·ä½“çš„å¹³æ»‘æ“ä½œæ˜¯, å…¶ä¸­çš„Kä¸º$\omega_k$ç±»å½“ä¸­æ€»çš„ç±»åˆ«æ•°ç›®ï¼š</p>
<script type="math/tex; mode=display">
p(x_i|\omega_k) = \frac{|x_{ik}|+1}{N_{\omega_k}+K}</script><p><br></p>
<h3 id="3-Summary-for-Naive-Bayes"><a href="#3-Summary-for-Naive-Bayes" class="headerlink" title="3. Summary for Naive Bayes"></a>3. Summary for Naive Bayes</h3><ul>
<li>Robust to isolated noise points</li>
<li>Handle missing values by ignoring the instance during probability estimate calculations</li>
<li>Robust to irrelevant attributes</li>
<li><strong>Independence assumption may not hold for some attributes</strong></li>
</ul>
]]></content>
      <categories>
        <category>machine-learning</category>
      </categories>
      <tags>
        <tag>machine-learning</tag>
      </tags>
  </entry>
  <entry>
    <title>python-basic</title>
    <url>/2019/06/23/python-basic/</url>
    <content><![CDATA[<p>&nbsp;&nbsp;&nbsp;&nbsp;æœ€è¿‘é©¬ä¸Šè¦pythonè€ƒè¯•äº†ï¼Œanywayè™½ç„¶æ˜¯åŸºç¡€è¯¾ï¼Œè¿˜æ˜¯ç¨å¾®å¤ä¹ ä¸€ä¸‹ï¼Œåœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹å¯èƒ½ä¼šæœ‰çš„å‘å’Œå¹³æ—¶ä½œä¸šé‡Œé¢çš„ä¸€äº›é”™é¢˜ï¼Œä»¥åä¾ä¸€äº›å…¶ä»–åŸºæœ¬çš„éœ€è¦æ³¨æ„çš„ä¸œè¥¿éƒ½å¯ä»¥å†™åˆ°é‡Œé¢æ¥ï½</p>
<a id="more"></a>
<h3 id="Slides"><a href="#Slides" class="headerlink" title="Slides"></a>Slides</h3><h4 id="chapter1"><a href="#chapter1" class="headerlink" title="chapter1"></a>chapter1</h4><ul>
<li><p>Unicodeç ï¼šä¸ºæ¯ä¸ªå­—ç¬¦è®¾å®šäº†ç»Ÿä¸€çš„å¹¶ä¸”æ˜¯å”¯ä¸€çš„äºŒè¿›åˆ¶ç¼–ç ï¼Œç”¨æ¥æ»¡è¶³è·¨å¹³å°çš„éœ€æ±‚ã€‚ <code>\u</code>è¡¨ç¤ºUnicodeç ã€‚</p>
</li>
<li><p>utf-8ç¼–ç ï¼šæ¯ä¸€ä¸ªASCIIç éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„utf-8ç¼–ç ï¼Œæ­£å¥½ä¸8ä½çš„ASCIIç¼–ç æ˜¯ä¸€æ ·çš„ã€‚pyç¨‹åºé»˜è®¤æ˜¯utf-8ç¼–ç æ ¼å¼ï¼Œå¹¶ä¸”æ˜¯<code>ä¸å®šé•¿</code>çš„ç¼–ç æ–¹å¼ã€‚</p>
</li>
<li>pyæ˜¯ä¸€ç§è§£é‡Šå‹çš„è¯­è¨€ã€‚</li>
<li>æ ‡è¯†ç¬¦ï¼šç”±<code>å­—ç¬¦</code>ï¼Œ<code>ä¸‹åˆ’çº¿</code>ï¼Œ<code>æ•°å­—ç»„æˆ</code>ï¼Œä½†æ˜¯æ³¨æ„çš„æ˜¯ä¸èƒ½ä»¥<code>æ•°å­—å¼€å¤´</code>.<ul>
<li>my_test</li>
<li>_123</li>
</ul>
</li>
</ul>
<h4 id="chapter2"><a href="#chapter2" class="headerlink" title="chapter2"></a>chapter2</h4><ul>
<li>äºŒè¿›åˆ¶ï¼Œå…«è¿›åˆ¶ï¼Œåå…­è¿›åˆ¶ï¼š0b(B)ã€0o(O)ã€0x(X)</li>
<li>æµ®ç‚¹æ•° <strong>è¿ç®—(æ³¨æ„æ˜¯è¿ç®—)</strong> å­˜åœ¨è¯¯å·®ï¼š<code>2.1-2.0==0.1 False</code>. å¹¶ä¸”æµ®ç‚¹æ•°çš„<code>//</code>è¿ç®—è¾“å‡ºä¹Ÿæ˜¯æµ®ç‚¹æ•°ã€‚</li>
<li>ç§‘å­¦è®¡æ•°æ³•ï¼š<code>12345 = 1.23e4, 0.012 = 1.2e-2</code>.</li>
<li>å¤æ•°ï¼šreal+imag * jï¼Œå…¶ä¸­realæ˜¯å®æ•°éƒ¨åˆ†ï¼Œimagæ˜¯è™šæ•°éƒ¨åˆ†ã€‚</li>
<li>å‡½æ•°å’Œæ–¹æ³•ï¼š<code>æ–¹æ³•</code>æ˜¯ä¾èµ–æ•°æ®ç±»å‹çš„å¦ä¸€ç§å‡½æ•°ï¼Œä¸€èˆ¬æ–¹æ³•æ˜¯åœ¨ç±»å½“ä¸­å®šä¹‰çš„å«åš *ç±»æ–¹æ³•* ã€‚</li>
<li>å¤šè¡Œå­—ç¬¦ä¸²ï¼Œæ˜¯ç”¨<code>&#39;&#39;&#39;xxx&#39;&#39;&#39;</code>æ¥è¡¨ç¤ºå¤šè¡Œå­—ç¬¦ä¸²ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ç»™æ¯ä¸€è¡Œçš„å­—ç¬¦ä¸²è‡ªåŠ¨åŠ ä¸Šä¸€ä¸ª<code>\n</code>æ¥è¿›è¡Œæ¢è¡Œã€‚</li>
<li>pythonæ”¯æŒå¤šæ¡ä»¶æ¯”è¾ƒï¼Œä¹Ÿå³<code>1&lt;3&lt;5 == 1&lt;3 and 3&lt;5</code>, <code>1&lt;3&gt;2 == 1&lt;3 and 3&gt;2</code>, æ‰€ä»¥è¿™ä¸¤ä¸ªéƒ½æ˜¯Trueã€‚</li>
<li>ä¸€å®šè¦æ³¨æ„and å’Œ or åˆ¤æ–­è¿™ä¸¤ä¸ªå‘ï¼Œä¸€ä¸ªæ˜¯andå¦‚æœå‰é¢çš„å·²ç»Falseï¼Œåé¢å°±ä¸ä¼šåˆ¤æ–­ï¼Œorå‰é¢å¦‚æœå·²ç»Trueï¼Œåé¢çš„ä¹Ÿä¸ä¼šåˆ¤æ–­äº†ã€‚</li>
<li>3 and 5, æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ä½œä¸ºæ•´ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚</li>
<li>è¿ç®—çš„ä¼˜å…ˆçº§å’Œæ–¹å‘ï¼šé™¤æ‰<code>**</code>çš„æ–¹å‘æ˜¯ä»å³å¾€å·¦çš„ï¼Œå…¶ä»–æ‰€æœ‰è¿ç®—çš„æ–¹å‘éƒ½æ˜¯ä»å·¦å¾€å³çš„ã€‚</li>
<li>åˆ—è¡¨è¿ç®—ï¼šåŠ æ³•<code>[1, 2, 3] + [c, py]</code>, ä¹˜æ³•<code>[1] * 3 -&gt; [1, 1, 1]</code></li>
<li>intå‡½æ•°ç”¨æ³•ï¼š<code>int()-&gt;0, int(&quot;02&quot;), int(&quot;  35 &quot;), int(&quot;35&quot;, 8)è¡¨ç¤ºçš„æ˜¯å…«è¿›åˆ¶ä¸‹çš„&quot;35&quot;ä»£è¡¨çš„10è¿›åˆ¶æ•°</code>.</li>
<li>å…¶ä»–å†…ç½®å‡½æ•°ï¼š<code>bin(), hex(), oct(), ord(str)-&gt;unicode, chr(unicode)-&gt;str</code></li>
<li>åºåˆ—ä¸ç­‰çš„èµ‹å€¼ï¼š<code>i, *j = &quot;123&quot;, j -&gt; [&#39;2&#39;, &#39;3&#39;]</code></li>
<li>æ ¼å¼åŒ–ï¼š<code>^, &lt;, &gt;</code>åˆ†åˆ«ä»£è¡¨çš„æ˜¯å±…ä¸­ã€å·¦ã€å³å¯¹é½æ–¹å¼ã€‚ç§‘å­¦è®¡æ•°æ³•ï¼š<code>.2e</code>ä¿ç•™ä¸¤ä½å°æ•°çš„ç§‘å­¦è®¡æ•°æ³•ã€‚<code>{index_1:x.yf}{index_2:x.yf}</code>æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚<code>format(value, &quot;x.yf&quot;)</code></li>
</ul>
<h4 id="chapter3"><a href="#chapter3" class="headerlink" title="chapter3"></a>chapter3</h4><ul>
<li>åˆ—è¡¨é€†åºï¼š<code>lst[::-1]</code>ã€‚</li>
<li>åˆ—è¡¨çš„æµ…å¤åˆ¶ï¼š<code>b = a[:]</code>, è¿™æ ·å¤åˆ¶å‡ºæ¥çš„å°±æ˜¯ä¸¤ä¸ªä¸åŒçš„åˆ—è¡¨ã€‚æˆ–è€…é‡‡ç”¨åˆ—è¡¨å½“ä¸­çš„æ–¹æ³•ï¼š<code>b = a.copy()</code>.</li>
<li>åŸå§‹å­—ç¬¦ä¸²ï¼š<code>r&#39;hello\n&#39; -&gt; hello\n</code>, å­—ç¬¦ä¸²<code>ä¸å¯ä¿®æ”¹</code>, <code>find(str, start_pos, end_pos)</code></li>
<li><code>title()é¦–å­—æ¯å¤§å†™ï¼Œlower(), upper()</code></li>
<li>å­—ç¬¦ä¸²çš„formatå‡½æ•°ï¼š<code>{index:&lt;å¡«å……&gt;|^, &gt;, &lt;| &lt;å®½åº¦.ç²¾åº¦&gt;&lt;æ ¼å¼&gt;}</code>, åŒæ—¶<code>&#39;{:,}&#39;.formatè¡¨ç¤ºçš„æ˜¯åƒåˆ†ä½æ•°ç”¨é€—å·éš”å¼€çš„å½¢å¼</code></li>
<li>åˆ—è¡¨æ–¹æ³•ï¼š<code>l.extend(x), l.pop(index)é»˜è®¤æœ€åä¸€ä¸ªä¸”ä¼šè¿”å›, l.remove(value), l.reverse(), l.sort(), l.insert(index, value)è‹¥indexè¶…åˆ™æœ€åä¸€ä¸ª, å¦‚æœæ˜¯indexä¸ºè´Ÿæ•°çš„æ—¶å€™è¶…åˆ™éƒ½æ˜¯æ’å…¥åœ¨ç¬¬ä¸€ä¸ª</code>.</li>
<li>a = (3) -&gt; int, a = (3,) -&gt; tuple, å¹¶ä¸”å…ƒç»„åªæœ‰<code>count(x) å’Œ index(x)è¿™ä¸¤ä¸ªå‡½æ•°</code></li>
<li>éœ€è¦æ³¨æ„splitå‡½æ•°ï¼š</li>
</ul>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">sen = <span class="string">'hello    wor   ld  '</span></span><br><span class="line">s = sen.split()</span><br><span class="line">print(len(s)) -&gt; 3</span><br><span class="line"></span><br><span class="line">s = sen.split(<span class="string">' '</span>)</span><br><span class="line">print(len(s)) -&gt; 10</span><br></pre></td></tr></table></figure>
<ul>
<li><p>éšæœºå‡½æ•°åº“ï¼šrandomåº“</p>
<ul>
<li>random.random() -&gt; [0.0, 1.0)</li>
<li>random.uniform(a, b) -&gt; [a, b]</li>
<li>random.randint(a, b) -&gt; éšæœºçš„ä¸€ä¸ªæ•´æ•°</li>
</ul>
</li>
</ul>
<p><img src="/2019/06/23/python-basic/random.png" alt="random"></p>
<h4 id="chapter4"><a href="#chapter4" class="headerlink" title="chapter4"></a>chapter4</h4><ul>
<li><p>Python mapå‡½æ•°: <strong>map(function, iterable)</strong> å¯¹æŒ‡å®šçš„åºåˆ—æ‰§è¡Œ<code>map</code>æ“ä½œï¼Œä¹Ÿå³æ¯ä¸ªå…ƒç´ éƒ½æ‰§è¡Œfunction, <code>x, y = map(int, input().split())</code>æ‰§è¡Œçš„æ˜¯å†…ç½®å‡½æ•°<code>int</code>, æˆ–è€…ä¹Ÿå¯ä»¥æ˜¯åŒ¿åå‡½æ•°<code>map(lambda x : x**2, [1, 2, 3])</code>.</p>
</li>
<li><p>try-exceptä½¿ç”¨æ ¼å¼ï¼š</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    block</span><br><span class="line"><span class="keyword">except</span> Exception <span class="number">1</span>:</span><br><span class="line">    block1</span><br><span class="line"><span class="keyword">except</span> Exception <span class="number">2</span>:</span><br><span class="line">    block2</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    block3</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    block4</span><br><span class="line"><span class="keyword">finally</span>: block5</span><br></pre></td></tr></table></figure>
<ul>
<li>whileä½¿ç”¨æ ¼å¼ï¼š</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span>(condition):</span><br><span class="line">    block1</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    block2</span><br></pre></td></tr></table></figure>
<ul>
<li>Gcdç®—æ³•</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> gcd(b, a % b)</span><br></pre></td></tr></table></figure>
<h4 id="chapter5"><a href="#chapter5" class="headerlink" title="chapter5"></a>chapter5</h4><ul>
<li>setæ˜¯ä¸€ç§å®¹å™¨ï¼Œ<code>æ²¡æœ‰å…ˆåé¡ºåºï¼Œå¹¶ä¸”å…ƒç´ çš„å€¼ä¸é‡å¤</code>, éœ€è¦æ³¨æ„çš„æ˜¯é›†åˆçš„å…ƒç´ éœ€è¦æ˜¯<strong>ä¸å¯å˜å¯¹è±¡</strong>, æ¢å¥è¯è¯´å°±æ˜¯åˆ—è¡¨ä¸èƒ½æˆä¸ºé›†åˆå½“ä¸­çš„å…ƒç´ .</li>
<li>ç©ºé›†åˆï¼š</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">empty = set()</span><br><span class="line">empty = &#123;&#125; <span class="comment">#åˆ›å»ºçš„æ˜¯ç©ºå­—å…¸</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æ–¹æ³•ï¼š<code>add, remove, len, max, min, sum, issubset, issuperset</code>, éœ€è¦ç‰¢è®°çš„æ˜¯é›†åˆæ˜¯<code>æ— åºçš„</code>ï¼Œæ‰€ä»¥æ¯æ¬¡printå‡ºæ¥çš„ç»“æœæ˜¯ä¸ç¡®å®šçš„ã€‚</li>
<li>åœ¨é›†åˆå½“ä¸­çš„ <code>==</code> åˆ¤æ–­çš„æ˜¯ä¸¤ä¸ªsetå½“ä¸­çš„å…ƒç´ æ˜¯å¦æ˜¯ç›¸åŒçš„ï¼Œå¦‚æœæ˜¯ç›¸åŒçš„åˆ™è¾“å‡ºçš„æ˜¯<code>True</code>.</li>
<li><code>&lt;, &lt;=, &gt;, &gt;=</code>åˆ¤æ–­æ˜¯çœŸå­é›†ï¼Œå­é›†ï¼ŒçœŸè¶…é›†ï¼Œè¶…é›†è¿™äº›çš„ã€‚</li>
<li>é›†åˆè¿ç®—<code>|, &amp;, -, ^</code>åˆ†åˆ«æ˜¯<code>å¹¶é›†ã€äº¤é›†ã€å·®é›†ã€å¯¹ç§°å·®</code>ï¼Œå¯¹ç§°å·®æŒ‡çš„æ˜¯é™¤äº†å…±åŒå…ƒç´ ä¹‹å¤–çš„å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯<code>a ^ b = (a | b) - (a &amp; b)</code></li>
<li>åˆ—è¡¨å»é‡å¹¶ä¸”é¡ºåºä¸å˜ä¸¤ç§æ–¹æ³•ï¼š</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">addr_to = list(set(a))</span><br><span class="line">addr_to.sort(key=a.index)</span><br><span class="line"></span><br><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">addr_to = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> i <span class="keyword">in</span> addr_to:</span><br><span class="line">        addr_to.append(i)</span><br></pre></td></tr></table></figure>
<ul>
<li>å­—å…¸çš„åˆ›å»ºæ–¹å¼ï¼š</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fac = dict([(key1, value1), (key2, value2)])</span><br><span class="line">fac = dict(key1=value1, key2=value2) <span class="comment">#è¿™ç§æ–¹å¼éœ€è¦ä½¿ç”¨æ ‡è¯†ç¬¦ï¼Œå¹¶ä¸”é”®ç”¨çš„æ˜¯strç±»å‹</span></span><br><span class="line"><span class="comment"># -&gt; &#123;'key1':value1, 'key2':value2&#125;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>å­—å…¸çš„é”®å¿…é¡»è¦æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œå¯å˜å¯¹è±¡æ¯”å¦‚<code>åˆ—è¡¨ï¼Œå­—å…¸</code>æ˜¯ä¸èƒ½ä½œä¸ºå­—å…¸çš„é”®çš„ã€‚</li>
<li>å­—å…¸çš„æ–¹æ³•ï¼š<code>in, not in</code>åˆ¤æ–­çš„æ˜¯ä¸€ä¸ªå€¼æ˜¯å¦å­˜åœ¨å­—å…¸çš„é”®å½“ä¸­ã€‚get(key, é»˜è®¤å€¼)è¿™ä¸ªå‡½æ•°å¯ä»¥åœ¨åé¢è®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼ä½œä¸ºä¸å­˜åœ¨æ—¶å€™çš„è¿”å›ï¼Œä¸åŠ æ˜¯<code>None</code>.</li>
</ul>
<p><img src="/2019/06/23/python-basic/dict_function.png" alt="dict functions"></p>
<h4 id="chapter6"><a href="#chapter6" class="headerlink" title="chapter6"></a>chapter6</h4><ul>
<li>lambdaè¡¨è¾¾å¼ï¼š<code>g = lambda x, y, z : x + y + z -&gt; g(1, 2, 3)</code></li>
<li>ä½ç½®å‚æ•°: å°±æ˜¯æ™®é€šçš„é‚£ç§å‚æ•°ä¼ é€’æ–¹å¼</li>
<li>å…³é”®å­—å‚æ•°(å¯ä»¥å…è®¸ä½ç½®ä¸åŒæ—¶è¿›è¡Œèµ‹å€¼)ï¼š</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dis</span><span class="params">(x1,y1,x2,y2)</span>:</span> <span class="comment">#æ±‚å¹³é¢ä¸Šä¸¤ç‚¹è·ç¦» </span></span><br><span class="line">    print(<span class="string">"x1=&#123;&#125;,y1=&#123;&#125;,x2=&#123;&#125;,y2=&#123;&#125;"</span>.format(x1,y1,x2,y2)) </span><br><span class="line">    <span class="keyword">return</span> sqrt((x1-x2)**<span class="number">2</span>+(y1-y2)**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">print(dis(x1=<span class="number">1</span>,y2=<span class="number">5</span>,y1=<span class="number">3</span>,x2=<span class="number">4</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>ä½ç½®å‚æ•°ä¸å…³é”®å­—å‚æ•°ä¸€èµ·ä½¿ç”¨ï¼šéœ€è¦æ³¨æ„âš ï¸çš„æ˜¯è¿™ç§æƒ…å†µä¹‹ä¸‹ï¼Œä½ç½®å‚æ•°éœ€è¦å…ˆå†™ï¼Œç„¶åå†ä½¿ç”¨å…³é”®å­—å‚æ•°ï¼Œå¦åˆ™ä¼šå‡ºé”™ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#correct use</span></span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dis</span><span class="params">(x1,y1,x2,y2)</span>:</span> <span class="comment">#æ±‚å¹³ é¢ä¸Šä¸¤ç‚¹è·ç¦»     </span></span><br><span class="line">     print(<span class="string">"x1=&#123;&#125;,y1=&#123;&#125;,x2=&#123;&#125;,y2=&#123;&#125;"</span>.format(x1,y1,x2,y2)) </span><br><span class="line">     <span class="keyword">return</span> sqrt((x1-x2)**<span class="number">2</span>+(y1-y2)**<span class="number">2</span>)</span><br><span class="line">print(dis(<span class="number">1</span>,<span class="number">3</span>,y2=<span class="number">5</span>,x2=<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#wrong case</span></span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dis</span><span class="params">(x1,y1,x2,y2)</span>:</span> <span class="comment">#æ±‚å¹³é¢ä¸Šä¸¤ç‚¹è·ç¦»  </span></span><br><span class="line">    print(<span class="string">"x1=&#123;&#125;,y1=&#123;&#125;,x2=&#123;&#125;,y2=&#123;&#125;"</span>.format(x1,y1,x2,y2)) </span><br><span class="line">    <span class="keyword">return</span> sqrt((x1-x2)**<span class="number">2</span>+(y1-y2)**<span class="number">2</span>)</span><br><span class="line">print(dis(<span class="number">1</span>,y1=<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>é»˜è®¤å€¼å‚æ•°ï¼šè¿™é‡Œå°±æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé»˜è®¤å€¼å‚æ•°åœ¨å‡½æ•°å¯¹è±¡è¢«åˆ›å»ºçš„æ—¶å€™åŒæ—¶è¢«åˆ›å»ºï¼Œç›¸å½“äºå¦‚æœé»˜è®¤å€¼æœ‰ä¸€ä¸ª<code>list</code>çš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªé™æ€çš„<code>static</code>çš„listä¸€ç›´å­˜åœ¨ï¼š</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">(arg, result=[])</span>:</span></span><br><span class="line">Â     result.append(arg)</span><br><span class="line">print(result)</span><br><span class="line">init(<span class="string">'a'</span>) <span class="comment">#['a']</span></span><br><span class="line">init(<span class="string">'b'</span>) <span class="comment">#['a', 'b']</span></span><br></pre></td></tr></table></figure>
<ul>
<li>ä¸å®šé•¿æ•°ç›®å‚æ•°ï¼šä½¿ç”¨<code>*</code>å°†å¯å˜çš„å‚æ•°<strong>å˜ä¸ºå…ƒç»„å­˜æ”¾</strong>ï¼Œå…·ä½“çš„ä½¿ç”¨ğŸŒ°ï¼š</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">countnum</span><span class="params">(a,*b)</span>:</span> <span class="comment">#è®¡ç®—å‚æ•°ä¸ªæ•°</span></span><br><span class="line">    print(b) <span class="comment">#(7, 9)</span></span><br><span class="line">Â    print(len(b)+<span class="number">1</span>) <span class="comment"># 3</span></span><br><span class="line">countnum(<span class="number">3</span>,<span class="number">7</span>,<span class="number">9</span>)</span><br><span class="line">countnum(<span class="number">5</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">89</span>)</span><br></pre></td></tr></table></figure>
<p><code>*</code>æˆ–è€…æ˜¯<code>**</code>ä½œç”¨åœ¨å‡½æ•°çš„å½¢å‚ä¸Šä»£è¡¨çš„åˆ†åˆ«æ˜¯ç”¨<code>å…ƒç»„</code>å’Œ<code>å­—å…¸</code>æ¥æ¥æ”¶å‚æ•°ã€‚<br><code>*</code>æˆ–è€…æ˜¯<code>**</code>ä½œç”¨åœ¨å®å‚ä¸Šä»£è¡¨çš„æ˜¯è§£åŒ…ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">lst = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">print(*lst) <span class="comment"># 1 2 3</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">countnum</span><span class="params">(a,**d)</span>:</span> <span class="comment">#è®¡ç®—å‚æ•°ä¸ªæ•°</span></span><br><span class="line">    print(d)</span><br><span class="line">    print(len(d)+<span class="number">1</span>)</span><br><span class="line">countnum(<span class="number">3</span>,x1=<span class="number">9</span>,x2=<span class="number">1</span>,x3=<span class="number">6</span>,x4=<span class="number">89</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>return</code>å¦‚æœæ²¡æœ‰åˆ™é»˜è®¤å€¼æ˜¯<code>None</code></li>
<li><p>å‘½åç©ºé—´ï¼šå…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡ä¸ä¸€æ ·ï¼Œåœ¨<code>å±€éƒ¨åŒºåŸŸ</code>é‡Œé¢å¯ä»¥ä½¿ç”¨<code>å…¨å±€å˜é‡</code>ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™<code>ä¸èƒ½åœ¨å±€éƒ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨äº†å…¨å±€å˜é‡å†å®šä¹‰åŒåå˜é‡ï¼Œå¦åˆ™å‡ºé”™âŒï¼Œä¼šå˜æˆå˜é‡è¿˜æœªå®šä¹‰å°±ä½¿ç”¨</code>ã€‚ä½†æ˜¯ä¸€æ—¦å®šä¹‰äº†åŒåçš„å˜é‡ï¼Œä½¿ç”¨éƒ½æ˜¯ç”¨çš„å±€éƒ¨å˜é‡æ¥ä½¿ç”¨ã€‚è¦ä½¿ç”¨å’Œä¿®æ”¹å…¨å±€å˜é‡ï¼Œè¯·ä½¿ç”¨<code>global</code>å…³é”®å­—æ¥å®Œæˆã€‚</p>
</li>
<li><p>å†…ç½®å‡½æ•°<code>zip</code>ç”¨æ¥æ‰“åŒ…ğŸ“¦ä¸¤ä¸ªå¯è¿­ä»£çš„åºåˆ—</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">b = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">print(list(zip(a, b)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­—å…¸çš„é”®å€¼å¯¹äº’æ¢</span></span><br><span class="line">dic = &#123;<span class="number">1</span>:<span class="number">1</span>, <span class="number">2</span>:<span class="number">2</span>, <span class="string">'1'</span>:<span class="number">500</span>&#125;</span><br><span class="line">print(dict(zip(dic.values(), dic.keys())))</span><br><span class="line"><span class="comment"># &#123;1: 1, 2: 2, 500: '1'&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># eval è®¡ç®—è¡¨è¾¾å¼çš„å€¼</span></span><br><span class="line">a = <span class="number">3</span>; b = <span class="number">7</span></span><br><span class="line">print(eval(<span class="string">'a * 3 + b * 5'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># exec æ‰§è¡Œpythonè¯­å¥</span></span><br><span class="line">exec(<span class="string">'print("hello world")'</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">all, any æ¥å—çš„æ˜¯å¯è¿­ä»£çš„åºåˆ—</span></span><br><span class="line"><span class="string">allè¡¨ç¤ºå…¨éƒ¨æ˜¯Trueï¼Œæ‰è¿”å›True</span></span><br><span class="line"><span class="string">anyè¡¨ç¤ºåªè¦æœ‰ä¸€ä¸ªTrueï¼Œå³ç»“æœæœ€åè¿”å›çš„æ˜¯True</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">all([[], <span class="literal">False</span>, <span class="number">0</span>]) <span class="comment"># False</span></span><br><span class="line">all([<span class="number">1</span>, <span class="literal">True</span>, [<span class="number">1</span>]]) <span class="comment"># True</span></span><br><span class="line">any([[], <span class="literal">False</span>, <span class="number">0</span>]) <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># __main__çš„ä½œç”¨åŸŸå°±æ˜¯å…¨å±€åŸŸ</span></span><br></pre></td></tr></table></figure>
<ul>
<li>å‘½ä»¤è¡Œå‚æ•°æ ¼å¼ï¼šsys.argv[0]æ–‡ä»¶åï¼Œsys.argv[1]â€¦éƒ½æ˜¯å‚æ•°ã€‚</li>
<li>pythonåŒ…ï¼šæ˜¯ä¸€ä¸ªç›®å½•ï¼Œå½“ä¸­è¦åŒ…å«<code>init.py</code>ï¼Œç„¶åå°±æ˜¯é‚£ç§ä¼ ç»Ÿçš„åŒ…ï¼Œå¯ä»¥è¿›è¡Œ<code>import package.module</code></li>
</ul>
<h4 id="chapter7"><a href="#chapter7" class="headerlink" title="chapter7"></a>chapter7</h4><ul>
<li>æ–‡ä»¶æ‰“å¼€ï¼š<code>open(filename, mode)</code></li>
</ul>
<p><img src="/2019/06/23/python-basic/file_mode.png" alt="file mode"></p>
<ul>
<li><p>è¯»å†™å‡½æ•°ï¼š</p>
<ul>
<li>read: å°†æ–‡ä»¶æ‰€æœ‰å†…å®¹è¯»å–</li>
<li>readlines: æŒ‰è¡Œè¯»å–å†…å®¹ï¼Œä½†æ˜¯åˆ—è¡¨å½“ä¸­çš„æ¯ä¸€é¡¹æœ€åéƒ½æœ‰ä¸€ä¸ª<code>\n</code>, readlineä¹Ÿæ˜¯ä¸€æ ·çš„ä¼šæœ‰ä¸€ä¸ª<code>\n</code>åœ¨è¯»å–çš„å­—ç¬¦ä¸²æœ€åã€‚</li>
</ul>
</li>
<li><p>å¤šæ¡ä»¶æ’åºï¼š</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ans=sorted(counts.items(), key=<span class="keyword">lambda</span> x:(-x[<span class="number">1</span>], x[<span class="number">0</span>]))</span><br><span class="line"><span class="comment"># æŒ‰ç…§valueé™åºï¼Œç„¶åå†æŒ‰ç…§keyå‡åºæ’åˆ—</span></span><br></pre></td></tr></table></figure>
<h4 id="chapter8"><a href="#chapter8" class="headerlink" title="chapter8"></a>chapter8</h4><ul>
<li><p>ä¸€åˆ‡å†…å®¹çš†æ˜¯å¯¹è±¡ï¼Œå‡½æ•°å’Œç±»ä¹Ÿæ˜¯å¯¹è±¡ã€‚</p>
</li>
<li><p>ç±»ä¸»è¦æŒ‡çš„æ˜¯ç±»å‹ï¼Œå¯¹è±¡æ˜¯æ¯”è¾ƒå…·ä½“çš„ä¸€äº›å€¼ã€‚lst = [1, 2, 3], å…¶ä¸­listæ˜¯å¯¹è±¡lstçš„classï¼Œä¹Ÿå°±æ˜¯listç±»å‹çš„å¯¹è±¡</p>
</li>
<li><p>ç±»æœ‰è‡ªå·±çš„åå­—ç©ºé—´ï¼ŒåŒæ—¶æ¯ä¸ªå¯¹è±¡ä¹Ÿæœ‰è‡ªå·±çš„åå­—ç©ºé—´ã€‚</p>
</li>
<li><p>æ„é€ æ–¹æ³•ï¼š<code>def __init__(self, â€¦)</code> æ„é€ æ–¹æ³•ï¼Œå½“å¯¹è±¡è¢«æ„é€ çš„æ—¶å€™è¢«è‡ªåŠ¨è°ƒç”¨ï¼Œå¯ä»¥å£°æ˜ç±»æ‰€äº§ç”Ÿçš„å¯¹è±¡å±æ€§ï¼Œå¹¶å¯ä¸ºå…¶èµ‹åˆå§‹å€¼ï¼Œæœ€é‡è¦çš„æ˜¯è¿™ä¸ªå‡½æ•°æ˜¯<strong>ä¸èƒ½æœ‰è¿”å›å€¼</strong>çš„ã€‚-&gt; åˆ›å»ºå¯¹è±¡çš„æ—¶å€™è°ƒç”¨çš„æ˜¯<code>object</code>æœ¬èº«çš„<code>__init__</code>æ–¹æ³•ã€‚</p>
</li>
<li><p>selfå‚æ•°ï¼šå¿…é¡»ä¸ºç¬¬ä¸€ä¸ªå½¢å‚ï¼Œä»£è¡¨çš„æ˜¯å°†æ¥è¦åˆ›å»ºçš„å¯¹è±¡æœ¬èº«ã€‚åœ¨ç±»çš„æ–¹æ³•å½“ä¸­è®¿é—®æ•°æ®æˆå‘˜çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨self.parameterè¿›è¡Œè°ƒç”¨ã€‚åœ¨å¤–éƒ¨é€šè¿‡å¯¹è±¡è°ƒç”¨å®ä¾‹æ–¹æ³•çš„æ—¶å€™ä¸éœ€è¦ä¼ é€’selfå‚æ•°ï¼Œå¦‚æœåœ¨å¤–éƒ¨é€šè¿‡ç±»æ¥è°ƒç”¨å®ä¾‹æ–¹æ³•çš„æ—¶å€™ï¼Œå¯ä»¥æ˜¾å¼çš„æŠŠå¯¹è±¡ä¼ åˆ°selfé‡Œé¢ã€‚</p>
</li>
<li><p>pythonç¤¾å›¢è§„å®šï¼š</p>
<ul>
<li>_xxx å†…éƒ¨åï¼Œä¸åº”è¯¥åœ¨å¤–éƒ¨ä½¿ç”¨</li>
<li><code>__xxx</code> pyè§£é‡Šå™¨ä¼šè‡ªåŠ¨æ¢åä¸º<code>_class__xxx</code>ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æˆå‘˜å˜é‡å’Œç±»å˜é‡éƒ½ä¼šè‡ªåŠ¨æ¢åï¼Œæ‰€ä»¥å¯¹è±¡æ˜¯ç›´æ¥è®¿é—®ä¸åˆ°è¿™ä¸ªå˜é‡çš„.ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯ä»¥ä½¿ç”¨<code>object._class__xxx</code>è®¿é—®åˆ°è¯¥å˜é‡ï¼Œæ‰€ä»¥å¹¶ä¸æ˜¯ç»å¯¹æ„ä¹‰ä¸Šçš„ç§æœ‰å˜é‡ã€‚</li>
<li><code>__xxx__</code>ç³»ç»Ÿå®šä¹‰çš„ç‰¹æ®Šæˆå‘˜ï¼Œä¸€èˆ¬ä¸ä½¿ç”¨è¿™ç§æ ‡è¯†ç¬¦ã€‚</li>
<li>ç±»å˜é‡å’Œå®ä¾‹å˜é‡éƒ½æ˜¯å¯ä»¥<code>åŠ¨æ€å¢åŠ å¯¹åº”çš„å˜é‡çš„</code>.</li>
</ul>
</li>
<li><p>ç»§æ‰¿çš„ç±»å¦‚æœé‡å†™äº†<code>__init__</code>, å¦‚æœè¦åˆå§‹åŒ–çˆ¶ç±»éœ€è¦æ˜¾å¼çš„<code>super().__init__</code>è°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–å‡½æ•°ã€‚</p>
</li>
<li><p>pythonå¤šæ€ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡é‡å†™<code>__add__, __len__, __sub__</code>ä¹‹ç±»çš„å‡½æ•°æ¥è‡ªå®šä¹‰è‡ªå·±çš„åŸºæœ¬è¿ç®—ã€‚</p>
</li>
</ul>
<hr>
<h3 id="é¢˜ç›®è§£æ"><a href="#é¢˜ç›®è§£æ" class="headerlink" title="é¢˜ç›®è§£æ"></a>é¢˜ç›®è§£æ</h3><ol>
<li><p>pythonå½“ä¸­æµ®ç‚¹æ•°æ˜¯<code>float</code>ç±»å‹ï¼Œå¹¶æ²¡æœ‰<code>double</code>å‹ç±»å‹ã€‚</p>
</li>
<li><p><code>round(x, 2)</code>è¡¨ç¤ºçš„æ˜¯ä¿ç•™ä¸¤ä½å°æ•°çš„å››èˆäº”å…¥æ³•ã€‚<code>round(18.67, 1) = 18.7, round(18.67, -1) = 20.0, round(18.67, 0) = 19.0, floor(), ceil(), int(&quot;20&quot;, 16) = 32</code>.</p>
</li>
<li><p>é€»è¾‘å€¼<code>not, or, and</code>å¦‚æœæœ‰å¤šä¸ªåˆ™æ˜¯ä¸€æ­¥ä¸€æ­¥çš„åˆ¤æ–­è¿‡å»çš„ã€‚ä»å·¦åˆ°å³çš„direction, å°±æ˜¯è¯´oræˆ–è€…andå·¦å³ä¸¤è¾¹éƒ½è¦æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼.</p>
</li>
<li><p><code>math.sin(x)</code>å…¶ä¸­xæ˜¯å¼§åº¦åˆ¶è¡¨ç¤ºçš„ï¼Œæ‰€ä»¥ç”¨è§’åº¦å€¼éœ€è¦è¿›è¡Œç›¸å¯¹åº”çš„åˆ¶åº¦è½¬æ¢.</p>
</li>
<li><p><code>0 and anything</code>çš„ç»“æœéƒ½æ˜¯0ï¼Œå…¶ä»–çš„<code>value1 and value2</code>ç»“æœè¡¨è¾¾å¼éƒ½æ˜¯value2.</p>
</li>
<li><p><code>list</code>åªæœ‰<code>index</code>æ–¹æ³•ï¼Œå¯¹äºå­—ç¬¦ä¸²è€Œè¨€æ˜¯æœ‰<code>index</code>å’Œ<code>find</code>ä¸¤ç§æ–¹æ³•çš„ã€‚å…¶ä¸­<code>find</code>æ²¡æ‰¾åˆ°æ˜¯è¿”å›<code>-1</code>, <code>index</code>æ²¡æ‰¾åˆ°çš„è¯ç›´æ¥æ˜¯æŠ¥é”™ã€‚</p>
</li>
<li><p>listçš„<code>pop(index)</code>æŒ‰ç…§indexï¼Œé»˜è®¤æ˜¯popåˆ—è¡¨çš„æœ€åä¸€ä¸ªå€¼ã€‚<code>remove(value)</code>æ˜¯æŒ‰ç…§valueæ¥removeçš„.</p>
</li>
<li><p>æµ®ç‚¹æ•°çš„ç›¸ç­‰æ˜¯çœ‹å†…éƒ¨çš„æµ®ç‚¹æ•°è¡¨ç¤ºï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªå˜é‡å¼•ç”¨åŒä¸€ä¸ªå¸¸é‡æµ®ç‚¹æ•°çš„è¯ï¼Œç›¸ç­‰æ˜¯Trueï¼Œå› ä¸ºæœ¬èº«å°±æ˜¯åŒä¸€ä¸ªå¸¸é‡å¼•ç”¨<code>x = 2.0;y=2.0 (x==y) = True</code>. ä½†æ˜¯å¦‚æœæ¶‰åŠåˆ°æµ®ç‚¹æ•°çš„è¿ç®—çš„æ—¶å€™éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼Œä¸€èˆ¬æ¥è¯´è¡¨ç¤ºæ–¹å¼å°±æœ‰å˜åŒ–ï¼Œæ‰€ä»¥å¾ˆå¤§æ¦‚ç‡å¹¶ä¸æ˜¯ä¸€ä¸ªå€¼äº†ã€‚å¹¶ä¸”<code>ä½ç²¾åº¦åœ¨å’Œé«˜ç²¾åº¦æ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨è½¬æ¢åˆ°é«˜ç²¾åº¦</code>.</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x=<span class="number">2</span>;y=<span class="number">2.0</span>   <span class="comment">#åˆ†å·å¯æŠŠä¸¤ä¸ªè¯­å¥å†™åœ¨ä¸€è¡Œ</span></span><br><span class="line"><span class="keyword">if</span>(x == y):</span><br><span class="line">   print(<span class="string">"ç›¸ç­‰"</span>) <span class="comment"># correct answer</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">   print(<span class="string">"ä¸ç›¸ç­‰"</span>)</span><br></pre></td></tr></table></figure>
<ol>
<li>åŒé‡å¾ªç¯listçš„ğŸŒ°ï¼š</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">l3=[[(i,j) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">6</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">6</span>)]</span><br><span class="line">print(l3[<span class="number">2</span>][<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¶ä¸­jè´Ÿè´£å¤–å±‚çš„åˆ›å»ºæ–°åˆ—è¡¨ï¼Œiè´Ÿè´£å†…å±‚å’Œjä¸€åŒç”Ÿæˆå…ƒç»„å€¼ï¼Œ</span></span><br><span class="line"><span class="comment"># [[(1, 1), (2, 1)...], [(1, 2), (2, 2)...]]</span></span><br><span class="line"><span class="comment"># ç„¶åæ ¹æ®å¯¹åº”å…³ç³»æ¥æ‰¾å€¼å³å¯</span></span><br></pre></td></tr></table></figure>
<ol>
<li><p><code>ä»¥åªå†™æ¨¡å¼</code>æ‰“å¼€çš„æ–‡ä»¶ä¸èƒ½è¿›è¡Œå†™æ“ä½œï¼Œä½†æ˜¯ä»¥<code>å†™æ¨¡å¼</code>æ‰“å¼€çš„æ–‡ä»¶æœ‰å¯èƒ½å¯ä»¥è¿›è¡Œå†™æ“ä½œã€‚</p>
</li>
<li><p>åœ¨pythonå½“ä¸­<code>å˜é‡ä¸éœ€äº‹å…ˆå£°æ˜å°±å¯ä½¿ç”¨ã€‚</code></p>
</li>
<li><p>æ³¨æ„åˆ¤æ–­æ¡ä»¶ï¼š</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> number%<span class="number">2</span> <span class="keyword">and</span> <span class="keyword">not</span> number%<span class="number">3</span>:</span><br><span class="line"><span class="comment"># ä»£è¡¨çš„æ˜¯numberä¸æ˜¯2çš„å€æ•°ï¼Œä½†æ˜¯æ˜¯3çš„å€æ•°</span></span><br><span class="line"></span><br><span class="line">b=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">b[<span class="number">2</span>]=b</span><br><span class="line"><span class="comment"># è¿™ç§æƒ…å†µä¸‹æ˜¯æ— é™å¾ªç¯çš„æƒ…å†µ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> v &lt; values[row][column]:</span><br><span class="line">    v = values[row][column]</span><br><span class="line"><span class="comment"># æ³¨æ„æ±‚çš„æ˜¯æœ€å¤§å€¼ï¼Œè€Œä¸æ˜¯æœ€å°å€¼</span></span><br></pre></td></tr></table></figure>
<ol>
<li>ğŸ’ç»å…¸é¢˜ï¼š</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = int(input().strip())</span><br><span class="line">ls = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n + <span class="number">1</span>)]</span><br><span class="line">index = <span class="number">-1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> len(ls) &gt; <span class="number">1</span>:</span><br><span class="line">    index = (index + <span class="number">3</span>) % len(ls)</span><br><span class="line">    <span class="keyword">del</span> ls[index]</span><br><span class="line">    index -= <span class="number">1</span> <span class="comment"># æ³¨æ„è¿™é‡Œè¦æŠŠindex-1</span></span><br><span class="line"></span><br><span class="line">print(ls[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>
<ol>
<li><p>åœ¨ä¸‰å¼•å·çš„å­—ç¬¦ä¸²ä¸­å¯ä»¥åŒ…å«å•å¼•å·ï¼ŒåŒå¼•å·å­—ç¬¦. ä¸è¿‡åœ¨å•ç‹¬çš„å•åŒå¼•å·çš„æ—¶å€™ï¼Œéœ€è¦è€ƒè™‘è½¬ä¹‰æˆ–è€…å•å¼•å·åˆ©ç”¨åŒå¼•å·è¿™ç§ä¸åŒçš„è¡¨ç¤ºå½¢å¼ã€‚</p>
</li>
<li><p>æ³¨æ„åœ¨å¤šå˜é‡èµ‹å€¼çš„æ—¶å€™,<code>x = y = z + 1</code>æ˜¯ä¸ä¼šå‡ºé”™çš„ï¼Œä½†æ˜¯<code>x = (y = z + 1)</code>æ˜¯å‡ºé”™çš„ï¼Œå› ä¸ºpythonè‡ªåŠ¨å°†<code>y = z + 1</code>ä½œä¸ºä¸€ä¸ªè¡¨è¾¾å¼å¤„ç†ï¼Œä½†æ˜¯åˆæ²¡æœ‰è¿”å›å€¼ï¼Œæ‰€ä»¥å‡ºé”™ï¼ï¼</p>
</li>
<li><p>listçš„<code>sort</code>æ–¹æ³•æ˜¯æ²¡æœ‰è¿”å›å€¼çš„ã€‚</p>
</li>
</ol>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>basis</tag>
      </tags>
  </entry>
  <entry>
    <title>Old Books Trading Website</title>
    <url>/2019/06/22/Website/</url>
    <content><![CDATA[<p>&nbsp;&nbsp;&nbsp;&nbsp;é™†é™†ç»­ç»­å†™äº†å¤§æ¦‚ä¸¤å‘¨æ—¶é—´çš„æ—§ä¹¦äº¤æ˜“ç½‘ç«™ç»ˆäºå¿«å†™å®Œå•¦ï¼ï¼BSè¯¾ç¨‹çš„è¯¾ç¨‹é¡¹ç›®è®¾è®¡ï¼ŒçœŸæ˜¯å¿ƒåŠ›äº¤ç˜ã€‚åˆšå¥½æ–°æäº†ä¸€ä¸ªåšå®¢è¯•è¯•æ°´ï¼Œå°±åœ¨è¿™é‡Œè®°å½•ä¸€äº›å¼€å‘è¿‡ç¨‹å½“ä¸­çš„æ„Ÿæƒ³å’Œç¢°åˆ°çš„å¾ˆå¤šå¾ˆå¤šå‘å§orzï¼Œä¸è¿‡è¿˜æ˜¯å­¦åˆ°å¾ˆå¤šä¸œè¥¿çš„å–ï¼<br><a id="more"></a></p>
<h3 id="åç«¯æ¡†æ¶"><a href="#åç«¯æ¡†æ¶" class="headerlink" title="åç«¯æ¡†æ¶"></a>åç«¯æ¡†æ¶</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;åç«¯æ¡†æ¶é€‰ç”¨çš„æ˜¯<code>Django</code>æ¡†æ¶å¼€å‘çš„ï¼Œä¸ºä»€ä¹ˆé€‰<code>Python</code>ä½œä¸ºåç«¯çš„è¯­è¨€å‘¢ï¼Œä¸€æ–¹é¢æ˜¯è¿™å­¦æœŸåˆšå¥½ä¹Ÿæœ‰åœ¨ä¸Špythonè¯¾ç¨‹ï¼Œå¦ä¸€æ–¹é¢pythonçœŸçš„å¾ˆå‹å¥½å•Šï¼Œä¸è¿‡ä»¥åä¹Ÿè¦å°è¯•ç”¨<code>java spring</code>åšç‚¹å°é¡¹ç›®ã€‚</p>
<h4 id="Djangoè·¯ç”±"><a href="#Djangoè·¯ç”±" class="headerlink" title="Djangoè·¯ç”±"></a>Djangoè·¯ç”±</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;<code>Django</code>æ¡†æ¶éµå¾ªçš„æ˜¯<code>MVC</code>çš„æ€æƒ³è¿›è¡Œå¼€å‘çš„æ¡†æ¶ã€‚<code>urls.py</code>å½“ä¸­æ˜¯ç½‘ç«™è·¯ç”±çš„é…ç½®ï¼Œä¸€èˆ¬é¡¹ç›®çš„è·¯ç”±å½“ä¸­æ˜¯åˆ’å®šä¸åŒappä¸‹çš„èµ·å§‹è·¯ç”±ï¼Œç„¶ååœ¨ä¸åŒçš„appä¸‹å†å®šä¹‰å„è‡ªçš„urlï¼Œä½¿å¾—æ•´ä¸ªé¡¹ç›®çš„è·¯ç”±ç®¡ç†æ¯”è¾ƒç‹¬ç«‹ï¼Œæ¯”å¦‚åœ¨æˆ‘é¡¹ç›®å½“ä¸­çš„æ€»è·¯ç”±é…ç½®(BookTradeWeb/urls.py):<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'admin/'</span>, admin.site.urls),</span><br><span class="line">    url(<span class="string">r'^password-reset/'</span>, include(<span class="string">'password_reset.urls'</span>)),</span><br><span class="line">    url(<span class="string">r'^auth/'</span>, include(<span class="string">'useraction.urls'</span>)),</span><br><span class="line">    url(<span class="string">r'^books/'</span>, include(<span class="string">'books.urls'</span>)),</span><br><span class="line">    url(<span class="string">r'^chatting/'</span>, include(<span class="string">'chatting.urls'</span>)),</span><br><span class="line">    url(<span class="string">r'^media/(?P&lt;path&gt;.*)$'</span>, serve, &#123;<span class="string">'document_root'</span>: settings.MEDIA_ROOT&#125;),</span><br><span class="line">    url(<span class="string">r'^$'</span>, TemplateView.as_view(template_name=<span class="string">"login.html"</span>)),</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;ç„¶ååœ¨æ¯ä¸ªå•ç‹¬çš„appé‡Œé¢å¯ä»¥è‡ªå®šä¹‰è‡ªå·±çš„è·¯ç”±äº†ï¼Œä»¥æˆ‘å…¶ä¸­ä¸€ä¸ªapp(useraction)ä¸‹çš„urls.pyä¸ºğŸŒ°ï¼Œä¸è¿‡éœ€è¦è®°ä½çš„æ˜¯é€šè¿‡<code>python manage.py startapp</code> åˆ›å»ºä¹‹åçš„urls.pyæ˜¯éœ€è¦è‡ªå·±åˆ›å»ºçš„ã€‚åœ¨ä¸åŒçš„appé‡Œé¢å¯ä»¥å®šä¹‰è‡ªå·±çš„<code>app_name</code>ï¼Œåœ¨åé¢å†™æ¨¡æ¿è¯­è¨€çš„æ—¶å€™éå¸¸çˆ½çš„ï¼Œåé¢åœ¨å‰ç«¯é‚£é‡Œå†è¯¦ç»†å†™ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">app_name = <span class="string">'useraction'</span></span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(<span class="string">r'^login/$'</span>, views.UserLoginView.as_view(), name=<span class="string">'login'</span>),</span><br><span class="line">    url(<span class="string">r'^register/$'</span>, views.UserRegisterView.as_view(), name=<span class="string">'register'</span>),</span><br><span class="line">    url(<span class="string">r'^logout/$'</span>, views.UserLogoutView.as_view(), name=<span class="string">'logout'</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h4 id="Django-Views"><a href="#Django-Views" class="headerlink" title="Django Views"></a>Django Views</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;Django viewså¯ä»¥è¯´æ˜¯å¾ˆå¼ºå¤§äº†ï¼Œåœ¨<code>MVC</code>æ¶æ„å½“ä¸­å®ƒå¯ä»¥å……å½“viewå’Œcontrollerä¸¤éƒ¨åˆ†çš„è§’è‰²ã€‚ç°åœ¨å¾ˆæµè¡Œä½¿ç”¨<code>restful</code>çš„æ–¹å¼å¼€å‘ç½‘ç«™ã€‚ä¹Ÿå³åç«¯åªæä¾›æ•°æ®ï¼Œç”¨<code>json</code>æˆ–è€…<code>protobuf</code>æˆ–è€…å…¶ä»–çš„æ•°æ®ç»„ç»‡å½¢å¼æ¥ä¼ è¾“æ•°æ®ï¼Œè€Œå‰ç«¯å‘åç«¯å‘é€è¯·æ±‚æ¥è¯·æ±‚æ•°æ®æˆ–è€…å¤„ç†é€»è¾‘ï¼Œå®ç°<code>å‰åç«¯åˆ†ç¦»</code>çš„å¼€å‘ã€‚<br>&nbsp;&nbsp;&nbsp;&nbsp;Django viewså› ä¸ºæœ‰å¾ˆå¤šDjangoè‡ªå·±çš„åŠ æŒï¼Œä½¿å¾—è¿™ä¸¤ç§æ¨¡å¼éƒ½æ”¯æŒï¼Œæ¯”å¦‚<code>JsonResponse</code>è¿”å›jsonæ ¼å¼çš„æ•°æ®ï¼Œæˆ–è€…é€šè¿‡<code>render(request, index.html, data)</code>çš„æ–¹å¼ç›´æ¥è¿”å›ç½‘é¡µï¼Œå¹¶ä¸”èƒ½ç”¨éå¸¸çˆ½çš„æ¨¡æ¿è¯­è¨€ï¼Œç®€ç›´äººè§äººçˆ±å•Šæœ‰æœ¨æœ‰ï¼<br>&nbsp;&nbsp;&nbsp;&nbsp;è¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯ç”¨çš„<code>class-based view</code>çš„æ–¹å¼æ¥å†™views.pyçš„ï¼Œåœ¨<code>BookTradeWeb/utils.py</code>å½“ä¸­å®šä¹‰äº†<code>BaseView</code>ï¼Œè¿™ä¸ªç±»ç»§æ‰¿äº†Djangoå½“ä¸­å†…ç½®çš„viewï¼Œåé¢æˆ‘ä»¬è‡ªå·±çš„viewåªéœ€è¦ç»§æ‰¿BaseViewå³å¯ï¼Œæˆ‘ä»¬çœ‹çœ‹BaseViewé‡Œé¢å®šä¹‰äº†äº›å•¥ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaseView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dispatch</span><span class="params">(self, request, *args, **kwargs)</span>:</span></span><br><span class="line">        self.request = request</span><br><span class="line">        request.data = &#123;&#125;</span><br><span class="line">        <span class="keyword">if</span> request.method == <span class="string">'GET'</span>:</span><br><span class="line">            request.data = request.GET.dict()</span><br><span class="line">        <span class="keyword">elif</span> request.content_type == <span class="string">'application/json'</span>:</span><br><span class="line">            request.data = request.body.replace(<span class="string">b"'"</span>, <span class="string">b'"'</span>)</span><br><span class="line">            request.data = json.loads(request.data)</span><br><span class="line">        <span class="keyword">elif</span> request.content_type == <span class="string">'multipart/form-data'</span>:</span><br><span class="line">            request.data = request.POST.dict()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> request.FILES == <span class="literal">None</span>:</span><br><span class="line">                request.data[<span class="string">'file'</span>] = request.FILES[<span class="string">'file'</span>]</span><br><span class="line">        <span class="keyword">elif</span> request.content_type == <span class="string">'application/x-www-form-urlencoded'</span>:</span><br><span class="line">            request.data = request.POST.dict()</span><br><span class="line">        <span class="keyword">return</span> self.do_dispatch(request, *args, **kwargs)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">do_dispatch</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        handler = getattr(self, self.request.method.lower(), <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> callable(handler):</span><br><span class="line">            <span class="keyword">return</span> JsonResponse(make_errors(<span class="string">f"http method <span class="subst">&#123;self.request.method.lower()&#125;</span> not allowed "</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                data = handler(*args, **kwargs)</span><br><span class="line">                <span class="keyword">if</span> data == <span class="literal">None</span>:</span><br><span class="line">                    <span class="keyword">return</span> JsonResponse(make_success(<span class="string">'success'</span>))</span><br><span class="line">                <span class="keyword">elif</span> self.request.method == <span class="string">'GET'</span> <span class="keyword">or</span> <span class="keyword">not</span> isinstance(data, dict):</span><br><span class="line">                    <span class="keyword">return</span> data</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">return</span> JsonResponse(&#123;<span class="string">'data'</span>: data, <span class="string">'code'</span>: <span class="number">0</span>&#125;)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                traceback.print_exc()</span><br><span class="line">                <span class="keyword">return</span> JsonResponse(make_errors(str(e)))</span><br></pre></td></tr></table></figure></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;è¿™æ ·å®šä¹‰BaseViewæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Œé¦–å…ˆåœ¨BaseViewé‡Œé¢é‡å†™äº†Viewå½“ä¸­çš„<code>dispatch</code>æ–¹æ³•ï¼Œæ¯å½“æœ‰ä¸€ä¸ªè¯·æ±‚åˆ°è¾¾å¯¹åº”è·¯ç”±é‚£é‡Œçš„æ—¶å€™ï¼Œéƒ½ä¼šè°ƒç”¨dispatchæ–¹æ³•ã€‚åœ¨dispatchå½“ä¸­æˆ‘ä»¬å°†æ•°æ®ç»Ÿä¸€éƒ½æ”¾åˆ°<code>request.data</code>é‡Œé¢ï¼Œåé¢çš„viewså½“ä¸­æ— è®ºæ˜¯<code>POST</code>è¿˜æ˜¯<code>GET</code>éƒ½å¯ä»¥åœ¨request.dataé‡Œé¢æ‹¿åˆ°æ•°æ®ã€‚<br>&nbsp;&nbsp;&nbsp;&nbsp;å…¶æ¬¡åœ¨do_dispatchå½“ä¸­ä¼šå»è‡ªå®šä¹‰viewé‡Œé¢æ‰¾å¯¹åº”request methodçš„å¤„ç†æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çš„è‡ªå®šä¹‰viewé‡Œé¢åªéœ€è¦å»å†™å¯¹åº”çš„å‡½æ•°ï¼Œæ¯”å¦‚è¯´<code>def get(self, request)</code> å¤„ç†getè¯·æ±‚ï¼Œ<code>def post(self, request)</code>æ¥å¤„ç†å¯¹åº”çš„postè¯·æ±‚ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿å‘¢ï¼åœ¨è‡ªå®šä¹‰viewå†™å®Œä¹‹åï¼Œåªéœ€è¦åœ¨urls.pyé‡Œé¢å»æ³¨å†Œä¸€ä¸‹å°±å¥½äº†ï¼Œä¸‹é¢ä¸¾ä¸€ä¸ªğŸŒ°ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserLoginView</span><span class="params">(BaseView)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        user = authenticate(username = request.data.get(<span class="string">'username'</span>),</span><br><span class="line">                            password = request.data.get(<span class="string">'password'</span>))</span><br><span class="line">        <span class="keyword">if</span> user <span class="keyword">and</span> user.is_active:</span><br><span class="line">            login(request, user)</span><br><span class="line">            <span class="keyword">return</span> user.to_dict()</span><br><span class="line">        <span class="keyword">elif</span> <span class="keyword">not</span> user:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">'login.html'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">useraction/urls.py</span><br><span class="line">url(<span class="string">r'^login/$'</span>, views.UserLoginView.as_view(), name=<span class="string">'login'</span>)</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h4 id="Django-models"><a href="#Django-models" class="headerlink" title="Django models"></a>Django models</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;Djangoæä¾›äº†ä¸€å¥—éå¸¸å®Œå¤‡çš„<code>ORM</code>ï¼Œä»¥è‡³äºæˆ‘çœŸçš„ä¸€è¡ŒSQLè¯­å¥éƒ½æ²¡å†™å•ŠğŸ˜‚ã€‚modelsä¹Ÿå°±æ˜¯æ•°æ®åº“é‡Œé¢çš„è¡¨ï¼Œé€šè¿‡ç±»å®šä¹‰çš„æ–¹å¼æ¥å®šä¹‰æ¯ä¸€å¼ è¡¨å½“ä¸­çš„æ•°æ®é¡¹ã€å±æ€§ã€å¤–é”®çº¦æŸç­‰ç­‰ã€‚ä¸€èˆ¬å®šä¹‰å¥½modelsä¹‹ååªéœ€è¦æ‰§è¡Œ<code>python manage.py makemigrations &amp;&amp; python manage.py migrate</code>å°†modelsè¿ç§»åˆ°æ•°æ®åº“å½“ä¸­ã€‚Djangoé¡¹ç›®åˆå§‹é»˜è®¤ä½¿ç”¨çš„æ•°æ®åº“æ˜¯<code>sqlite</code>ï¼Œæˆ‘è¿™é‡Œå°†å®ƒæ”¹æˆäº†<code>MySQL</code>ï¼Œå…·ä½“å°±æ˜¯ä¿®æ”¹setting.pyé‡Œé¢çš„é…ç½®å°±å¥½äº†ã€‚<br>&nbsp;&nbsp;&nbsp;&nbsp;ORMçš„è¯­æ³•ç½‘ä¸Šæ•™ç¨‹æˆ–è€…æ˜¯<a href="https://docs.djangoproject.com/zh-hans/2.2/" target="_blank" rel="noopener">Djangoå®˜ç½‘æ•™ç¨‹</a>éƒ½æœ‰å¾ˆå¤šçš„ã€‚ä¸»è¦å°±æ˜¯å†…éƒ¨ç”¨çš„ä¸€ä¸ª<code>QuerySet</code>ç±»æ¥ä»£è¡¨è¿”å›ç»“æœï¼Œè¿˜æœ‰å¾ˆå¤šå¥‡å¥‡æ€ªæ€ªçš„ç”¨æ³•è¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚</p>
<p><br></p>
<h4 id="Django-setting"><a href="#Django-setting" class="headerlink" title="Django setting"></a>Django setting</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;Django é€šè¿‡åœ¨é¡¹ç›®ç›®å½•ä¸‹çš„setting.pyä¸‹é¢è¿›è¡Œæ•´ä¸ªé¡¹ç›®çš„é…ç½®ï¼Œå¤§æ¦‚è®²è§£ä¸€ä¸‹è¿™äº›é…ç½®æ˜¯å¹²å•¥çš„ï¼Œå°±è®²ä¸€äº›ä¸»è¦çš„ï¼Œå…¶ä»–çš„éƒ½æ˜¯å¾ˆå®¹æ˜“<a href="http://www.google.com" target="_blank" rel="noopener">Google</a>åˆ°çš„ï¼š</p>
<ul>
<li><strong>ALLOWED_HOSTS</strong>: å…è®¸é‚£äº›hostè®¿é—®ï¼Œå¦‚æœéœ€è¦å…è®¸æ‰€æœ‰ä¸€èˆ¬è®¾ç½®ä¸º[â€˜*â€™, ]</li>
<li><strong>INSTALLED_APPS</strong>: è¿™ä¸ªé…ç½®æ˜¯æ¯”è¾ƒé‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æ¥æ³¨å†Œé¡¹ç›®é‡Œé¢çš„appï¼Œå¦‚æœä½ æ–°å»ºçš„appæ²¡æœ‰åœ¨è¿™é‡Œæ³¨å†Œçš„è¯ï¼Œé¡¹ç›®æ˜¯æ‰¾ä¸åˆ°ä½ çš„appé‡Œé¢çš„æ–¹æ³•çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯æ¬¡æ–°å»ºéƒ½éœ€è¦åœ¨è¿™é‡Œè¿›è¡Œæ³¨å†Œä¹‹åæ‰èƒ½æ­£å¸¸çš„å·¥ä½œå“¦ğŸ˜¯</li>
<li><strong>Middleware</strong>: è¿™é‡Œæ˜¯é¡¹ç›®ä¸­ä½¿ç”¨çš„ä¸­é—´ä»¶çš„é…ç½®ï¼Œæ¯”å¦‚Djangoå†…ç½®çš„ç”¨æˆ·è®¤è¯ä¸­é—´ä»·ï¼Œé˜²è·¨ç«™æ”»å‡»çš„csrftokenä¸­é—´ä»·ç­‰ç­‰ï¼Œå¦‚æœä½¿ç”¨å…¶ä»–çš„å¼€æºä¸­é—´ä»·éƒ½éœ€è¦åœ¨è¿™é‡Œè¿›è¡Œæ³¨å†Œã€‚</li>
<li><strong>TEMPLATES</strong>: è¿™é‡Œä¸»è¦æ˜¯å­˜æ”¾çš„é™æ€æ–‡ä»¶çš„æ„æ€ï¼ŒåŸºæœ¬ä¸ç”¨å»æ”¹ï¼ŒDjangoä¼šå»é¡¹ç›®æ‰€æœ‰çš„templatesæ–‡ä»¶å¤¹ä¸‹é¢æ‰¾å¯¹åº”çš„æ¨¡æ¿æ–‡ä»¶ã€‚</li>
<li><strong>DATABASES</strong>: é¡¾åæ€ä¹‰å°±æ˜¯æ•°æ®åº“çš„é…ç½®äº†ï¼Œä½ æƒ³ç”¨å“ªä¸ªæ•°æ®æ”¹æ”¹è¿™ä¸ªå°±å¥½äº†ã€‚</li>
<li><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">STATIC_URL = <span class="string">'/static/'</span></span><br><span class="line">  STATICFILES_DIRS = [</span><br><span class="line">      os.path.join(BASE_DIR, <span class="string">'BookTradeWeb/static'</span>)</span><br><span class="line">  ]</span><br><span class="line"></span><br><span class="line">  MEDIA_URL = <span class="string">'/media/'</span></span><br><span class="line">  MEDIA_ROOT = os.path.join(BASE_DIR, <span class="string">'media/'</span>)</span><br></pre></td></tr></table></figure>
è¿™ä¸¤ä¸ªæ˜¯é™æ€æ–‡ä»¶å’Œèµ„æºæ–‡ä»¶çš„å­˜æ”¾ä½ç½®ï¼ŒDjangoä¼šå»staticå’Œmediaæ–‡ä»¶å¤¹é‡Œé¢è‡ªåŠ¨å¯»æ‰¾ã€‚</li>
</ul>
<hr>
<h3 id="å‰ç«¯æ¨¡æ¿"><a href="#å‰ç«¯æ¨¡æ¿" class="headerlink" title="å‰ç«¯æ¨¡æ¿"></a>å‰ç«¯æ¨¡æ¿</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;å‰ç«¯è¿˜æ˜¯ä¸»è¦ç”¨çš„ä¼ ç»Ÿçš„<code>html+js+css</code>çš„æ ¼å¼ï¼Œç„¶åé€šè¿‡<code>ajax</code>å‘åç«¯å‘èµ·è¯·æ±‚ï¼Œæ²¡èƒ½ç”¨ç°åœ¨å¾ˆæµè¡Œçš„Reactæˆ–è€…æ˜¯Vueæœ‰ç‚¹å¯æƒœï¼Œåªèƒ½æ„Ÿæ…¨<code>å‰ç«¯å¤ªéš¾äº†ï¼ï¼</code>.ä¸è¿‡Djangoè‡ªå·±çš„æ¨¡æ¿è¯­è¨€ç”¨èµ·æ¥è¿˜æ˜¯å¯ä»¥çš„ï¼Œä¸è¿‡æˆ‘æ„Ÿè§‰è¿™ä¸ªé¡¹ç›®è°ƒå‰ç«¯çš„æ—¶é—´æ˜¯æœ€ä¸»è¦çš„å•Šorz.</p>
<h4 id="é™æ€æ–‡ä»¶åŠ è½½"><a href="#é™æ€æ–‡ä»¶åŠ è½½" class="headerlink" title="é™æ€æ–‡ä»¶åŠ è½½"></a>é™æ€æ–‡ä»¶åŠ è½½</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;ä¹‹å‰æˆ‘ä»¬åœ¨settingé‡Œé¢é…ç½®å¥½äº†staticæ–‡ä»¶ç›®å½•ä¹‹åï¼Œåœ¨æ¨¡æ¿é‡Œé¢æˆ‘ä»¬å¯ä»¥è¿™æ ·å¼•å…¥ï¼Œåœ¨æœ€å¼€å¤´é€šè¿‡<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;% load staticfiles %&#125; åŠ è½½é™æ€æ–‡ä»¶</span><br><span class="line">&#123;% static <span class="string">'images/favicon.png'</span> %&#125; å¼•å…¥å¯¹åº”æ–‡ä»¶</span><br></pre></td></tr></table></figure><br>&nbsp;&nbsp;&nbsp;&nbsp;æ³¨æ„Djangoä¼šæœç´¢æ‰€æœ‰çš„staticæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼Œæ‰€ä»¥ä¸€èˆ¬ä½¿ç”¨appåç§°ä½œä¸ºå‰ç¼€æ¥è¿›è¡ŒåŒºåˆ†ã€‚</p>
<h4 id="å‰ç«¯è·¯ç”±"><a href="#å‰ç«¯è·¯ç”±" class="headerlink" title="å‰ç«¯è·¯ç”±"></a>å‰ç«¯è·¯ç”±</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;åœ¨ä¹‹å‰æˆ‘ä»¬æåˆ°æ¯ä¸ªurls.pyé‡Œé¢æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ª<code>app_name</code>å­—æ®µï¼Œå¹¶ä¸”æ¯ä¸ªurl_patterné‡Œé¢éƒ½å¯ä»¥å¸¦ä¸Šä¸€ä¸ª<code>name</code>å­—æ®µï¼Œç„¶ååœ¨å‰ç«¯å°±å¯ä»¥ç›´æ¥ç”¨æ¨¡æ¿è¯­è¨€å½“ä¸­çš„<code>url &#39;app_name:name&#39;</code>æ¥è·å–åç«¯å®šä¹‰å¥½çš„è·¯ç”±ï¼Œè¿™æ ·å°±ç®—ä½ åç«¯æ”¹äº†è·¯ç”±ä¹‹åï¼Œå‰ç«¯æ ¹æœ¬ä¸ç”¨ç®¡å•Šæ˜¯ä¸æ˜¯ï½<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">useraction/urls.py</span><br><span class="line">app_name = <span class="string">'useraction'</span></span><br><span class="line">url(<span class="string">r'^register/$'</span>, views.UserRegisterView.as_view(),name=<span class="string">'register'</span>)</span><br><span class="line"></span><br><span class="line">template:</span><br><span class="line">&#123;% url <span class="string">'useraction:register'</span> %&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="å‰ç«¯æ•°æ®æ¸²æŸ“"><a href="#å‰ç«¯æ•°æ®æ¸²æŸ“" class="headerlink" title="å‰ç«¯æ•°æ®æ¸²æŸ“"></a>å‰ç«¯æ•°æ®æ¸²æŸ“</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯é€šè¿‡ajaxå‘åç«¯è¯·æ±‚ï¼Œç„¶åç”¨jsæ¥è¿›è¡Œæ•°æ®æ¸²æŸ“ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯é€šè¿‡æ¨¡æ¿è¯­è¨€ï¼Œåœ¨<code>render</code>æ–¹æ³•çš„æ—¶å€™å°†æ•°æ®ä¼ é€’åˆ°æ¨¡æ¿é‡Œé¢ï¼Œç„¶åä½¿ç”¨æ¨¡æ¿è¯­è¨€æ¸²æŸ“ï¼Œå¸¸ç”¨çš„æœ‰ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;&#123; data &#125;&#125; å–å‡ºä¼ é€’è¿›æ¥æ•°æ®å½“ä¸­çš„dataå­—æ®µ</span><br><span class="line"></span><br><span class="line">&#123;% <span class="keyword">if</span> ... %&#125;</span><br><span class="line">&#123;% <span class="keyword">else</span> %&#125;</span><br><span class="line">&#123;% endif %&#125; æ¨¡æ¿è¯­è¨€å½“ä¸­çš„<span class="keyword">if</span>è¯­å¥</span><br><span class="line"></span><br><span class="line">&#123;% <span class="keyword">for</span> book <span class="keyword">in</span> books %&#125;</span><br><span class="line">&#123;&#123; book.data &#125;&#125;</span><br><span class="line">&#123;% endfor %&#125; æ¨¡æ¿è¯­è¨€å½“ä¸­çš„<span class="keyword">for</span>è¯­å¥</span><br><span class="line"></span><br><span class="line">&#123;&#123; book.time|data:<span class="string">"Y-M-d"</span> &#125;&#125; æ¨¡æ¿è¯­è¨€å½“ä¸­çš„filterè¿‡æ»¤å™¨</span><br><span class="line"></span><br><span class="line">&#123;&#123; request.user &#125;&#125; æ¨¡æ¿å½“ä¸­è·å–å½“å‰è¯·æ±‚çš„user</span><br></pre></td></tr></table></figure><br>&nbsp;&nbsp;&nbsp;&nbsp;è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„ç”¨æ³•å¤§å®¶è‡ªå·±ç½‘ä¸Šæ‰¾æ‰¾ä¹Ÿèƒ½æ‰¾åˆ°ã€‚è¿™é‡Œä¸»è¦å°†è¿˜å¯ä»¥è‡ªå®šä¹‰è‡ªå·±çš„filterï¼Œä¸€ä¸ªå¾ˆç›´è§‚çš„éœ€æ±‚å°±æ˜¯æˆ‘åƒæ¨¡æ¿é‡Œé¢ä¼ è¿›äº†ä¸€ä¸ªå­—å…¸ï¼Œçªæ€ä¹ˆæ ¹æ®é”®æ¥æ‰¾å€¼å‘¢ï¼ŒDjangoæä¾›äº†è‡ªå®šä¹‰filterçš„åŠŸèƒ½ï¼Œåœ¨appç›®å½•ä¸‹é¢æ–°å»ºä¸€ä¸ª<code>templatetags</code>æ–‡ä»¶å¤¹ï¼Œé¦–å…ˆæ–°å»ºä¸€ä¸ª<code>__init__.py</code>ä¸ºç©ºä¸è¦ç´§ï¼Œä½†æ˜¯ä¸€å®šè¦æœ‰ã€‚ç„¶åå»ºä¸€ä¸ªè‡ªå®šä¹‰çš„filteræ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘æ˜¯<code>books_filter.py</code>ï¼Œé€šè¿‡<code>@register.filter</code>æ ‡æ³¨ä¸ºä¸€ä¸ªè‡ªå®šä¹‰çš„filterï¼Œç„¶åå°±å†™ä½ æƒ³è¦çš„filteré€»è¾‘å³å¯ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.template.defaulttags <span class="keyword">import</span> register</span><br><span class="line"><span class="keyword">from</span> BookTradeWeb.utils <span class="keyword">import</span> Category</span><br><span class="line"><span class="keyword">from</span> books.models <span class="keyword">import</span> Book</span><br><span class="line"></span><br><span class="line"><span class="meta">@register.filter</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetDictValue</span><span class="params">(dictionary, key)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span> isinstance(dictionary, dict)</span><br><span class="line">    <span class="keyword">return</span> dictionary.get(key)</span><br><span class="line"></span><br><span class="line">æ¨¡æ¿ä¸­ä½¿ç”¨ï¼š</span><br><span class="line">é¦–å…ˆæœ€ä¸Šæ–¹å¼•å…¥ä½ çš„filter &#123;% load books_filter %&#125;</span><br><span class="line">ç„¶åç”¨æ³•ï¼š&#123;&#123; book_dict|GetDictValue:key &#125;&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="Websocket"><a href="#Websocket" class="headerlink" title="Websocket"></a>Websocket</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;ç”±äºDjangoæœ¬èº«æ˜¯ä¸æ”¯æŒwebsocketçš„ï¼Œä½†æ˜¯è¿™æ¬¡è¦æ±‚è¦é›†æˆä¸€ä¸ªæ¶ˆæ¯ç³»ç»Ÿï¼Œæ‰€ä»¥æƒ³åˆ°çš„æ˜¯<code>websocket</code>è¿™ä¸ªå…¨åŒå·¥çš„åè®®ã€‚Googleäº†ä¸€ä¸‹ï¼Œå¯ä»¥é€šè¿‡<code>django-channels</code>ç¬¬ä¸‰æ–¹çš„packageæ¥å®ç°âœ…ï¼Œæ‰€ä»¥ç›´æ¥pipå®‰è£…å°±å¥½ã€‚<code>channels</code>æ˜¯ç”¨çš„<code>redis</code>åšæ¶ˆæ¯ç¼“å­˜ï¼Œæ‰€ä»¥è¿˜è¦<code>pip install channels-redis</code>ï¼Œè¿™äº›éœ€è¦çš„ä¾èµ–ä¸€èˆ¬éƒ½æ˜¯å†™åœ¨<code>requirements.txt</code>å½“ä¸­ã€‚å¦‚æœä¸æƒ³åœ¨æœ¬æœºå®‰è£…rediså¯ä»¥é€šè¿‡<code>docker</code>æ¥å¼€å¯æœåŠ¡ï¼Œå…·ä½“å°±æ˜¯å¼€ä¸€ä¸ªdocker containerå°±å¥½ï¼Œ<code>docker run -d -p 6379:6379 redis:latest</code>, æå®šã€‚<br>&nbsp;&nbsp;&nbsp;&nbsp;åœ¨settingé‡Œé¢æ³¨å†Œchannelsè¿™ä¸ªappï¼Œç„¶åæ·»åŠ å¦‚ä¸‹çš„è®¾ç½®:<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ASGI_APPLICATION = <span class="string">"BookTradeWeb.routing.application"</span></span><br><span class="line">CHANNEL_LAYERS = &#123;</span><br><span class="line">    <span class="string">'default'</span>: &#123;</span><br><span class="line">        <span class="string">'BACKEND'</span>: <span class="string">'channels_redis.core.RedisChannelLayer'</span>,</span><br><span class="line">        <span class="string">'CONFIG'</span>: &#123;</span><br><span class="line">            <span class="string">"hosts"</span>: [(CONFIGS[<span class="string">'REDIS_HOST'</span>], CONFIGS[<span class="string">'REDIS_PORT'</span>])],</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>&nbsp;&nbsp;&nbsp;&nbsp;asgié…ç½®ä¸»è¦æ˜¯ç”¨æ¥å¤„ç†websocketè¯·æ±‚çš„ï¼Œç±»ä¼¼<code>ws://</code>è¿™æ ·çš„è¯·æ±‚Djangoè‡ªå·±çš„æœåŠ¡å™¨æ˜¯å¤„ç†ä¸äº†çš„ï¼Œæ‰€ä»¥è¿™é‡Œç”¨asgié…ç½®ï¼Œéœ€è¦åœ¨appç›®å½•ä¸‹é¢æ–°å»ºä¸€ä¸ª<code>routing.py</code>ç”¨æ¥å¤„ç†websocketè·¯ç”±ã€‚<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">é¡¹ç›®ç›®å½•(BookTradeWeb/routing.py)</span><br><span class="line">application = ProtocolTypeRouter(&#123;</span><br><span class="line">    <span class="comment"># (http-&gt;django views is added by default)</span></span><br><span class="line">    <span class="string">'websocket'</span> : AuthMiddlewareStack(</span><br><span class="line">        URLRouter(</span><br><span class="line">            chatting.routing.websocket_urlpatterns</span><br><span class="line">        )</span><br><span class="line">    ),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">appç›®å½•ä¸‹(chatting/routing.py)</span><br><span class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> consumers</span><br><span class="line"></span><br><span class="line">websocket_urlpatterns = [</span><br><span class="line">    url(<span class="string">r'^ws/chat/(?P&lt;room_name&gt;[^/]+)/$'</span>, consumers.ChatConsumer),</span><br><span class="line">]</span><br></pre></td></tr></table></figure><br>&nbsp;&nbsp;&nbsp;&nbsp;ç»è¿‡è¿™æ ·ä¸€é€šé…ç½®ï¼Œå¼€å¯<code>python manage.py runserver</code>ï¼Œçœ‹åˆ°<code>ASGI/Channels</code>å°±é…ç½®æˆåŠŸäº†ã€‚</p>
<div align="center">
<img src="/2019/06/22/Website/server.png">
</div>


<h4 id="Consumer"><a href="#Consumer" class="headerlink" title="Consumer"></a>Consumer</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;åœ¨channelså½“ä¸­å¤„ç†websocketè¯·æ±‚çš„ä¸œè¥¿å«åšconsumerï¼Œå’Œä¸Šé¢æˆ‘ä»¬æåˆ°çš„viewä¸€æ ·ï¼Œconsumerä¹Ÿæ˜¯å¯ä»¥è‡ªå®šä¹‰çš„ï¼Œå¯ä»¥ç»§æ‰¿è‡ª<code>AsyncWebsocketConsumer</code>æ¥å®ç°è‡ªå·±çš„consumerã€‚ä¸»è¦æ˜¯å‡ ä¸ªfunctionsé‡å†™ä¸€ä¸‹å°±å¥½äº†ï¼Œ<code>connect</code>, <code>disconnect</code>, <code>receive</code>ï¼Œéƒ½æ˜¯å­—é¢æ„æ€äº†å°±ä¸è§£é‡Šäº†ã€‚æ¯ä¸€ä¸ªwebsocketè¿æ¥éƒ½ä¼šç»™åˆ°ä¸€ä¸ª<code>channel</code>ç»™è¿æ¥çš„ç”¨æˆ·ã€‚æ¯ä¸€ä¸ªchanneléƒ½æœ‰ä¸€ä¸ªç‹¬æœ‰çš„<code>channel_name</code>, é€šè¿‡<code>self.channel_name</code>å³å¯è·å–ã€‚</p>
<h4 id="Group"><a href="#Group" class="headerlink" title="Group"></a>Group</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;Groupç»„çš„æ¦‚å¿µï¼ŒèŠå¤©å®¤å¿…å¤‡å•Šã€‚groupä»¥group nameæ¥è¿›è¡ŒåŒºåˆ†ï¼Œä¸åŒçš„channeléƒ½å¯ä»¥åŠ å…¥åˆ°groupé‡Œé¢ï¼Œgroupå½“ä¸­æä¾›äº†<code>group_send</code>æ¥è¿›è¡Œå¹¿æ’­ğŸ“¢ï¼Œä¹Ÿå°±æ˜¯èŠå¤©å®¤çš„é‚£ç§æ•ˆæœäº†ã€‚</p>
<h4 id="channel-layer"><a href="#channel-layer" class="headerlink" title="channel_layer"></a>channel_layer</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;Django-channelså½“ä¸­æä¾›äº†get_channel_layer()æ–¹æ³•æ¥å‘æŒ‡å®šçš„channelå‘é€æ¶ˆæ¯ï¼Œå…·ä½“ä½¿ç”¨å¦‚ä¸‹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦çš„ç‚¹å¯¹ç‚¹èŠå¤©çš„åŠŸèƒ½äº†ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> channels.generic.websocket <span class="keyword">import</span> AsyncWebsocketConsumer</span><br><span class="line"><span class="keyword">from</span> channels.layers <span class="keyword">import</span> get_channel_layer</span><br><span class="line"><span class="keyword">from</span> channels.db <span class="keyword">import</span> database_sync_to_async</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"><span class="keyword">from</span> useraction.models <span class="keyword">import</span> User</span><br><span class="line"><span class="keyword">from</span> chatting.models <span class="keyword">import</span> ChattingMessage</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">channel_layer = get_channel_layer()</span><br><span class="line"><span class="keyword">await</span> channel_layer.send(</span><br><span class="line">    channel_name,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"type"</span> : <span class="string">"chat.message"</span>,</span><br><span class="line">        <span class="string">"message"</span> : message,</span><br><span class="line">        <span class="string">"send_side"</span> : send_side,</span><br><span class="line">        <span class="string">"option"</span> : <span class="string">"chat"</span></span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<h4 id="Database"><a href="#Database" class="headerlink" title="Database"></a>Database</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;åœ¨channelså½“ä¸­ï¼Œæˆ‘ä»¬çš„å¤„ç†æ–¹å¼éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œæ¯”å¦‚å‡½æ•°å®šä¹‰éƒ½æ˜¯<code>async</code>, å‡½æ•°ä½¿ç”¨éƒ½æ˜¯<code>await</code>, é‚£å¯¹æ•°æ®åº“æ“ä½œä¸€èˆ¬Djangoéƒ½æ˜¯åŒæ­¥çš„æ“ä½œï¼Œè¿™æ ·åœ¨channelsé‡Œé¢è¿è¡Œæ˜¯æ²¡æœ‰ä»»ä½•ä½œç”¨çš„ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä½¿ç”¨æ³¨è§£è®©æ•°æ®åº“çš„æ“ä½œå˜æˆå¼‚æ­¥çš„<code>@database_sync_to_async</code>, ç„¶åå¯¹æ•°æ®åº“çš„æ“ä½œå†™åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œä½¿ç”¨ğŸŒ°ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> channels.db <span class="keyword">import</span> database_sync_to_async</span><br><span class="line"></span><br><span class="line"><span class="meta">@database_sync_to_async</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CreateNewMessage</span><span class="params">(self, send_side, recv_side, message)</span>:</span></span><br><span class="line">    mess = ChattingMessage.objects.create(</span><br><span class="line">        send_side_id=int(send_side),</span><br><span class="line">        recv_side_id=int(recv_side),</span><br><span class="line">        message=message</span><br><span class="line">    )</span><br><span class="line">    mess.save()</span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="éƒ¨ç½²æ–¹æ³•"><a href="#éƒ¨ç½²æ–¹æ³•" class="headerlink" title="éƒ¨ç½²æ–¹æ³•"></a>éƒ¨ç½²æ–¹æ³•</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;è¿™ä¸ªé¡¹ç›®æˆ‘ä½¿ç”¨çš„æ˜¯dockerè¿›è¡Œéƒ¨ç½²ï¼Œæ€»å…±æ˜¯3ä¸ªcontainerï¼Œå…¶ä¸­åŒ…æ‹¬<code>mysql</code>, <code>redis</code>, <code>website</code>è¿™ä¸‰ä¸ªcontainerï¼ŒæœåŠ¡ç«¯å£åˆ—è¡¨ä¸º:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">port</th>
<th style="text-align:center">service</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">6379</td>
<td style="text-align:center">redis</td>
</tr>
<tr>
<td style="text-align:center">3000</td>
<td style="text-align:center">mysql</td>
</tr>
<tr>
<td style="text-align:center">8000</td>
<td style="text-align:center">website</td>
</tr>
</tbody>
</table>
</div>
<h4 id="docker-compose"><a href="#docker-compose" class="headerlink" title="docker-compose"></a>docker-compose</h4><p>&nbsp;&nbsp;&nbsp;&nbsp; æˆ‘ç”¨çš„æ˜¯docker-composeæ¥ç®¡ç†docker containerä¹‹é—´çš„è¿æ¥å…³ç³»ï¼Œé‡è¦çš„é…ç½®æ–‡ä»¶çªéƒ½å†™åœ¨é¡¹ç›®ç›®å½•ä¸‹çš„<code>config.json</code>é‡Œé¢ï¼Œdocker-composeæ–¹ä¾¿è¿›è¡Œcontainerä¹‹é—´çš„è¿æ¥ï¼Œå¹¶ä¸”è‡ªåŠ¨å»ºç«‹ä¸åŒcontainerä¹‹é—´çš„networkï¼Œèƒ½è®©å¤šä¸ªcontainerè¿›è¡Œäº’ç›¸è®¿é—®ï¼Œéå¸¸çš„æ–¹ä¾¿ï¼Œç”¨çš„æ—¶å€™æ˜¯å†™<code>docker-compose.yml</code>ï¼š<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">'3'</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  db:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="attr">mysql:latest</span></span><br><span class="line"><span class="attr">    command:</span> <span class="bullet">--default-authentication-plugin=mysql_native_password</span> <span class="bullet">--character-set-server=utf8</span> <span class="bullet">--collation-server=utf8_general_ci</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">"3000:3306"</span></span><br><span class="line"><span class="attr">    environment:</span></span><br><span class="line"><span class="attr">       MYSQL_DATABASE:</span> <span class="string">'booktrade'</span></span><br><span class="line"><span class="attr">       MYSQL_ROOT_PASSWORD:</span> <span class="string">'your-password'</span></span><br><span class="line"><span class="attr">  redis:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="attr">redis:latest</span></span><br><span class="line"><span class="attr">    restart:</span> <span class="string">always</span></span><br><span class="line"><span class="attr">    expose:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">"6379"</span></span><br><span class="line"><span class="attr">  web:</span></span><br><span class="line"><span class="attr">    build:</span> <span class="string">.</span></span><br><span class="line"><span class="attr">    command:</span> <span class="string">./scripts/start_server.sh</span></span><br><span class="line"><span class="attr">    entrypoint:</span> <span class="string">./scripts/docker_entry.sh</span> <span class="string">db</span> <span class="number">3306</span></span><br><span class="line"><span class="attr">    restart:</span> <span class="string">always</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">"8000:8000"</span></span><br><span class="line"><span class="attr">    depends_on:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">db</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">redis</span></span><br></pre></td></tr></table></figure><br>&nbsp;&nbsp;&nbsp;&nbsp;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå¤§å‘ï¼Œå°±æ˜¯web containeråœ¨å¼€å¯çš„æ—¶å€™ï¼Œæ˜¯å’Œå…¶ä»–æœåŠ¡ä¸€èµ·å¼€å¯çš„ï¼Œæ‰€ä»¥åœ¨mysql containerè¿˜æ²¡åˆå§‹åŒ–å¥½çš„æ—¶å€™ï¼Œweb containerå°±å¼€å§‹å°è¯•å†™æ•°æ®åˆ°æ•°æ®åº“é‡Œé¢å»äº†ï¼Œå½“ç„¶ï¼Œè¿™æ ·æœåŠ¡å™¨of course crashäº†ï¼Œæ‰€ä»¥åœ¨<code>entrypoint</code>è¿™é‡ŒåŠ äº†ä¸€ä¸ªè„šæœ¬å»æ£€æŸ¥ï¼Œå¦‚æœæ²¡æœ‰åˆå§‹åŒ–å¥½å°±<code>sleep</code>å»ç­‰ï¼Œåˆå§‹åŒ–å®Œæ¯•ä¹‹åå†å»è¿æ¥æ•°æ®åº“ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">scripts/docker_entry.sh</span><br><span class="line"></span><br><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line">postgres_host=<span class="variable">$1</span></span><br><span class="line">postgres_port=<span class="variable">$2</span></span><br><span class="line"><span class="built_in">shift</span> 2</span><br><span class="line">cmd=<span class="string">"<span class="variable">$@</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># wait for the postgres docker to be running</span></span><br><span class="line"><span class="keyword">while</span> ! nc <span class="variable">$postgres_host</span> <span class="variable">$postgres_port</span>; <span class="keyword">do</span></span><br><span class="line">  &gt;&amp;2 <span class="built_in">echo</span> <span class="string">"MySQL is unavailable - sleeping"</span></span><br><span class="line">  sleep 1</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">&gt;&amp;2 <span class="built_in">echo</span> <span class="string">"MySQL is up - executing command"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># run the command</span></span><br><span class="line"><span class="built_in">exec</span> <span class="variable">$cmd</span></span><br></pre></td></tr></table></figure></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;webé¡¹ç›®çš„<code>Dockerfile</code>ä¸»è¦å°±æ˜¯åˆå§‹åŒ–ç¯å¢ƒï¼Œå®‰è£…ä¸€äº›packageçš„ä¾èµ–ï¼š<br><figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FROM</span> python:<span class="number">3.6</span></span><br><span class="line"><span class="keyword">MAINTAINER</span> huangyifei &lt;huangyifei0910@gmail.com&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> mkdir /code</span></span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> . /code</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /code</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> wget -qO- git.io/superupdate.sh | bash</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get -y install jq netcat-openbsd</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> jq <span class="string">'.DB_HOST = "db"'</span> config.json &gt;&gt; tmp.json &amp;&amp; mv tmp.json config.json</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> jq <span class="string">'.REDIS_HOST = "redis"'</span> config.json &gt;&gt; tmp.json &amp;&amp; mv tmp.json config.json</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> pip install -i https://pypi.tuna.tsinghua.edu.cn/simple -r requirements.txt</span></span><br></pre></td></tr></table></figure></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;åœ¨æ‰€æœ‰è¿™äº›åšå®Œä¹‹åï¼Œä½¿ç”¨<code>docker-compose build</code>æ„å»ºå½“å‰é¡¹ç›®ï¼Œ<code>docker-compose up -d</code>è¿›è¡Œcontainerçš„é“¾æ¥å’Œåå°è¿è¡Œï¼Œå› ä¸ºmysql containerçš„åˆå§‹åŒ–æ—¶é—´æ¯”è¾ƒé•¿ï¼Œæ‰€ä»¥å¼€å¯ä¹‹åéœ€è¦ç­‰å¾…<code>20-30s</code>ç„¶åå°±å¯ä»¥æ„‰å¿«çš„è®¿é—®å•¦(localhost:8000)ï½ çªæ˜¯å°†è¿™ä¸ªæ­¥éª¤å†™åœ¨<code>./scripts/start_docker.sh</code>é‡Œé¢ï¼Œ<code>./scripts/stop_docker</code>æ˜¯åœæ­¢æ‰€æœ‰çš„æœåŠ¡ï¼Œå¹¶ä¸”ç§»é™¤ç›¸å¯¹åº”çš„containerï¼Œå³æ’å³ç”¨ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼ï¼</p>
<hr>
<h3 id="é¡¹ç›®æ€»ç»“"><a href="#é¡¹ç›®æ€»ç»“" class="headerlink" title="é¡¹ç›®æ€»ç»“"></a>é¡¹ç›®æ€»ç»“</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;ç¬¬ä¸€æ¬¡ç”¨Djangoåšåç«¯å’Œdocker-composeæ¥éƒ¨ç½²é¡¹ç›®è¿˜æ˜¯è¸©äº†ä¸å°‘çš„å‘orzï¼Œä¸è¿‡Djangoå¼ºå¤§çš„ç‰¹æ€§å’Œå¾ˆå¤šç¬¬ä¸‰æ–¹çš„packageåŠ æŒï¼Œåšåç«¯çš„å¾ˆå¤šåŠŸèƒ½ä¹Ÿæ˜¯æŒºæ–¹ä¾¿çš„ã€‚dockerä¸»è¦æ˜¯è¿™å­¦æœŸå¼€å§‹æ¥è§¦çš„ï¼Œæˆ‘è§‰å¾—è¿™ä¸œè¥¿åŠ¿å¿…ä¼šç»Ÿæ²»è™šæ‹ŸåŒ–å•Šï¼Œå³æ’å³ç”¨ï¼Œç”Ÿæ€ä¹Ÿéå¸¸çš„å¥½ï¼Œç”¨æ¥éƒ¨ç½²é¡¹ç›®çœäº†å¾ˆå¤šä¹±ä¸ƒå…«ç³Ÿçš„é…ç½®çš„é—®é¢˜ã€‚åé¢ä¹Ÿä¼šè€ƒè™‘å»å­¦ä¸€å­¦å‰ç«¯çš„æ¡†æ¶ï¼Œ<code>React or Vue</code> anyway, è¿˜æœ‰å¾ˆå¤šéœ€è¦å­¦ä¹ çš„ï¼Œä»»é‡è€Œé“è¿œå•Šï¼Make Progress Everydayï¼</p>
<ul>
<li>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/MySuperSoul/BookTradeWeb" target="_blank" rel="noopener">BookTradeWeb</a></li>
<li>ä½¿ç”¨æ–¹æ³•ï¼šå‚è€ƒREADME.mdå½“ä¸­çš„éƒ¨ç½²æ–¹æ³•</li>
<li>éƒ¨ç½²å¥½çš„ç½‘ç«™ï¼š<a href="http://94.191.60.198:8000/" target="_blank" rel="noopener">website</a></li>
<li>Author: huangyifei</li>
<li>Email: <a href="mailto:huangyifei0910@gmail.com">huangyifei0910@gmail.com</a></li>
</ul>
]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Django</tag>
        <tag>docker-compose</tag>
        <tag>websocket</tag>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>data-processing</title>
    <url>/2019/07/16/data-processing/</url>
    <content><![CDATA[<p>è¿™æ˜¯æœ¬æ¬¡é¡¹ç›®å®è®­è¯¾ç¨‹å½“ä¸­ï¼Œæˆ‘æ‰€è´Ÿè´£çš„æ•°æ®åå¤„ç†æ¨¡å—æ‰€å®é™…ä½¿ç”¨çš„ä¸¤ç§ç®—æ³•ã€‚ä¸€ç§æ˜¯<code>simhash</code>ç®—æ³•ï¼ŒGoogleåœ¨ç”¨çš„æµ·é‡ç½‘é¡µå»é‡çš„ç®—æ³•ï¼Œå¦ä¸€ç§æ˜¯<code>textrank</code>ç®—æ³•ï¼Œç”¨äºè¿›è¡Œå…³é”®è¯æå–ã€æ–‡æ¡£è‡ªåŠ¨æ‘˜è¦ç­‰ç®—æ³•ã€‚åœ¨è¿™é‡Œå¯¹è¿™ä¸¤ç§ç®—æ³•è¿›è¡Œç›¸å…³çš„é˜è¿°ã€‚</p>
<a id="more"></a>
<h4 id="è¯¾ç¨‹è®ºæ–‡ç®€è¿°"><a href="#è¯¾ç¨‹è®ºæ–‡ç®€è¿°" class="headerlink" title="è¯¾ç¨‹è®ºæ–‡ç®€è¿°"></a>è¯¾ç¨‹è®ºæ–‡ç®€è¿°</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å› ä¸ºåœ¨æœ¬æ¬¡å®ç°çš„æœç´¢å¼•æ“é¡¹ç›®å½“ä¸­ï¼Œæˆ‘ä¸»è¦è´Ÿè´£çš„å°±æ˜¯å„ç±»æ•°æ®çš„è·å–ï¼Œä»¥åŠä¸»è¦çš„æ•°æ®åå¤„ç†å·¥ä½œã€‚çˆ¬è™«éƒ¨åˆ†æ„Ÿè§‰æ²¡æœ‰ä»€ä¹ˆå¥½è®²çš„ï¼Œé€šè¿‡<code>scrapy</code>å’Œ<code>selenium</code>ã€<code>requests</code>, å¯¹äºä¸€èˆ¬çš„ç½‘ç«™çˆ¬å–å·¥ä½œéƒ½å¯ä»¥èƒœä»»ï¼Œä¸è¿‡ä¸ºäº†åº”å¯¹å¾ˆå¤šç½‘ç«™çš„åçˆ¬è™«ç­–ç•¥ï¼Œæˆ‘ä»¬è‡ªå·±å®ç°çš„IPæ± è¿˜æ˜¯æœ‰äº®ç‚¹çš„ï¼Œä¸è¿‡ä¸æ˜¯æˆ‘å†™çš„æ‰€ä»¥æˆ‘è¿™é‡Œå°±ä¸å±•å¼€ã€‚æˆ‘è§‰å¾—æ¯”è¾ƒæœ‰ç‰¹è‰²æ˜¯æ•°æ®åå¤„ç†éƒ¨åˆ†ï¼Œåœ¨å¾—åˆ°æ•°æ®ä¹‹åå¿…è¦çš„å·¥ä½œæ˜¯éœ€è¦å¯¹æ•°æ®è¿›è¡Œæ¸…æ´—å’ŒåŠ å·¥ï¼Œæ‰€ä»¥æˆ‘ä¸»è¦é€‰å–äº†é¡¹ç›®å½“ä¸­åœ¨ç”¨çš„<code>simhash</code>æ–‡æœ¬ç›¸ä¼¼åº¦è¿‡æ»¤ç®—æ³•å’Œ<code>textrank</code>è‡ªåŠ¨æ‘˜è¦ç®—æ³•æ¥å†™æœ¬æ¬¡çš„è¯¾ç¨‹è®ºæ–‡ã€‚</p>
<p><br></p>
<h4 id="æ–‡æœ¬ç›¸ä¼¼åº¦å¤„ç†"><a href="#æ–‡æœ¬ç›¸ä¼¼åº¦å¤„ç†" class="headerlink" title="æ–‡æœ¬ç›¸ä¼¼åº¦å¤„ç†"></a>æ–‡æœ¬ç›¸ä¼¼åº¦å¤„ç†</h4><ol>
<li><strong>æ–‡æœ¬è·ç¦»</strong></li>
</ol>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;åœ¨æ­£å¼ä»‹ç»æ–‡æœ¬ç›¸ä¼¼åº¦ç®—æ³•ä¹‹å‰ï¼Œé¦–å…ˆæˆ‘ä¼šå¯¹å‡ ç§æ¯”è¾ƒå¸¸ç”¨çš„æ–‡æœ¬è·ç¦»è®¡ç®—æ–¹å¼è¿›è¡Œä»‹ç»ã€‚å› ä¸ºæ–‡æœ¬ç›¸ä¼¼åº¦è®¡ç®—çš„åŸºç¡€è¿˜æ˜¯åœ¨äºä¸åŒæ–‡æœ¬å½“ä¸­çš„æ–‡æœ¬è·ç¦»æ˜¯å¦‚ä½•å®šä¹‰çš„ï¼Œä¸åŒçš„æ–‡æœ¬è·ç¦»è®¡ç®—ä¼šå¯¼è‡´ä¸åŒçš„ç›¸ä¼¼åº¦çš„ç”Ÿæˆã€‚</p>
<ul>
<li><strong>æ¬§å‡ é‡Œå¾—è·ç¦»</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æ¬§å‡ é‡Œå¾—è·ç¦»åˆç§°<a href="https://zh.wikipedia.org/wiki/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E8%B7%9D%E7%A6%BB" target="_blank" rel="noopener">æ¬§æ°è·ç¦»</a>ã€‚æ˜¯æˆ‘ä»¬å®é™…å½“ä¸­ä½¿ç”¨éå¸¸é¢‘ç¹çš„ä¸€ç§è·ç¦»è®¡ç®—æ–¹å¼ã€‚åœ¨æ¬§æ°ç©ºé—´å½“ä¸­ï¼Œä¸¤ä¸ªç‚¹$x=(x_1, x_2, â€¦, x_n), y=(y_1, y_2, â€¦, y_n)$ä¹‹é—´çš„æ¬§æ°è·ç¦»å¯ä»¥è¡¨ç¤ºä¸º:</p>
<script type="math/tex; mode=display">
d(x, y) = \sqrt{\sum_{i=1}^n(x_i - y_i)^2}</script><ul>
<li><strong>æ›¼å“ˆé¡¿è·ç¦»</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://zh.wikipedia.org/wiki/%E6%9B%BC%E5%93%88%E9%A0%93%E8%B7%9D%E9%9B%A2" target="_blank" rel="noopener">æ›¼å“ˆé¡¿è·ç¦»</a>æ˜¯ç”¨æ¥åœ¨æ¬§æ°ç©ºé—´æ ‡æ˜ä¸¤ä¸ªç‚¹åœ¨æ ‡å‡†åæ ‡ç³»ä¸Šçš„ç»å¯¹è½´è·æ€»å’Œçš„ä¸€ç§è·ç¦»åº¦é‡æ–¹å¼ã€‚ä»å‡ ä½•çš„è§’åº¦æ¥çœ‹ï¼Œ<code>æ¬§æ°è·ç¦»</code>åº¦é‡çš„æ˜¯ä¸¤ä¸ªç‚¹çš„å®é™…è·ç¦»ï¼Œ<code>æ›¼å“ˆé¡¿è·ç¦»</code>åº¦é‡çš„æ˜¯ä¸¤ä¸ªç‚¹çš„ç»å¯¹è½´ä¹‹é—´çš„è·ç¦»ã€‚ä¾‹å¦‚åœ¨ç›´è§’åæ ‡ç³»å½“ä¸­$x=(x_1, x_2), y=(y_1, y_2)$, é‚£ä¹ˆä¸¤ä¸ªç‚¹ä¹‹é—´çš„æ›¼å“ˆé¡¿è·ç¦»è¡¨ç¤ºä¸ºï¼š</p>
<script type="math/tex; mode=display">
d(x, y) = |x_1-y_1| + |x_2 - y_2|</script><ul>
<li><strong>ä½™å¼¦è·ç¦»</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://zh.wikipedia.org/wiki/%E4%BD%99%E5%BC%A6%E7%9B%B8%E4%BC%BC%E6%80%A7" target="_blank" rel="noopener">ä½™å¼¦è·ç¦»</a> æ˜¯é€šè¿‡è®¡ç®—ä¸¤ä¸ªå‘é‡ä¹‹é—´å¤¹è§’ä½™å¼¦å€¼æ¥è¡¡é‡ä¸¤ä¸ªå‘é‡ä¹‹é—´ç›¸ä¼¼åº¦çš„ä¸€ç§å¸¸ç”¨çš„æ–¹æ³•ã€‚æˆ‘ä»¬éƒ½çŸ¥é“å¦‚æœä¸¤ä¸ªå‘é‡ä¹‹é—´çš„å¤¹è§’è¶Šå°ï¼Œä½™å¼¦å€¼å°±è¶Šæ¥è¿‘1.æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¡ç®—ä¸¤ä¸ªå‘é‡çš„ä½™å¼¦å¤¹è§’æ¥è¡¡é‡ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚ç»™å®šä¸¤ä¸ªå‘é‡$A, B$ï¼Œ ä»–ä»¬ä½™å¼¦è·ç¦»è¡¡é‡å…¬å¼å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
similarity(A, B) = \cos(A, B) = \frac{\sum_{i=1}^n A_i \cdot B_i}{\sum_{i=1}^n(A_i)^2 \cdot \sum_{i=1}^n(B_i)^2}</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å¦‚æœ<code>similarity</code>è¶Šæ¥è¿‘1ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„è·ç¦»è¶Šå°ï¼Œä¹Ÿå³ç›¸ä¼¼åº¦ä¹Ÿå°±è¶Šé«˜ã€‚</p>
<ul>
<li><strong>æµ·æ˜è·ç¦»(Hamming distance)</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://zh.wikipedia.org/wiki/%E6%B1%89%E6%98%8E%E8%B7%9D%E7%A6%BB" target="_blank" rel="noopener">æµ·æ˜è·ç¦»</a>åˆç§°<code>Hamming distance</code>. æ˜¯åœ¨ç¼–ç é¢†åŸŸå¸¸ç”¨çš„ä¸€ç§è·ç¦»åº¦é‡çš„æ–¹æ³•ã€‚è€Œä¸”æ–¹æ³•å’Œæ€æƒ³éå¸¸çš„æœ´ç´ ï¼Œç›¸ä¿¡å¤§å®¶ä¹‹å‰åœ¨<code>è®¡ç®—æœºç½‘ç»œ</code>è¯¾ç¨‹å½“ä¸­å·²ç»æ¥è§¦è¿‡æµ·æ˜ç çš„æ¦‚å¿µã€‚æµ·æ˜è·ç¦»å¯¹äºäºŒè¿›åˆ¶çš„å­—ç¬¦ä¸²ä¹‹é—´çš„è®¡ç®—ï¼Œéå¸¸ç®€å•ï¼Œå°±æ˜¯ç›´æ¥è®¡ç®—æ‰€æœ‰ä½ä¸Šï¼Œä¸åŒçš„ç å­—çš„æ•°é‡ã€‚ä¾‹å¦‚<code>1011101</code>ä¸<code>1001001</code>ä¹‹é—´çš„æ±‰æ˜è·ç¦»æ˜¯2. è™½ç„¶hamming distanceçš„æ€è·¯éå¸¸ç®€å•ï¼Œä½†æ˜¯å®ƒåœ¨å¾ˆå¤šé¢†åŸŸå½“ä¸­éƒ½æœ‰ç€éå¸¸é‡è¦çš„ä½œç”¨ï¼Œåœ¨ä¹‹åæˆ‘ä¼šä»‹ç»çš„ï¼Œåœ¨æˆ‘ä»¬<a href="https://github.com/MySuperSoul/SearchEngine/tree/master/post-processors/common" target="_blank" rel="noopener">æœç´¢å¼•æ“é¡¹ç›®</a>å½“ä¸­ä½¿ç”¨çš„æ–‡æœ¬ç›¸ä¼¼åº¦ç®—æ³•å°±æ˜¯åˆ©ç”¨äº†hamming distanceæ¥è¿›è¡Œè®¡ç®—ç›¸ä¼¼åº¦ã€‚</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åŒæ—¶å› ä¸ºhamming distanceå¯¹äº0ï¼Œ1å­—ç¬¦ä¸²çš„åº¦é‡æœ‰éå¸¸å¿«é€Ÿçš„ç®—æ³•ï¼Œä¹‹é—´é€šè¿‡ä½è¿ç®—çš„æ–¹å¼å¯ä»¥å¿«é€Ÿçš„æ±‚å¾—ä¸¤ä¸ª0, 1å­—ç¬¦ä¸²ä¹‹é—´çš„æµ·æ˜è·ç¦»ï¼Œåœ¨æˆ‘ä»¬åå¤„ç†å½“ä¸­ï¼Œå°±æ˜¯åˆ©ç”¨è¿™ç§æ–¹æ³•èƒ½å¤Ÿå¿«é€Ÿè¿›è¡Œhamming distanceè®¡ç®—ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">params:</span></span><br><span class="line"><span class="string">    code_1 -&gt; str: first hamming code</span></span><br><span class="line"><span class="string">    code_2 -&gt; str: second hamming code</span></span><br><span class="line"><span class="string">    hash_bits -&gt; int: number of the length of two hamming code</span></span><br><span class="line"><span class="string">return:</span></span><br><span class="line"><span class="string">    ans -&gt; int: hamming distance of two hamming code</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">HammingDistance</span><span class="params">(self, code_1, code_2)</span>:</span></span><br><span class="line">    x = (code_1 ^ code_2) &amp; ((<span class="number">1</span> &lt;&lt; self.hash_bits) - <span class="number">1</span>)</span><br><span class="line">    ans = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> x:</span><br><span class="line">        ans += <span class="number">1</span></span><br><span class="line">        x &amp;= x - <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>
<p><br></p>
<ol>
<li><strong>æµ·é‡æ–‡æœ¬ç›¸ä¼¼åº¦ç®—æ³•Simhash</strong></li>
</ol>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨è¿™æ¬¡çš„æœç´¢å¼•æ“é¡¹ç›®å½“ä¸­ï¼Œæ•°æ®åå¤„ç†çš„é¦–å…ˆé—®é¢˜å°±æ˜¯å¦‚ä½•å¯¹æ”¶é›†åˆ°çš„å„ç§ä¿¡æ¯è¿›è¡Œå»é‡ã€‚ä¸€ä¸ªæœ€ç›´æ¥çš„æ–¹æ³•å°±æ˜¯æ ¹æ®URLä½¿ç”¨setè¿›è¡Œå»é‡ï¼Œå½“ç„¶è¿™åªæ˜¯æœ€åŸºæœ¬çš„é‡å¤æ»¤é‡ã€‚è¿˜æœ‰å¦å¤–ä¸€ç§æƒ…å†µæˆ‘ä»¬ä¹Ÿå¿…é¡»è¦è€ƒè™‘åˆ°ï¼Œä¹Ÿå°±æ˜¯å­˜åœ¨<code>æ–‡ç« è½¬è½½æˆ–è€…æŠ„è¢­</code>çš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬å¯¹äºè¿™ç§æƒ…å†µä¹Ÿå¿…é¡»è¿›è¡Œæ•°æ®çš„å¤„ç†å’Œæ»¤é‡ã€‚</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœè¦è®¡ç®—ä¸¤ç¯‡æ–‡æ¡£ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œä¼ ç»Ÿçš„æ€è·¯å¯èƒ½æ˜¯ï¼š</p>
<ul>
<li>å¯ä»¥é€šè¿‡å°†ä¸¤ç¯‡æ–‡ç« è¿›è¡Œåˆ†è¯ï¼Œé€šè¿‡å…³é”®è¯å’Œå¯¹åº”çš„æƒé‡ç”Ÿæˆç‰¹å¾è¯å‘é‡ï¼Œç„¶åå°±èƒ½é€šè¿‡æˆ‘ä»¬å‰é¢ä»‹ç»çš„å‡ ç§<code>æ–‡æœ¬è·ç¦»</code>è®¡ç®—çš„æ–¹æ³•è¿›è¡Œè·ç¦»åº¦é‡ï¼ˆæ¯”å¦‚å¯ä»¥è®¡ç®—ç‰¹å¾å‘é‡ä¹‹é—´çš„æ¬§æ°è·ç¦»ï¼Œæˆ–è€…æ˜¯é€šè¿‡ä½™å¼¦è·ç¦»æ¥åº¦é‡ä¸¤ä¸ªç‰¹å¾è¯å‘é‡ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼‰ã€‚é€šè¿‡<code>è·ç¦»çš„å¤§å°</code>æ¥åº¦é‡ä¸¤ç¯‡æ–‡æ¡£çš„ç›¸ä¼¼åº¦ã€‚</li>
<li>é€šè¿‡<code>hash</code>çš„æ–¹æ³•ï¼Œä¸ºæ¯ä¸€ç¯‡æ–‡æ¡£é€šè¿‡å“ˆå¸Œçš„æ–¹æ³•ç”Ÿæˆä¸€ä¸ªç‰¹å®šçš„å“ˆå¸ŒæŒ‡çº¹ï¼Œç„¶åé€šè¿‡æ¯”å¯¹ç”Ÿæˆçš„å“ˆå¸ŒæŒ‡çº¹å¯¹æ–‡æœ¬çš„ç›¸ä¼¼åº¦è¿›è¡Œè®¡ç®—ã€‚</li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å½“ç„¶è¿™ä¸¤ç§æ–¹æ³•éƒ½å­˜åœ¨ç€å¾ˆå¤§çš„å¼Šç«¯ï¼Œå¯¹äºç¬¬ä¸€ç§æ–¹æ³•çš„è¯ï¼Œåœ¨æµ·é‡çš„æ•°æ®é¢å‰ï¼Œè¿™ä¸ªç®—æ³•æ‰€éœ€è¦è€—è´¹çš„æ—¶é—´æ˜¯éš¾ä»¥æƒ³è±¡çš„ï¼Œæ‰€ä»¥è¿™ç§æ–¹æ³•è¿ç”¨åˆ°æœç´¢å¼•æ“ä¸Šï¼Œç†è®ºä¸Šåœ¨æ—¶é—´çš„èŠ±è´¹æˆæœ¬éå¸¸ä¹‹é«˜ã€‚</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å¯¹äºç¬¬äºŒç§æ–¹æ³•çš„è¯ï¼Œé‡ç‚¹å°±åœ¨äº<code>å¦‚ä½•è®¾è®¡ä¸€ä¸ªå¥½çš„hashå‡½æ•°</code>ï¼Œå¦‚æœé‡‡ç”¨ä¼ ç»Ÿçš„hashæ–¹æ³•ï¼Œæ¯”å¦‚è¯´æ˜¯<code>md5</code>è¿™ç§å±€éƒ¨ä¸æ•æ„Ÿçš„å“ˆå¸Œæ–¹æ³•çš„è¯ï¼Œé‚£ä¹ˆåœ¨æ–‡æœ¬æœ‰å¾ˆå°çš„å˜åŠ¨æ—¶å€™ï¼Œç”Ÿæˆçš„md5å“ˆå¸Œç çš„å·®å¼‚ä¹Ÿä¼šç›¸å·®ç”šè¿œï¼Œæ˜¾ç„¶è¿™ä¸æ˜¯æˆ‘ä»¬éœ€è¦çš„hashå‡½æ•°ã€‚æˆ‘ä»¬<code>ç†æƒ³çš„hashå‡½æ•°</code>åº”è¯¥å¯¹äºç›¸ä¼¼çš„æ–‡æ¡£èƒ½å¤Ÿç”Ÿæˆæ¯”è¾ƒç›¸ä¼¼çš„å“ˆå¸Œç ï¼Œä»è€Œæˆ‘ä»¬æ‰èƒ½ä»hash codeå½“ä¸­æå–æ–‡ç« çš„ç›¸ä¼¼åº¦ã€‚</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æ‰€ä»¥æ¥ä¸‹æ¥å°±ä¼šä»‹ç»<strong>Simhash</strong>çš„ç®—æ³•ï¼Œç”¨æ¥è§£å†³å·¨å¤§æ•°æ®é‡ç½‘é¡µå»é‡çš„ç®—æ³•ã€‚è¯¥ç®—æ³•æœ€åˆæ˜¯Googleæå‡ºçš„ä¸€ç§ç”¨äºç½‘é¡µå»é‡çš„ç®—æ³•ï¼Œè¯¦ç»†çš„è®ºæ–‡å¯ä»¥å‚è€ƒ<a href="https://www2007.org/papers/paper215.pdf" target="_blank" rel="noopener">ã€Šdetecting near-duplicates for web crawlingã€‹</a>ã€‚</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>Simhash</code>æ˜¯å±€éƒ¨ä¸æ•æ„Ÿå“ˆå¸Œæ–¹æ³•å½“ä¸­çš„ä¸€ç§ã€‚ä¹Ÿå³è¾“å…¥æ–‡æ¡£çš„å°éƒ¨åˆ†æ”¹åŠ¨å¯¹æœ€åç”Ÿæˆçš„hash codeå¹¶ä¸ä¼šæœ‰å¾ˆå¤§çš„å½±å“ã€‚Simhashæ–¹æ³•çš„ä¸»è¦æ€æƒ³æ˜¯<code>é™ç»´æ€æƒ³</code>ï¼Œé€šè¿‡å°†é«˜ç»´çš„ç‰¹å¾è¯å‘é‡é™ç»´åˆ°ç”Ÿæˆçš„hashcodeç»´åº¦ï¼Œä¸€èˆ¬é€‰å–çš„<code>64bits</code>æˆ–è€…<code>128bits</code>ç”Ÿæˆhashcode. ç„¶åé€šè¿‡è®¡ç®—ä¸åŒæ–‡æ¡£ä¹‹é—´simhashå€¼çš„hamming distanceæ¥åº¦é‡ä¸åŒæ–‡æ¡£ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚å…·ä½“çš„simhashç®—æ³•ä¸€èˆ¬å¤„ç†ä¸ºå…­ä¸ªæ­¥éª¤ï¼š<code>åˆ†è¯ -&gt; hash -&gt; åŠ æƒ -&gt; åˆå¹¶ -&gt; é™ç»´ -&gt; hamming distance</code>.</p>
<ul>
<li><strong>åˆ†è¯</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åˆ†è¯æ­¥éª¤å½“ä¸­ä¸»è¦æ˜¯å¯¹æ–‡æ¡£è¿›è¡Œåˆ†è¯ï¼Œå¹¶ä¸”ç¡®å®šæ¯ä¸ªåˆ†è¯çš„æƒé‡åˆ†å¸ƒã€‚ä¸­æ–‡åˆ†è¯æˆ‘æ‰€ä½¿ç”¨çš„æ˜¯<a href="https://github.com/fxsjy/jieba" target="_blank" rel="noopener">jieba</a>è¿›è¡Œåˆ†è¯ï¼Œå› ä¸ºæˆ‘ä»¬é¡¹ç›®å½“ä¸­å¤§éƒ¨åˆ†è¿˜æ˜¯æ”¶é›†çš„ä¸­æ–‡åšå®¢ã€demoç­‰èµ„æºï¼Œå¹¶ä¸”åœ¨å®é™…æµ‹è¯•çš„æ—¶å€™å‘ç°<code>jieba</code>å¯¹äºè‹±æ–‡çš„åˆ†è¯æ•ˆæœä¹Ÿè¿˜æ˜¯å¯ä»¥çš„ï¼å…¶ä¸­æƒé‡å€¼åœ¨åç»­ä¼šä½¿ç”¨ï¼Œä»£è¡¨çš„æ˜¯è¯¥è¯è¯­åœ¨æ•´ç¯‡æ–‡ç« å½“ä¸­çš„é‡è¦æ€§ã€‚</p>
<ul>
<li><strong>hash</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hashæ­¥éª¤ä¸»è¦æ˜¯å¯¹ä¸Šé¢å¾—åˆ°çš„æ–‡æ¡£è¯è¯­è¿›è¡Œå“ˆå¸Œå‡½æ•°çš„è®¡ç®—ï¼Œé€šå¸¸åœ¨è¿™é‡Œéœ€è¦æŒ‡å®š<code>hash_bits</code>, ä¹Ÿå³åç»­çš„æ¯ç¯‡æ–‡æ¡£éƒ½ä¼šé™ç»´åˆ°<code>hash_bits</code>è¿™ä¸ªç»´åº¦ä¸Šã€‚é€šè¿‡å“ˆå¸Œå‡½æ•°å¤„ç†ä¹‹åï¼Œæ¯ä¸ªå­—ç¬¦ä¸²éƒ½ä¼šå˜æˆä¸€ä¸ª01çš„å­—ç¬¦ä¸²ï¼ŒåŒæ—¶é•¿åº¦ä¸ºæˆ‘ä»¬æ‰€å¸Œæœ›çš„<code>hash_bits</code>.</p>
<ul>
<li><strong>åŠ æƒ</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åŠ æƒè¿‡ç¨‹éœ€è¦ä½¿ç”¨åˆ°ä¸Šè¿°æˆ‘ä»¬å¾—åˆ°çš„æƒé‡å€¼ï¼Œé€šè¿‡å¯¹æ‰€æœ‰å¾—åˆ°çš„hashå€¼ä¹˜ä¸Šå¯¹åº”çš„æƒé‡ï¼Œå¾—åˆ°å¯¹åº”çš„åŠ æƒåçš„æ–°å“ˆå¸Œå€¼ã€‚å…¶ä¸­å› ä¸ºå¾—åˆ°çš„æ˜¯01å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬è§„å®šé‡åˆ°1å°±æ˜¯æ­£å€¼ï¼Œé‡åˆ°0å°±æ˜¯è´Ÿå€¼ï¼Œè€Œåè¿›è¡Œè®¡ç®—ã€‚ä¸¾ä¸ªğŸŒ°ï¼Œæ¯”å¦‚<code>æµ™æ±Ÿå¤§å­¦</code>ç¼–ç ä¸º<code>101010</code>, å¹¶ä¸”æƒé‡ä¸º<code>5</code>çš„è¯ï¼Œé€šè¿‡åŠ æƒä¹‹åï¼Œå¾—åˆ°çš„æ–°çš„åŠ æƒå“ˆå¸Œå€¼å°±ä¸ºï¼š<code>5 -5 5 -5 5 -5</code>. å…¶ä»–çš„åˆ†è¯åçš„è¯è¯­ç±»ä¼¼å¤„ç†ã€‚</p>
<ul>
<li><strong>åˆå¹¶</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; é€šè¿‡ä¸Šé¢<code>åŠ æƒ</code>æ­¥éª¤ä¹‹åï¼Œæˆ‘ä»¬å¾—åˆ°äº†æ‰€æœ‰åˆ†è¯çš„åŠ æƒhash codeï¼Œä¹‹åæˆ‘ä»¬å¯¹æ‰€æœ‰çš„è¿™äº›åŠ æƒhash codeè¿›è¡Œç›¸åŠ ï¼Œç›¸åŠ ä¹‹åå¾—åˆ°çš„åŠ æƒhash codeå°±åšä¸ºæ•´ç¯‡æ–‡æ¡£çš„åŠ æƒhash code. å†ä¸¾ä¸ªğŸŒ°ï¼Œæˆ‘ä»¬å¾—åˆ°<code>æµ™æ±Ÿå¤§å­¦</code>å“ˆå¸Œå€¼ä¸º<code>5 -5 5 -5 5 -5</code>, åŒæ—¶æˆ‘ä»¬è¿˜å¾—åˆ°<code>è½¯ä»¶å·¥ç¨‹</code>è¿™ä¸ªè¯çš„å“ˆå¸Œå€¼ä¸º<code>4 4 -4 4 -4 4</code>, é‚£ä¹ˆæ€»çš„åŠ æƒçš„å“ˆå¸Œå€¼ä¸º<code>9 -1 1 -1 1 -1</code>. å…¶ä»–çš„å¤„ç†æµç¨‹éƒ½æ˜¯ç±»ä¼¼çš„ã€‚</p>
<ul>
<li><strong>é™ç»´</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; é™ç»´æ­¥éª¤å°±æ˜¯å¯¹ä¸Šè¿°å¾—åˆ°çš„åŠ æƒcodeè¿›è¡Œä¸€ä¸ªç®€å•çš„<code>Sign</code>è®¡ç®—ï¼Œä¹Ÿå³ç å€¼å¤§äº0çš„è®°ä¸º1ï¼Œå…¶ä»–çš„è®°ä¸º0ï¼Œå°±æ¯”å¦‚ä¸Šé¢å¾—åˆ°çš„é‚£ä¸€ä¸²åŠ æƒçš„hash codeï¼Œåœ¨ç»è¿‡é™ç»´å¤„ç†ä¹‹åï¼Œæˆ‘ä»¬å°±èƒ½å¾—åˆ°æœ€åæ–‡ç« ç”Ÿæˆçš„01 hash codeä¸ºï¼š<code>101010</code>.</p>
<ul>
<li><strong>Hamming distance</strong></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨ä¸Šè¿°çš„pipelinesä¹‹åæˆ‘ä»¬å¾—åˆ°äº†æ•´ç¯‡æ–‡æ¡£çš„hash codeï¼Œæ¥ç€åªéœ€è¦å¯¹ä¸¤ç¯‡æ–‡æ¡£çš„hash codeè®¡ç®—hamming distanceï¼Œå°±èƒ½å¾ˆå¿«çš„å¾—åˆ°ä¸¤ç¯‡æ–‡æ¡£ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æ•´ä¸ªSimhashç®—æ³•çš„æµç¨‹å¯ä»¥ç”¨ä¸‹é¢è¿™å¼ å›¾è¿›è¡Œå±•ç¤ºï¼Œå¾ˆæ¸…æ™°çš„å±•ç¤ºäº†æ•´ä¸ªç®—æ³•çš„æµç¨‹å’Œåšæ³•ï¼š</p>
<div align="center">
<img src="/2019/07/16/data-processing/1.png">
</div>

<p><br></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å¯¹äºSimhashç®—æ³•åœ¨å®é™…å¤„ç†æµ·é‡æ•°æ®æ—¶å€™è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„ä¼˜åŒ–æŸ¥è¯¢æ–¹å¼ï¼Œæ¯”å¦‚å¯¹æœ€åç”Ÿæˆçš„hash codeè¿›è¡Œåˆ†å—æŸ¥è¯¢ï¼Œå»ºç«‹å€’æ’ç´¢å¼•ç­‰æ–¹å¼åŠ å¿«åœ¨æ ·æœ¬æ•°æ®åº“å½“ä¸­çš„æœç´¢æŸ¥è¯¢é€Ÿåº¦ã€‚æˆ‘ä»¬é¡¹ç›®å½“ä¸­çš„æ•°æ®æ•°é‡è¿œä¸åŠGoogleä¸Šçš„æ ·æœ¬æ•°é‡ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰è¿›è¡Œè¿‡å¤šçš„ä¼˜åŒ–ï¼Œç›´æ¥è®¡ç®—hamming codeè¿›è¡Œåˆ¤æ–­ã€‚åœ¨é¡¹ç›®çš„åå¤„ç†æ¨¡å—å½“ä¸­ï¼Œæˆ‘å°†simhashç®—æ³•å°è£…ä¸ºä¸€ä¸ªç±»ï¼Œå…¶ä¸­ä½¿ç”¨äº†å¼€æºé¡¹ç›®<a href="http://leons.im/posts/a-python-implementation-of-simhash-algorithm/" target="_blank" rel="noopener">simhash</a>æ¥å®Œæˆhash codeçš„è®¡ç®—ã€‚å¹¶ä¸”å½“ç›¸ä¼¼åº¦è¶…è¿‡<code>95%</code>çš„æ—¶å€™ï¼Œæˆ‘å°±è®¤ä¸ºè¿™ä¸¤ç¯‡æ–‡æ¡£æ˜¯éå¸¸ç›¸ä¼¼çš„ï¼Œéœ€è¦ä»æˆ‘ä»¬çš„æ•°æ®åº“å½“ä¸­è¿‡æ»¤æ‰ï¼Œå…·ä½“å®ç°å¯ä»¥å‚è€ƒæˆ‘ä»¬æœç´¢å¼•æ“é¡¹ç›®å½“ä¸­çš„å®ç°<a href="https://github.com/MySuperSoul/SearchEngine/blob/master/post-processors/common/SimHash.py" target="_blank" rel="noopener">SimHashFilter</a>.</p>
<p><br></p>
<ol>
<li><strong>å®é™…æ•ˆæœæµ‹è¯•</strong></li>
</ol>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨å®ç°äº†simhashç®—æ³•ä¹‹åï¼Œæˆ‘å¯¹å®ç°çš„è¯¥ç®—æ³•è¿›è¡Œäº†ç›¸å…³æµ‹è¯•å’Œæ€§èƒ½ä¼°è®¡ã€‚åœ¨é¡¹ç›®å½“ä¸­æˆ‘æ‰€ç”¨çš„hash_bitsé•¿åº¦ä¸º<code>128</code>, å› ä¸ºå®é™…æµ‹è¯•æ—¶å€™ä½¿ç”¨64bitsçš„hamming codeç²¾åº¦å¯èƒ½ä¸å¤ªç¬¦åˆå®é™…çš„éœ€æ±‚ï¼Œæ‰€ä»¥æˆ‘æå‡åˆ°äº†128ä½çš„hash_bits. æµ‹è¯•ä»£ç å’Œæµ‹è¯•æ–‡æœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> common.SimHash <span class="keyword">import</span> SimHashFilter</span><br><span class="line">text1 = <span class="string">"æ²‰é»˜èºæ—‹æ¨¡å¼ä¸­å‘ˆç°å‡ºæ°‘æ„åŠ¨åŠ›çš„æ¥æºåœ¨äºäººç±»æœ‰å®³æ€•å­¤ç«‹çš„å¼±ç‚¹ï¼Œä½†å…‰å®³æ€•å­¤ç«‹ä¸è‡³äºå½±å“æ°‘æ„çš„å½¢æˆï¼Œ"</span> \</span><br><span class="line">    + <span class="string">"ä¸»è¦æ˜¯å½“ä¸ªäººè§‰å¯Ÿåˆ°è‡ªå·±å¯¹æŸè®ºé¢˜çš„æ„è§ä¸ç¯å¢ƒä¸­çš„å¼ºåŠ¿æ„è§ä¸€è‡´ï¼ˆæˆ–ä¸ä¸€è‡´æ—¶ï¼‰ï¼Œå®³æ€•å­¤ç«‹è¿™ä¸ªå˜é¡¹æ‰ä¼šäº§ç”Ÿä½œç”¨ã€‚"</span> \</span><br><span class="line">    + <span class="string">"ä»å¿ƒç†å­¦çš„èŒƒç•´æ¥çœ‹ï¼Œç¤¾ä¼šä¸­çš„å¼ºåŠ¿æ„è§è¶Šæ¥è¶Šå¼ºï¼Œç”šè‡³æ¯”å®é™…æƒ…å½¢è¿˜å¼ºï¼Œå¼±åŠ¿æ„è§è¶Šæ¥è¶Šå¼±ï¼Œç”šè‡³æ¯”å®é™…æƒ…å½¢è¿˜å¼±ï¼Œ\</span></span><br><span class="line"><span class="string">è¿™ç§åŠ¨åŠ›è¿ä½œçš„è¿‡ç¨‹æˆâ€“èºæ—‹çŠ¶"</span></span><br><span class="line"></span><br><span class="line">text2 = <span class="string">"æ²‰é»˜èºæ—‹æ¨¡å¼ä¸­å‘ˆç°å‡ºæ°‘æ„åŠ¨åŠ›çš„æ¥æºåœ¨äºäººç±»æœ‰å®³æ€•å­¤ç«‹çš„å¼±ç‚¹ï¼Œä½†å…‰å®³æ€•å­¤ç«‹ä¸è‡³äºå½±å“æ°‘æ„çš„å½¢æˆï¼Œ"</span> \</span><br><span class="line">    + <span class="string">"ä»å¿ƒç†å­¦çš„èŒƒç•´æ¥çœ‹ï¼Œç¤¾ä¼šä¸­çš„å¼ºåŠ¿æ„è§è¶Šæ¥è¶Šå¼ºï¼Œç”šè‡³æ¯”å®é™…æƒ…å½¢è¿˜å¼ºï¼Œå¼±åŠ¿æ„è§è¶Šæ¥è¶Šå¼±ï¼Œç”šè‡³æ¯”å®é™…æƒ…å½¢è¿˜å¼±ï¼Œ\</span></span><br><span class="line"><span class="string">è¿™ç§åŠ¨åŠ›è¿ä½œçš„è¿‡ç¨‹æˆâ€“èºæ—‹çŠ¶"</span> \</span><br><span class="line">+ <span class="string">"ä¸»è¦æ˜¯å½“ä¸ªäººè§‰å¯Ÿåˆ°è‡ªå·±å¯¹æŸè®ºé¢˜çš„æ„è§ä¸ç¯å¢ƒä¸­çš„å¼ºåŠ¿æ„è§ä¸€è‡´ï¼ˆæˆ–ä¸ä¸€è‡´æ—¶ï¼‰ï¼Œå®³æ€•å­¤ç«‹è¿™ä¸ªå˜é¡¹æ‰ä¼šäº§ç”Ÿä½œç”¨ã€‚"</span></span><br><span class="line"></span><br><span class="line">filter = SimHashFilter(<span class="number">128</span>)</span><br><span class="line">print(bin(filter.GetCodeForText(text1)))</span><br><span class="line">print(bin(filter.GetCodeForText(text2)))</span><br><span class="line">print(filter.IsSimilarByText(text1, text2))</span><br></pre></td></tr></table></figure>
<pre><code>æ–‡æœ¬1: 
&quot;æ²‰é»˜èºæ—‹æ¨¡å¼ä¸­å‘ˆç°å‡ºæ°‘æ„åŠ¨åŠ›çš„æ¥æºåœ¨äºäººç±»æœ‰å®³æ€•å­¤ç«‹çš„å¼±ç‚¹ï¼Œä½†å…‰å®³æ€•å­¤ç«‹ä¸è‡³äºå½±å“æ°‘æ„çš„å½¢æˆï¼Œ&quot;
+ &quot;ä¸»è¦æ˜¯å½“ä¸ªäººè§‰å¯Ÿåˆ°è‡ªå·±å¯¹æŸè®ºé¢˜çš„æ„è§ä¸ç¯å¢ƒä¸­çš„å¼ºåŠ¿æ„è§ä¸€è‡´ï¼ˆæˆ–ä¸ä¸€è‡´æ—¶ï¼‰ï¼Œå®³æ€•å­¤ç«‹è¿™ä¸ªå˜é¡¹æ‰ä¼šäº§ç”Ÿä½œç”¨ã€‚&quot;
+ &quot;ä»å¿ƒç†å­¦çš„èŒƒç•´æ¥çœ‹ï¼Œç¤¾ä¼šä¸­çš„å¼ºåŠ¿æ„è§è¶Šæ¥è¶Šå¼ºï¼Œç”šè‡³æ¯”å®é™…æƒ…å½¢è¿˜å¼ºï¼Œå¼±åŠ¿æ„è§è¶Šæ¥è¶Šå¼±ï¼Œç”šè‡³æ¯”å®é™…æƒ…å½¢è¿˜å¼±ï¼Œ
è¿™ç§åŠ¨åŠ›è¿ä½œçš„è¿‡ç¨‹æˆâ€“èºæ—‹çŠ¶&quot;

æ–‡æœ¬2:
&quot;æ²‰é»˜èºæ—‹æ¨¡å¼ä¸­å‘ˆç°å‡ºæ°‘æ„åŠ¨åŠ›çš„æ¥æºåœ¨äºäººç±»æœ‰å®³æ€•å­¤ç«‹çš„å¼±ç‚¹ï¼Œä½†å…‰å®³æ€•å­¤ç«‹ä¸è‡³äºå½±å“æ°‘æ„çš„å½¢æˆï¼Œ&quot;
+ &quot;ä»å¿ƒç†å­¦çš„èŒƒç•´æ¥çœ‹ï¼Œç¤¾ä¼šä¸­çš„å¼ºåŠ¿æ„è§è¶Šæ¥è¶Šå¼ºï¼Œç”šè‡³æ¯”å®é™…æƒ…å½¢è¿˜å¼ºï¼Œå¼±åŠ¿æ„è§è¶Šæ¥è¶Šå¼±ï¼Œç”šè‡³æ¯”å®é™…æƒ…å½¢è¿˜å¼±ï¼Œ
è¿™ç§åŠ¨åŠ›è¿ä½œçš„è¿‡ç¨‹æˆâ€“èºæ—‹çŠ¶&quot;
+ &quot;ä¸»è¦æ˜¯å½“ä¸ªäººè§‰å¯Ÿåˆ°è‡ªå·±å¯¹æŸè®ºé¢˜çš„æ„è§ä¸ç¯å¢ƒä¸­çš„å¼ºåŠ¿æ„è§ä¸€è‡´ï¼ˆæˆ–ä¸ä¸€è‡´æ—¶ï¼‰ï¼Œå®³æ€•å­¤ç«‹è¿™ä¸ªå˜é¡¹æ‰ä¼šäº§ç”Ÿä½œç”¨ã€‚&quot;
</code></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°ç”Ÿæˆçš„128ä½çš„hash codeæ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œä¸Šè¿°çš„æ–‡æœ¬è°ƒæ¢äº†è¯­åºç”Ÿæˆçš„ä¸¤æ®µæ–‡æœ¬ï¼Œç›¸ä¼¼åº¦ä¸º1ï¼Œæ‰€ä»¥è¿™ä¸¤æ®µæ–‡æœ¬ä¼šè¢«ç›´æ¥è¿‡æ»¤æ‰å…¶ä¸­ä¸€æ®µæ–‡æœ¬ã€‚</p>
<div align="center">
<img src="/2019/07/16/data-processing/2.png">
</div>

<p><br></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨å®é™…å¯¹åå°æ•°æ®åº“å½“ä¸­çš„æ•°æ®è¿è¡Œè¯¥åå¤„ç†æ¨¡å—æ—¶å€™ï¼Œå¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹åˆ°CSDNå½“ä¸­çˆ¬å–åˆ°çš„åšå®¢æ–‡ç« è¢«åˆ æ‰äº†ä¸€åŠå·¦å³ï¼Œå› ä¸ºçœŸçš„å¾ˆå¤šè½¬è½½çš„å’ŒæŠ„è¢­çš„åšå®¢æ–‡ç« åœ¨å…¶ä¸­ï¼Œè€Œå¯¹äº<code>stackoverflow</code>è¿™ç§å¤§å‹çš„æ­£è§„çš„QAç½‘ç«™ï¼ŒåŸºæœ¬æ²¡æœ‰è¿‡æ»¤æ‰å¾ˆå¤šæ˜¯å› ä¸ºç›¸ä¼¼åº¦è¶…è¿‡é˜ˆå€¼çš„è¿™ç§æ–‡ç« ï¼ŒæŠ€æœ¯æ°´å¹³è¿˜æ˜¯å¯ä»¥çš„ï¼Œè‡³å°‘å¹³æ—¶åœ¨çœ‹CSDNé‡Œçš„æŠ€æœ¯åšå®¢éƒ½ä¼šæœ‰è¿™ç§æ„Ÿå—ï¼ŒçœŸçš„ç›¸ä¼¼æˆ–è€…å®Œå…¨ç›¸åŒçš„æ–‡ç« å¤ªå¤šäº†ï¼ï¼ï¼<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å¦å¤–éœ€è¦æä¸€ç‚¹çš„å°±æ˜¯simhashç®—æ³•å¯¹äºçŸ­æ–‡æœ¬çš„è¡¨ç°å¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œå› ä¸ºçŸ­æ–‡æœ¬è¿›è¡Œåˆ†è¯ä¹‹åï¼Œè¯è¯­æœ¬èº«å°±å¾ˆå°‘ï¼Œæ‰€ä»¥å¾ˆå¤§ç¨‹åº¦çš„å½±å“äº†åé¢çš„hashingè¿‡ç¨‹ã€‚ä¸è¿‡åœ¨æˆ‘ä»¬è¿™æ¬¡çš„é¡¹ç›®å½“ä¸­éƒ½æ˜¯å†…å®¹æ¯”è¾ƒå¤šçš„æ–‡æœ¬ï¼Œæ‰€ä»¥simhashç®—æ³•çš„æ•ˆæœè¿˜æ˜¯æŒºä¸é”™çš„ :ï¼‰</p>
<hr>
<p><br></p>
<h4 id="æ‘˜è¦ç”Ÿæˆç®—æ³•TextRank"><a href="#æ‘˜è¦ç”Ÿæˆç®—æ³•TextRank" class="headerlink" title="æ‘˜è¦ç”Ÿæˆç®—æ³•TextRank"></a>æ‘˜è¦ç”Ÿæˆç®—æ³•TextRank</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>TextRank</code>æ˜¯ä¸€ç§åŸºäºæ— å‘å›¾çš„æ— ç›‘ç£ç®—æ³•ï¼Œå¯ä»¥ç”¨æ¥è¿›è¡Œ<code>å…³é”®å­—æå–</code>ä¸<code>æ–‡ç« æ‘˜è¦ç”Ÿæˆ</code>ç­‰å·¥ä½œã€‚TextRankç®—æ³•çš„å‰èº«æ˜¯Googleä¸ºç½‘é¡µæ’åºè€Œæå‡ºçš„<code>PageRank</code>çš„ç®—æ³•ã€‚<a href="https://zh.wikipedia.org/wiki/PageRank" target="_blank" rel="noopener">PageRank</a>çš„ä¸»è¦æ€æƒ³ä¹Ÿæ˜¯åŸºäºå›¾è®ºçš„æ–¹æ³•ï¼Œç”¨ç½‘é¡µä¹‹é—´çš„é“¾æ¥æ¥å½¢æˆåºå¤§çš„æœ‰å‘å›¾ï¼Œå›¾ä¸­çš„è¾¹æƒé‡ä»£è¡¨çš„æ˜¯ä»ç”¨æˆ·ä»æŸä¸ªç½‘é¡µè¿›å…¥åˆ°å¦ä¸€ä¸ªç½‘é¡µçš„æ¦‚ç‡ï¼Œç„¶åè¿›è¡Œè¿­ä»£æ›´æ–°ï¼Œå¾—åˆ°rankæœ€å¤§çš„é‚£äº›ç½‘ç«™æ˜¾ç¤ºã€‚</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>TextRank</code>çš„æ€æƒ³å’Œ<code>PageRank</code>å¾ˆåƒï¼Œç®—æ³•çš„ä¸»è¦æµç¨‹ç”±å¦‚ä¸‹è¿™å‡ ç‚¹ç»„æˆï¼š</p>
<ul>
<li>æ–‡æœ¬åˆ†å‰²ä¸ºå¥å­</li>
<li>å¯¹åˆ†å‰²å‡ºæ¥çš„å¥å­è¿›è¡Œå‘é‡åŒ–,å…¶ä¸­ä¹ŸåŒ…æ‹¬äº†stopwordsã€è¯æ€§çš„è¿‡æ»¤æ­¥éª¤</li>
<li>ç¡®å®šä¸åŒå¥å­ä¹‹é—´æ˜¯å¦å­˜åœ¨è¾¹ï¼Œè¿™ä¸ªåˆ©ç”¨çš„æ˜¯ç±»ä¼¼æ»‘åŠ¨çª—å£çš„æ–¹æ³•ï¼Œåœ¨å›ºå®šé•¿åº¦Kçš„çª—å£å½“ä¸­ï¼Œå¦‚æœå…±åŒå‡ºç°nä¸ªå•è¯ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºè¿™ä¸¤ä¸ªå¥å­ä¹‹é—´å­˜åœ¨è¾¹ã€‚ä¸€èˆ¬æƒ…å†µä¸‹nå–2.</li>
<li>è®¡ç®—ä¸åŒå¥å­ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œç”¨å¥å­ä¹‹é—´çš„ç›¸ä¼¼åº¦å……å½“æ— å‘å›¾å½“ä¸­è¾¹çš„æƒé‡</li>
<li>æ„é€ ç›¸ä¼¼åº¦çŸ©é˜µ</li>
<li>æ„é€ æ— å‘å›¾ï¼Œå…¶ä¸­èŠ‚ç‚¹æ˜¯æ¯ä¸€ä¸ªåˆ†å‰²å‡ºæ¥çš„å¥å­ï¼Œæ¯æ¡è¾¹çš„æƒé‡æ˜¯ä¸åŒå¥å­ä¹‹é—´çš„ç›¸ä¼¼åº¦</li>
<li>è¿­ä»£æ›´æ–°TextRankçš„å€¼ï¼Œç›´åˆ°æœ€åæ— å‘å›¾ä¸­èŠ‚ç‚¹çš„TextRankå€¼æ”¶æ•›</li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å¯¹äºæ¯ä¸ªå¥å­èŠ‚ç‚¹çš„TextRankå€¼çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
TR(V_i)=(1-d)+d*\sum_{V_j\in In(V_i)} \frac{\omega_{ji}}{\sum_{V_k \in Out(V_j)} \omega_{jk}} * TR(V_j)</script><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å…¶ä¸­å˜é‡$d$è¡¨ç¤ºçš„æ˜¯é˜»å°¼ç³»æ•°ï¼Œä¸»è¦æ˜¯ä¸ºäº†é¿å…æœ‰çš„èŠ‚ç‚¹å’Œåˆ«çš„èŠ‚ç‚¹ä¹‹é—´æ²¡æœ‰è¾¹è€Œå‡ºç°çš„<code>TextRank</code>å€¼ä¸º0çš„æƒ…å†µã€‚$\omega_{ik}$ä»£è¡¨çš„å°±æ˜¯$i, k$ä¸¤ä¸ªå¥å­èŠ‚ç‚¹ä¹‹é—´çš„æƒé‡å€¼ã€‚ä¹‹ååªè¦æ ¹æ®æ›´æ–°å…¬å¼è¿›è¡Œè¿­ä»£è®¡ç®—ç›´è‡³æ”¶æ•›å³å¯ï¼Œç„¶åé€‰å–<code>TextRank</code>å€¼æœ€é«˜çš„å‡ ä¸ªèŠ‚ç‚¹å¯¹åº”çš„å¥å­ï¼Œå°±èƒ½å½¢æˆæ•´ç¯‡æ–‡æ¡£çš„æ‘˜è¦ï¼Œå®ç°äº†è‡ªåŠ¨æ‘˜è¦ç”Ÿæˆçš„åŠŸèƒ½ã€‚å…·ä½“çš„æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div align="center">
<img src="/2019/07/16/data-processing/3.png">
</div>

<p><br></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ä¸è¿‡ç¨å¾®æœ‰äº›é—æ†¾çš„æ˜¯ï¼Œæˆ‘å¹¶æ²¡æœ‰åœ¨æˆ‘ä»¬çš„é¡¹ç›®å½“ä¸­å†é€ è½®å­å®ç°TextRankç®—æ³•ï¼Œè¦æ˜¯æ—¶é—´èƒ½å†é•¿ä¸€ç‚¹å¯ä»¥å°è¯•ç€å®ç°ä¸€æ³¢TextRankç®—æ³•ã€‚åœ¨æˆ‘ä»¬é¡¹ç›®å½“ä¸­ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®<a href="https://github.com/letiantian/TextRank4ZH" target="_blank" rel="noopener">textrank4zh</a>, è¿™ä¸ªé¡¹ç›®ä½¿ç”¨çš„è‡ªåŠ¨æ‘˜è¦ç®—æ³•å°±æ˜¯ä½¿ç”¨çš„TextRankçš„ç®—æ³•å®ç°ã€‚</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å½“ç„¶è¿™ç§æ–¹æ³•çš„é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œæ¯•ç«Ÿéœ€è¦é’ˆå¯¹å…¨æ–‡æ„å»ºä¸€å¼ æ— å‘å›¾ï¼Œç„¶ååœ¨æ— å‘å›¾ä¸Šè¿›è¡Œè¿­ä»£æ›´æ–°ï¼Œæ‰€ä»¥å®é™…è¿è¡Œçš„æ—¶å€™ï¼Œå¾ˆå¤§ä¸€éƒ¨åˆ†æ—¶é—´æ˜¯èŠ±è´¹åœ¨è‡ªåŠ¨æ‘˜è¦ç”Ÿæˆä¸Šé¢ï¼Œå¤§æ¦‚ä¸€ç¯‡æ–‡ç« 2ç§’å·¦å³çš„ç”Ÿæˆæ—¶é—´ï¼Œæ‰€ä»¥æˆ‘ä»¬èŠ±äº†ä¸€æ™šä¸Šçš„æ—¶é—´å¯¹æ‰€æœ‰æ”¶é›†åˆ°çš„æ–‡ç« è¿›è¡Œè‡ªåŠ¨æ‘˜è¦ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿä¸èƒ½ä¿è¯TextRankå°±èƒ½ç”Ÿæˆæœ€å‡†ç¡®çš„æ‘˜è¦ä¿¡æ¯ï¼Œæ‰€ä»¥ä»¥åæœ‰æœºä¼šå»è°ƒç ”å…¶ä»–çš„æ‘˜è¦ç”Ÿæˆã€å…³é”®è¯ç”Ÿæˆçš„ç®—æ³•å’Œç ”ç©¶ã€‚</p>
<hr>
<p><br></p>
<h4 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨è¿™ç¯‡å°è®ºæ–‡å½“ä¸­ï¼Œæˆ‘ä¸»è¦æ˜¯é˜è¿°äº†æœ¬æ¬¡é¡¹ç›®å½“ä¸­å®é™…è¿ç”¨åˆ°çš„<code>simhash</code>å’Œ<code>textrank</code>ä¸¤ä¸ªç®—æ³•ã€‚å½“ç„¶å…¶å®è¿™ä¸¤ä¸ªç®—æ³•éƒ½æœ‰ä¸€å®šçš„å¹´å¤´äº†ï¼Œåœ¨å®é™…çš„æ•ˆæœä¸Šæ¯”ä¸ä¸Šç°åœ¨å¤§çƒ­çš„NLPæŠ€æœ¯ã€‚ä¸è¿‡è¿™æ¬¡é¡¹ç›®èƒ½å¤Ÿè®©æˆ‘åœ¨çŸ­æ—¶é—´å†…å®Œæˆæ•´ä¸ªæ•°æ®è·å–å’Œæ•°æ®æ¸…æ´—åŠ å·¥çš„è¿‡ç¨‹ï¼Œå¹¶ä¸”å»äº†è§£ç›¸å…³çš„ç®—æ³•ç ”ç©¶ï¼Œæˆ‘è§‰å¾—è¿˜æ˜¯æœ‰ä¸€å®šçš„ä»·å€¼å’Œæ„ä¹‰çš„ã€‚</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ä¹‹åå¦‚æœæœ‰æ—¶é—´çš„è¯ï¼Œå¯ä»¥å¯¹å…¶ä»–çš„ç›¸ä¼¼åº¦è®¡ç®—å’Œæ‘˜è¦ç”Ÿæˆã€å…³é”®å­—ç”Ÿæˆçš„ç®—æ³•è¿›è¡Œè°ƒç ”ã€ç ”ç©¶ï¼Œç›¸ä¿¡å¯¹ä¹‹åçš„ç§‘ç ”ç”Ÿæ´»æœ‰ä¸€å®šå¸®åŠ©çš„ã€‚</p>
<p><br></p>
<h4 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h4><ol>
<li><a href="https://blog.csdn.net/wotui1842/article/details/80351386" target="_blank" rel="noopener">TextRankç®—æ³•çš„åŸºæœ¬åŸç†åŠtextrank4zhä½¿ç”¨å®ä¾‹</a></li>
<li><a href="https://www.letiantian.me/2014-12-01-text-rank/" target="_blank" rel="noopener">ä½¿ç”¨TextRankç®—æ³•ä¸ºæ–‡æœ¬ç”Ÿæˆå…³é”®å­—å’Œæ‘˜è¦</a></li>
<li><a href="https://www2007.org/papers/paper215.pdf" target="_blank" rel="noopener">Detecting Near-Duplicates for Web Crawling</a></li>
<li><a href="https://dl.acm.org/citation.cfm?id=509965" target="_blank" rel="noopener">Similarity estimation techniques from rounding algorithms</a></li>
<li><a href="https://wizardforcel.gitbooks.io/the-art-of-programming-by-july/content/06.03.html" target="_blank" rel="noopener">simhashç®—æ³•</a></li>
</ol>
]]></content>
      <categories>
        <category>data-processing</category>
      </categories>
      <tags>
        <tag>data-processing</tag>
      </tags>
  </entry>
</search>
